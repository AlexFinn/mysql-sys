{"name":"mysql-sys","tagline":"The MySQL sys schema","body":"# The MySQL sys schema\r\n\r\nA collection of views, functions and procedures to help MySQL administrators get insight in to MySQL Database usage.\r\n\r\nThere are install files available for 5.6 and 5.7 respectively. To load these, you must position yourself within the directory that you downloaded to, as these top level files SOURCE individual files that are shared across versions in most cases (though not all).\r\n\r\n## Installation\r\n\r\nThe objects should all be created as the root user (but run with the privileges of the invoker).\r\n\r\nFor instance if you download to /tmp/mysql-sys/, and want to install the 5.6 version you should:\r\n\r\n    cd /tmp/mysql-sys/\r\n    mysql -u root -p < ./sys_56.sql\r\n\r\nOr if you would like to log in to the client, and install the 5.7 version:\r\n\r\n    cd /tmp/mysql-sys/\r\n    mysql -u root -p \r\n    SOURCE ./sys_57.sql\r\n\r\nAlternatively, you could just choose to load individual files based on your needs, but beware, certain objects have dependencies on other objects. You will need to ensure that these are also loaded.\r\n\r\n### Generating a single SQL file\r\n\r\nThere is bash script within the root of the branch directory, called `generate_sql_file.sh`, that allows you to create a single SQL file from the branch.\r\n\r\nThis includes substitution parameters for the MySQL user to use, and whether to include or exclude `SET sql_log_bin` commands from the scripts. This is particularly useful for installations such as Amazon RDS, which do not have the root@localhost user, or disallow setting sql_log_bin.\r\n\r\nWhen run, this outputs a file named such as `sys_<sys_version>_<mysql_version_identifier>_inline.sql`, i.e. `sys_1.2.0_56_inline.sql` is sys version 1.2.0, built for MySQL 5.6.\r\n\r\n#### Options\r\n\r\n* v: The version of MySQL to build the sys schema for, either '56' or '57'\r\n* b: Whether to omit any lines that deal with sql_log_bin (useful for RDS)\r\n* u: The user to set as the owner of the objects (useful for RDS)\r\n* m: Whether to generate a mysql_install_db / mysqld --initialize formatted file\r\n\r\n#### Examples\r\n\r\nGenerate a MySQL 5.7 SQL file that uses the 'mark'@'localhost' user:\r\n\r\n    ./generate_sql_file.sh -v 57 -u \"'mark'@'localhost'\"\r\n\r\nGenerate a MySQL 5.6 SQL file for RDS:\r\n\r\n    ./generate_sql_file.sh -v 56 -b -u CURRENT_USER\r\n\r\nGenerate a MySQL 5.7 bootstrap file:\r\n\r\n    ./generate_sql_file.sh -v 57 -m\r\n\r\n## Overview of objects\r\n\r\n### Tables\r\n\r\n#### sys_config\r\n\r\n##### Description\r\n\r\nHolds configuration options for the sys schema. This is a persistent table (using the `InnoDB` storage engine), with the configuration persisting across upgrades (new options are added with `INSERT IGNORE`). \r\n\r\nThe table also has two related triggers, which maintain the user that `INSERTs` or `UPDATEs` the configuration - `sys_config_insert_set_user` and `sys_config_update_set_user` respectively.\r\n\r\nIts structure is as follows:\r\n\r\n```SQL\r\n+----------+--------------+------+-----+-------------------+-----------------------------+\r\n| Field    | Type         | Null | Key | Default           | Extra                       |\r\n+----------+--------------+------+-----+-------------------+-----------------------------+\r\n| variable | varchar(128) | NO   | PRI | NULL              |                             |\r\n| value    | varchar(128) | YES  |     | NULL              |                             |\r\n| set_time | timestamp    | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |\r\n| set_by   | varchar(128) | YES  |     | NULL              |                             |\r\n+----------+--------------+------+-----+-------------------+-----------------------------+\r\n```\r\n\r\nNote, when functions check for configuration options, they first check whether a similar named user variable exists with a value, and if this is not set then pull the configuration option from this table in to that named user variable. This is done for performance reasons (to not continually `SELECT` from the table), however this comes with the side effect that once inited, the values last with the session, somewhat like how session variables are inited from global variables. If the values within this table are changed, they will not take effect until the user logs in again.\r\n\r\n##### Options included\r\n\r\n| Variable                             | Default Value | Description                                                                    |\r\n| ------------------------------------ | ------------- | ------------------------------------------------------------------------------ |\r\n| statement_truncate_len               | 64            | Sets the size to truncate statements to, for the `format_statement()` function. |\r\n| statement_performance_analyzer.limit | 100           | The maximum number of rows to include for the views that does not have a built-in limit (e.g. the 95th percentile view). If not set the limit is 100. |\r\n| statement_performance_analyzer.view  | NULL          | Used together with the 'custom' view. If the value contains a space, it is considered a query, otherwise it must be an existing view querying the performance_schema.events_statements_summary_by_digest table. |\r\n| diagnostics.allow_i_s_tables         | OFF           | Specifies whether it is allowed to do table scan queries on information_schema.TABLES for the `diagnostics` procedure. |\r\n| diagnostics.include_raw              | OFF           | Set to 'ON' to include the raw data (e.g. the original output of \"SELECT * FROM sys.metrics\") for the `diagnostics` procedure.|\r\n| ps_thread_trx_info.max_length        | 65535         | Sets the maximum output length for JSON object output by the `ps_thread_trx_info()` function. |\r\n\r\n### Views\r\n\r\nMany of the views in the sys schema have both a command line user friendly format output, as well as tooling friendly versions of any view that contains formatted output duplicated as an x$ table.\r\n\r\nThe examples below show output for only the formatted views, and note where there is an x$ counterpart available.\r\n\r\n#### host_summary / x$host_summary\r\n\r\n##### Description\r\n\r\nSummarizes statement activity, file IO and connections by host.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures (5.7)\r\n\r\n```SQL\r\nmysql> desc host_summary;\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| Field                  | Type          | Null | Key | Default | Extra |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| host                   | varchar(60)   | YES  |     | NULL    |       |\r\n| statements             | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_latency      | text          | YES  |     | NULL    |       |\r\n| statement_avg_latency  | text          | YES  |     | NULL    |       |\r\n| table_scans            | decimal(65,0) | YES  |     | NULL    |       |\r\n| file_ios               | decimal(64,0) | YES  |     | NULL    |       |\r\n| file_io_latency        | text          | YES  |     | NULL    |       |\r\n| current_connections    | decimal(41,0) | YES  |     | NULL    |       |\r\n| total_connections      | decimal(41,0) | YES  |     | NULL    |       |\r\n| unique_users           | bigint(21)    | NO   |     | 0       |       |\r\n| current_memory         | text          | YES  |     | NULL    |       |\r\n| total_memory_allocated | text          | YES  |     | NULL    |       |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n12 rows in set (0.15 sec)\r\n\r\nmysql> desc x$host_summary;\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| Field                  | Type          | Null | Key | Default | Extra |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| host                   | varchar(60)   | YES  |     | NULL    |       |\r\n| statements             | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_latency      | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_avg_latency  | decimal(65,4) | YES  |     | NULL    |       |\r\n| table_scans            | decimal(65,0) | YES  |     | NULL    |       |\r\n| file_ios               | decimal(64,0) | YES  |     | NULL    |       |\r\n| file_io_latency        | decimal(64,0) | YES  |     | NULL    |       |\r\n| current_connections    | decimal(41,0) | YES  |     | NULL    |       |\r\n| total_connections      | decimal(41,0) | YES  |     | NULL    |       |\r\n| unique_users           | bigint(21)    | NO   |     | 0       |       |\r\n| current_memory         | decimal(63,0) | YES  |     | NULL    |       |\r\n| total_memory_allocated | decimal(64,0) | YES  |     | NULL    |       |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n12 rows in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL \r\n  mysql> select * from host_summary;\r\n  +------+------------+-------------------+-----------------------+-------------+----------+-----------------+---------------------+-------------------+--------------+\r\n  | host | statements | statement_latency | statement_avg_latency | table_scans | file_ios | file_io_latency | current_connections | total_connections | unique_users |\r\n  +------+------------+-------------------+-----------------------+-------------+----------+-----------------+---------------------+-------------------+--------------+\r\n  | hal1 |       2924 | 00:03:59.53       | 81.92 ms              |          82 |    54702 | 55.61 s         |                   1 |                 1 |            1 |\r\n  +------+------------+-------------------+-----------------------+-------------+----------+-----------------+---------------------+-------------------+--------------+\r\n```\r\n\r\n#### host_summary_by_file_io / x$host_summary_by_file_io\r\n\r\n##### Description\r\n\r\nSummarizes file IO totals per host.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc host_summary_by_file_io;\r\n+------------+---------------+------+-----+---------+-------+\r\n| Field      | Type          | Null | Key | Default | Extra |\r\n+------------+---------------+------+-----+---------+-------+\r\n| host       | varchar(60)   | YES  |     | NULL    |       |\r\n| ios        | decimal(42,0) | YES  |     | NULL    |       |\r\n| io_latency | text          | YES  |     | NULL    |       |\r\n+------------+---------------+------+-----+---------+-------+\r\n3 rows in set (0.00 sec)\r\n\r\nmysql> desc x$host_summary_by_file_io;\r\n+------------+---------------+------+-----+---------+-------+\r\n| Field      | Type          | Null | Key | Default | Extra |\r\n+------------+---------------+------+-----+---------+-------+\r\n| host       | varchar(60)   | YES  |     | NULL    |       |\r\n| ios        | decimal(42,0) | YES  |     | NULL    |       |\r\n| io_latency | decimal(42,0) | YES  |     | NULL    |       |\r\n+------------+---------------+------+-----+---------+-------+\r\n3 rows in set (0.06 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n  mysql> select * from host_summary_by_file_io;\r\n  +------------+-------+------------+\r\n  | host       | ios   | io_latency |\r\n  +------------+-------+------------+\r\n  | hal1       | 26457 | 21.58 s    |\r\n  | hal2       |  1189 | 394.21 ms  |\r\n  +------------+-------+------------+\r\n```\r\n\r\n#### host_summary_by_file_io_type / x$host_summary_by_file_io_type\r\n\r\n##### Description\r\n\r\nSummarizes file IO by event type per host.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc host_summary_by_file_io_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.70 sec)\r\n\r\nmysql> desc x$host_summary_by_file_io_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n  mysql> select * from host_summary_by_file_io_type;\r\n  +------------+--------------------------------------+-------+---------------+-------------+\r\n  | host       | event_name                           | total | total_latency | max_latency |\r\n  +------------+--------------------------------------+-------+---------------+-------------+\r\n  | hal1       | wait/io/file/sql/FRM                 |   871 | 168.15 ms     | 18.48 ms    |\r\n  | hal1       | wait/io/file/innodb/innodb_data_file |   173 | 129.56 ms     | 34.09 ms    |\r\n  | hal1       | wait/io/file/innodb/innodb_log_file  |    20 | 77.53 ms      | 60.66 ms    |\r\n  | hal1       | wait/io/file/myisam/dfile            |    40 | 6.54 ms       | 4.58 ms     |\r\n  | hal1       | wait/io/file/mysys/charset           |     3 | 4.79 ms       | 4.71 ms     |\r\n  | hal1       | wait/io/file/myisam/kfile            |    67 | 4.38 ms       | 300.04 us   |\r\n  | hal1       | wait/io/file/sql/ERRMSG              |     5 | 2.72 ms       | 1.69 ms     |\r\n  | hal1       | wait/io/file/sql/pid                 |     3 | 266.30 us     | 185.47 us   |\r\n  | hal1       | wait/io/file/sql/casetest            |     5 | 246.81 us     | 150.19 us   |\r\n  | hal1       | wait/io/file/sql/global_ddl_log      |     2 | 21.24 us      | 18.59 us    |\r\n  | hal2       | wait/io/file/sql/file_parser         |  1422 | 4.80 s        | 135.14 ms   |\r\n  | hal2       | wait/io/file/sql/FRM                 |   865 | 85.82 ms      | 9.81 ms     |\r\n  | hal2       | wait/io/file/myisam/kfile            |  1073 | 37.14 ms      | 15.79 ms    |\r\n  | hal2       | wait/io/file/myisam/dfile            |  2991 | 25.53 ms      | 5.25 ms     |\r\n  | hal2       | wait/io/file/sql/dbopt               |    20 | 1.07 ms       | 153.07 us   |\r\n  | hal2       | wait/io/file/sql/misc                |     4 | 59.71 us      | 33.75 us    |\r\n  | hal2       | wait/io/file/archive/data            |     1 | 13.91 us      | 13.91 us    |\r\n  +------------+--------------------------------------+-------+---------------+-------------+\r\n ```\r\n\r\n#### host_summary_by_stages / x$host_summary_by_stages\r\n\r\n##### Description\r\n\r\nSummarizes stages by host, ordered by host and total latency per stage.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc host_summary_by_stages;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.06 sec)\r\n\r\nmysql> desc x$host_summary_by_stages;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.81 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n  mysql> select *  from host_summary_by_stages;\r\n  +------+--------------------------------+-------+---------------+-------------+\r\n  | host | event_name                     | total | total_latency | avg_latency |\r\n  +------+--------------------------------+-------+---------------+-------------+\r\n  | hal  | stage/sql/Opening tables       |   889 | 1.97 ms       | 2.22 us     |\r\n  | hal  | stage/sql/Creating sort index  |     4 | 1.79 ms       | 446.30 us   |\r\n  | hal  | stage/sql/init                 |    10 | 312.27 us     | 31.23 us    |\r\n  | hal  | stage/sql/checking permissions |    10 | 300.62 us     | 30.06 us    |\r\n  | hal  | stage/sql/freeing items        |     5 | 85.89 us      | 17.18 us    |\r\n  | hal  | stage/sql/statistics           |     5 | 79.15 us      | 15.83 us    |\r\n  | hal  | stage/sql/preparing            |     5 | 69.12 us      | 13.82 us    |\r\n  | hal  | stage/sql/optimizing           |     5 | 53.11 us      | 10.62 us    |\r\n  | hal  | stage/sql/Sending data         |     5 | 44.66 us      | 8.93 us     |\r\n  | hal  | stage/sql/closing tables       |     5 | 37.54 us      | 7.51 us     |\r\n  | hal  | stage/sql/System lock          |     5 | 34.28 us      | 6.86 us     |\r\n  | hal  | stage/sql/query end            |     5 | 24.37 us      | 4.87 us     |\r\n  | hal  | stage/sql/end                  |     5 | 8.60 us       | 1.72 us     |\r\n  | hal  | stage/sql/Sorting result       |     5 | 8.33 us       | 1.67 us     |\r\n  | hal  | stage/sql/executing            |     5 | 5.37 us       | 1.07 us     |\r\n  | hal  | stage/sql/cleaning up          |     5 | 4.60 us       | 919.00 ns   |\r\n  +------+--------------------------------+-------+---------------+-------------+\r\n```\r\n\r\n#### host_summary_by_statement_latency / x$host_summary_by_statement_latency\r\n\r\n##### Description\r\n\r\nSummarizes overall statement statistics by host.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc host_summary_by_statement_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| host          | varchar(60)   | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | text          | YES  |     | NULL    |       |\r\n| max_latency   | text          | YES  |     | NULL    |       |\r\n| lock_latency  | text          | YES  |     | NULL    |       |\r\n| rows_sent     | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_examined | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_affected | decimal(42,0) | YES  |     | NULL    |       |\r\n| full_scans    | decimal(43,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n9 rows in set (0.29 sec)\r\n\r\nmysql> desc x$host_summary_by_statement_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| host          | varchar(60)   | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | decimal(42,0) | YES  |     | NULL    |       |\r\n| max_latency   | decimal(42,0) | YES  |     | NULL    |       |\r\n| lock_latency  | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_sent     | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_examined | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_affected | decimal(42,0) | YES  |     | NULL    |       |\r\n| full_scans    | decimal(43,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n9 rows in set (0.54 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n  mysql> select * from host_summary_by_statement_latency;\r\n  +------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n  | host | total | total_latency | max_latency | lock_latency | rows_sent | rows_examined | rows_affected | full_scans |\r\n  +------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n  | hal  |  3381 | 00:02:09.13   | 1.48 s      | 1.07 s       |      1151 |         93947 |           150 |         91 |\r\n  +------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n```\r\n\r\n#### host_summary_by_statement_type / x$host_summary_by_statement_type\r\n\r\n##### Description\r\n\r\nSummarizes the types of statements executed by each host.\r\n\r\nWhen the host found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc host_summary_by_statement_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| statement     | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n| lock_latency  | text                | YES  |     | NULL    |       |\r\n| rows_sent     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_examined | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_affected | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| full_scans    | bigint(21) unsigned | NO   |     | 0       |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n10 rows in set (0.30 sec)\r\n\r\nmysql> desc x$host_summary_by_statement_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| statement     | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| lock_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_sent     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_examined | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_affected | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| full_scans    | bigint(21) unsigned | NO   |     | 0       |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n10 rows in set (0.76 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n  mysql> select * from host_summary_by_statement_type;\r\n  +------+----------------------+--------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n  | host | statement            | total  | total_latency | max_latency | lock_latency | rows_sent | rows_examined | rows_affected | full_scans |\r\n  +------+----------------------+--------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n  | hal  | create_view          |   2063 | 00:05:04.20   | 463.58 ms   | 1.42 s       |         0 |             0 |             0 |          0 |\r\n  | hal  | select               |    174 | 40.87 s       | 28.83 s     | 858.13 ms    |      5212 |        157022 |             0 |         82 |\r\n  | hal  | stmt                 |   6645 | 15.31 s       | 491.78 ms   | 0 ps         |         0 |             0 |          7951 |          0 |\r\n  | hal  | call_procedure       |     17 | 4.78 s        | 1.02 s      | 37.94 ms     |         0 |             0 |            19 |          0 |\r\n  | hal  | create_table         |     19 | 3.04 s        | 431.71 ms   | 0 ps         |         0 |             0 |             0 |          0 |\r\n  ...\r\n  +------+----------------------+--------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n```\r\n\r\n#### innodb_buffer_stats_by_schema / x$innodb_buffer_stats_by_schema\r\n\r\n##### Description\r\n\r\nSummarizes the output of the INFORMATION_SCHEMA.INNODB_BUFFER_PAGE table, aggregating by schema.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc innodb_buffer_stats_by_schema;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| object_schema | text          | YES  |     | NULL    |       |\r\n| allocated     | text          | YES  |     | NULL    |       |\r\n| data          | text          | YES  |     | NULL    |       |\r\n| pages         | bigint(21)    | NO   |     | 0       |       |\r\n| pages_hashed  | bigint(21)    | NO   |     | 0       |       |\r\n| pages_old     | bigint(21)    | NO   |     | 0       |       |\r\n| rows_cached   | decimal(44,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n7 rows in set (0.08 sec)\r\n\r\nmysql> desc x$innodb_buffer_stats_by_schema;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| object_schema | text          | YES  |     | NULL    |       |\r\n| allocated     | decimal(43,0) | YES  |     | NULL    |       |\r\n| data          | decimal(43,0) | YES  |     | NULL    |       |\r\n| pages         | bigint(21)    | NO   |     | 0       |       |\r\n| pages_hashed  | bigint(21)    | NO   |     | 0       |       |\r\n| pages_old     | bigint(21)    | NO   |     | 0       |       |\r\n| rows_cached   | decimal(44,0) | NO   |     | 0       |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n7 rows in set (0.12 sec)\r\n````\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from innodb_buffer_stats_by_schema;\r\n+--------------------------+------------+------------+-------+--------------+-----------+-------------+\r\n| object_schema            | allocated  | data       | pages | pages_hashed | pages_old | rows_cached |\r\n+--------------------------+------------+------------+-------+--------------+-----------+-------------+\r\n| mem30_trunk__instruments | 1.69 MiB   | 510.03 KiB |   108 |          108 |       108 |        3885 |\r\n| InnoDB System            | 688.00 KiB | 351.62 KiB |    43 |           43 |        43 |         862 |\r\n| mem30_trunk__events      | 80.00 KiB  | 21.61 KiB  |     5 |            5 |         5 |         229 |\r\n+--------------------------+------------+------------+-------+--------------+-----------+-------------+\r\n```\r\n\r\n#### innodb_buffer_stats_by_table / x$innodb_buffer_stats_by_table\r\n\r\n##### Description\r\n\r\nSummarizes the output of the INFORMATION_SCHEMA.INNODB_BUFFER_PAGE table, aggregating by schema and table name.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc innodb_buffer_stats_by_table;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| object_schema | text          | YES  |     | NULL    |       |\r\n| object_name   | text          | YES  |     | NULL    |       |\r\n| allocated     | text          | YES  |     | NULL    |       |\r\n| data          | text          | YES  |     | NULL    |       |\r\n| pages         | bigint(21)    | NO   |     | 0       |       |\r\n| pages_hashed  | bigint(21)    | NO   |     | 0       |       |\r\n| pages_old     | bigint(21)    | NO   |     | 0       |       |\r\n| rows_cached   | decimal(44,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n8 rows in set (0.09 sec)\r\n\r\nmysql> desc x$innodb_buffer_stats_by_table;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| object_schema | text          | YES  |     | NULL    |       |\r\n| object_name   | text          | YES  |     | NULL    |       |\r\n| allocated     | decimal(43,0) | YES  |     | NULL    |       |\r\n| data          | decimal(43,0) | YES  |     | NULL    |       |\r\n| pages         | bigint(21)    | NO   |     | 0       |       |\r\n| pages_hashed  | bigint(21)    | NO   |     | 0       |       |\r\n| pages_old     | bigint(21)    | NO   |     | 0       |       |\r\n| rows_cached   | decimal(44,0) | NO   |     | 0       |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n8 rows in set (0.18 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from innodb_buffer_stats_by_table;\r\n+--------------------------+------------------------------------+------------+-----------+-------+--------------+-----------+-------------+\r\n| object_schema            | object_name                        | allocated  | data      | pages | pages_hashed | pages_old | rows_cached |\r\n+--------------------------+------------------------------------+------------+-----------+-------+--------------+-----------+-------------+\r\n| InnoDB System            | SYS_COLUMNS                        | 128.00 KiB | 98.97 KiB |     8 |            8 |         8 |        1532 |\r\n| InnoDB System            | SYS_FOREIGN                        | 128.00 KiB | 55.48 KiB |     8 |            8 |         8 |         172 |\r\n| InnoDB System            | SYS_TABLES                         | 128.00 KiB | 56.18 KiB |     8 |            8 |         8 |         365 |\r\n| InnoDB System            | SYS_INDEXES                        | 112.00 KiB | 76.16 KiB |     7 |            7 |         7 |        1046 |\r\n| mem30_trunk__instruments | agentlatencytime                   | 96.00 KiB  | 28.83 KiB |     6 |            6 |         6 |         252 |\r\n| mem30_trunk__instruments | binlogspaceusagedata               | 96.00 KiB  | 22.54 KiB |     6 |            6 |         6 |         196 |\r\n| mem30_trunk__instruments | connectionsdata                    | 96.00 KiB  | 36.68 KiB |     6 |            6 |         6 |         276 |\r\n| mem30_trunk__instruments | connectionsmaxdata                 | 96.00 KiB  | 31.88 KiB |     6 |            6 |         6 |         271 |\r\n| mem30_trunk__instruments | cpuaverage                         | 96.00 KiB  | 14.32 KiB |     6 |            6 |         6 |          55 |\r\n| mem30_trunk__instruments | diskiototaldata                    | 96.00 KiB  | 42.71 KiB |     6 |            6 |         6 |         152 |\r\n| mem30_trunk__instruments | innodbopenfilesdata                | 96.00 KiB  | 32.61 KiB |     6 |            6 |         6 |         266 |\r\n| mem30_trunk__instruments | innodbrowlocktimestatisticsdata    | 96.00 KiB  | 32.16 KiB |     6 |            6 |         6 |         261 |\r\n| mem30_trunk__instruments | myisamkeybufferusagedata           | 96.00 KiB  | 25.99 KiB |     6 |            6 |         6 |         232 |\r\n| mem30_trunk__instruments | mysqlprocessactivity               | 96.00 KiB  | 31.99 KiB |     6 |            6 |         6 |         252 |\r\n| mem30_trunk__instruments | querycacheaveragefreeblocksizedata | 96.00 KiB  | 27.00 KiB |     6 |            6 |         6 |         237 |\r\n| mem30_trunk__instruments | querycacheaveragequerysizedata     | 96.00 KiB  | 38.29 KiB |     6 |            6 |         6 |         315 |\r\n| mem30_trunk__instruments | querycachefragmentationdata        | 96.00 KiB  | 27.00 KiB |     6 |            6 |         6 |         237 |\r\n| mem30_trunk__instruments | querycachememorydata               | 96.00 KiB  | 32.58 KiB |     6 |            6 |         6 |         278 |\r\n| mem30_trunk__instruments | querycachequeriesincachedata       | 96.00 KiB  | 27.15 KiB |     6 |            6 |         6 |         238 |\r\n| mem30_trunk__instruments | ramusagedata                       | 96.00 KiB  | 15.02 KiB |     6 |            6 |         6 |          59 |\r\n| mem30_trunk__instruments | slaverelaylogspaceusagedata        | 96.00 KiB  | 28.28 KiB |     6 |            6 |         6 |         249 |\r\n| mem30_trunk__instruments | swapusagedata                      | 96.00 KiB  | 15.02 KiB |     6 |            6 |         6 |          59 |\r\n| InnoDB System            | SYS_FIELDS                         | 80.00 KiB  | 49.78 KiB |     5 |            5 |         5 |        1147 |\r\n| InnoDB System            | SYS_DATAFILES                      | 32.00 KiB  | 3.97 KiB  |     2 |            2 |         2 |          60 |\r\n| InnoDB System            | SYS_FOREIGN_COLS                   | 32.00 KiB  | 7.43 KiB  |     2 |            2 |         2 |          83 |\r\n| InnoDB System            | SYS_TABLESPACES                    | 32.00 KiB  | 3.65 KiB  |     2 |            2 |         2 |          56 |\r\n| InnoDB System            | SYS_IBUF_TABLE                     | 16.00 KiB  | 0 bytes   |     1 |            1 |         1 |           0 |\r\n+--------------------------+------------------------------------+------------+-----------+-------+--------------+-----------+-------------+\r\n```\r\n\r\n#### innodb_lock_waits / x$innodb_lock_waits\r\n\r\n##### Description\r\n\r\nGives a snapshot of which InnoDB locks transactions are waiting for.\r\nThe lock waits are ordered by the age of the lock descending.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc sys.innodb_lock_waits;\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n| Field                        | Type                | Null | Key | Default             | Extra |\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n| wait_started                 | datetime            | YES  |     | NULL                |       |\r\n| wait_age                     | time                | YES  |     | NULL                |       |\r\n| wait_age_secs                | bigint(21)          | YES  |     | NULL                |       |\r\n| locked_table                 | varchar(1024)       | NO   |     |                     |       |\r\n| locked_index                 | varchar(1024)       | YES  |     | NULL                |       |\r\n| locked_type                  | varchar(32)         | NO   |     |                     |       |\r\n| waiting_trx_id               | varchar(18)         | NO   |     |                     |       |\r\n| waiting_trx_started          | datetime            | NO   |     | 0000-00-00 00:00:00 |       |\r\n| waiting_trx_age              | time                | YES  |     | NULL                |       |\r\n| waiting_trx_rows_locked      | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_trx_rows_modified    | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_pid                  | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_query                | longtext            | YES  |     | NULL                |       |\r\n| waiting_lock_id              | varchar(81)         | NO   |     |                     |       |\r\n| waiting_lock_mode            | varchar(32)         | NO   |     |                     |       |\r\n| blocking_trx_id              | varchar(18)         | NO   |     |                     |       |\r\n| blocking_pid                 | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| blocking_query               | longtext            | YES  |     | NULL                |       |\r\n| blocking_lock_id             | varchar(81)         | NO   |     |                     |       |\r\n| blocking_lock_mode           | varchar(32)         | NO   |     |                     |       |\r\n| blocking_trx_started         | datetime            | NO   |     | 0000-00-00 00:00:00 |       |\r\n| blocking_trx_age             | time                | YES  |     | NULL                |       |\r\n| blocking_trx_rows_locked     | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| blocking_trx_rows_modified   | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| sql_kill_blocking_query      | varchar(32)         | YES  |     | NULL                |       |\r\n| sql_kill_blocking_connection | varchar(26)         | YES  |     | NULL                |       |\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n26 rows in set (0.01 sec)\r\n\r\nmysql> desc sys.x$innodb_lock_waits;\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n| Field                        | Type                | Null | Key | Default             | Extra |\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n| wait_started                 | datetime            | YES  |     | NULL                |       |\r\n| wait_age                     | time                | YES  |     | NULL                |       |\r\n| wait_age_secs                | bigint(21)          | YES  |     | NULL                |       |\r\n| locked_table                 | varchar(1024)       | NO   |     |                     |       |\r\n| locked_index                 | varchar(1024)       | YES  |     | NULL                |       |\r\n| locked_type                  | varchar(32)         | NO   |     |                     |       |\r\n| waiting_trx_id               | varchar(18)         | NO   |     |                     |       |\r\n| waiting_trx_started          | datetime            | NO   |     | 0000-00-00 00:00:00 |       |\r\n| waiting_trx_age              | time                | YES  |     | NULL                |       |\r\n| waiting_trx_rows_locked      | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_trx_rows_modified    | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_pid                  | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| waiting_query                | varchar(1024)       | YES  |     | NULL                |       |\r\n| waiting_lock_id              | varchar(81)         | NO   |     |                     |       |\r\n| waiting_lock_mode            | varchar(32)         | NO   |     |                     |       |\r\n| blocking_trx_id              | varchar(18)         | NO   |     |                     |       |\r\n| blocking_pid                 | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| blocking_query               | varchar(1024)       | YES  |     | NULL                |       |\r\n| blocking_lock_id             | varchar(81)         | NO   |     |                     |       |\r\n| blocking_lock_mode           | varchar(32)         | NO   |     |                     |       |\r\n| blocking_trx_started         | datetime            | NO   |     | 0000-00-00 00:00:00 |       |\r\n| blocking_trx_age             | time                | YES  |     | NULL                |       |\r\n| blocking_trx_rows_locked     | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| blocking_trx_rows_modified   | bigint(21) unsigned | NO   |     | 0                   |       |\r\n| sql_kill_blocking_query      | varchar(32)         | YES  |     | NULL                |       |\r\n| sql_kill_blocking_connection | varchar(26)         | YES  |     | NULL                |       |\r\n+------------------------------+---------------------+------+-----+---------------------+-------+\r\n26 rows in set (0.02 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> SELECT * FROM innodb_lock_waits\\G\r\n*************************** 1. row ***************************\r\n                wait_started: 2014-11-11 13:39:20\r\n                    wait_age: 00:00:07\r\n               wait_age_secs: 7\r\n                locked_table: `db1`.`t1`\r\n                locked_index: PRIMARY\r\n                 locked_type: RECORD\r\n              waiting_trx_id: 867158\r\n         waiting_trx_started: 2014-11-11 13:39:15\r\n             waiting_trx_age: 00:00:12\r\n     waiting_trx_rows_locked: 0\r\n   waiting_trx_rows_modified: 0\r\n                 waiting_pid: 3\r\n               waiting_query: UPDATE t1 SET val = val + 1 WHERE id = 2\r\n             waiting_lock_id: 867158:2363:3:3\r\n           waiting_lock_mode: X\r\n             blocking_trx_id: 867157\r\n                blocking_pid: 4\r\n              blocking_query: UPDATE t1 SET val = val + 1 + SLEEP(10) WHERE id = 2\r\n            blocking_lock_id: 867157:2363:3:3\r\n          blocking_lock_mode: X\r\n        blocking_trx_started: 2014-11-11 13:39:11\r\n            blocking_trx_age: 00:00:16\r\n    blocking_trx_rows_locked: 1\r\n  blocking_trx_rows_modified: 1\r\n     sql_kill_blocking_query: KILL QUERY 4\r\nsql_kill_blocking_connection: KILL 4\r\n```\r\n\r\n#### io_by_thread_by_latency / x$io_by_thread_by_latency\r\n\r\n##### Description\r\n\r\nShows the top IO consumers by thread, ordered by total latency.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc io_by_thread_by_latency;\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| Field          | Type                | Null | Key | Default | Extra |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| user           | varchar(128)        | YES  |     | NULL    |       |\r\n| total          | decimal(42,0)       | YES  |     | NULL    |       |\r\n| total_latency  | text                | YES  |     | NULL    |       |\r\n| min_latency    | text                | YES  |     | NULL    |       |\r\n| avg_latency    | text                | YES  |     | NULL    |       |\r\n| max_latency    | text                | YES  |     | NULL    |       |\r\n| thread_id      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| processlist_id | bigint(20) unsigned | YES  |     | NULL    |       |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n8 rows in set (0.14 sec)\r\n\r\nmysql> desc x$io_by_thread_by_latency;\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| Field          | Type                | Null | Key | Default | Extra |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| user           | varchar(128)        | YES  |     | NULL    |       |\r\n| total          | decimal(42,0)       | YES  |     | NULL    |       |\r\n| total_latency  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| min_latency    | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| avg_latency    | decimal(24,4)       | YES  |     | NULL    |       |\r\n| max_latency    | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| thread_id      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| processlist_id | bigint(20) unsigned | YES  |     | NULL    |       |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n8 rows in set (0.03 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from io_by_thread_by_latency;\r\n+---------------------+-------+---------------+-------------+-------------+-------------+-----------+----------------+\r\n| user                | total | total_latency | min_latency | avg_latency | max_latency | thread_id | processlist_id |\r\n+---------------------+-------+---------------+-------------+-------------+-------------+-----------+----------------+\r\n| root@localhost      | 11580 | 18.01 s       | 429.78 ns   | 1.12 ms     | 181.07 ms   |        25 |              6 |\r\n| main                |  1358 | 1.31 s        | 475.02 ns   | 2.27 ms     | 350.70 ms   |         1 |           NULL |\r\n| page_cleaner_thread |   654 | 147.44 ms     | 588.12 ns   | 225.44 us   | 46.41 ms    |        18 |           NULL |\r\n| io_write_thread     |   131 | 107.75 ms     | 8.60 us     | 822.55 us   | 27.69 ms    |         8 |           NULL |\r\n| io_write_thread     |    46 | 47.07 ms      | 10.64 us    | 1.02 ms     | 16.90 ms    |         9 |           NULL |\r\n| io_write_thread     |    71 | 46.99 ms      | 9.11 us     | 661.81 us   | 17.04 ms    |        11 |           NULL |\r\n| io_log_thread       |    20 | 21.01 ms      | 14.25 us    | 1.05 ms     | 7.08 ms     |         3 |           NULL |\r\n| srv_master_thread   |    13 | 17.60 ms      | 8.49 us     | 1.35 ms     | 9.99 ms     |        16 |           NULL |\r\n| srv_purge_thread    |     4 | 1.81 ms       | 34.31 us    | 452.45 us   | 1.02 ms     |        17 |           NULL |\r\n| io_write_thread     |    19 | 951.39 us     | 9.75 us     | 50.07 us    | 297.47 us   |        10 |           NULL |\r\n| signal_handler      |     3 | 218.03 us     | 21.64 us    | 72.68 us    | 154.84 us   |        19 |           NULL |\r\n+---------------------+-------+---------------+-------------+-------------+-------------+-----------+----------------+\r\n```\r\n\r\n#### io_global_by_file_by_bytes / x$io_global_by_file_by_bytes\r\n\r\n##### Description\r\n\r\nShows the top global IO consumers by bytes usage by file.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc io_global_by_file_by_bytes;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| file          | varchar(512)        | YES  |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read    | text                | YES  |     | NULL    |       |\r\n| avg_read      | text                | YES  |     | NULL    |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written | text                | YES  |     | NULL    |       |\r\n| avg_write     | text                | YES  |     | NULL    |       |\r\n| total         | text                | YES  |     | NULL    |       |\r\n| write_pct     | decimal(26,2)       | NO   |     | 0.00    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n9 rows in set (0.15 sec)\r\n\r\nmysql> desc x$io_global_by_file_by_bytes;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| file          | varchar(512)        | NO   |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read    | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_read      | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_write     | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n| total         | bigint(21)          | NO   |     | 0       |       |\r\n| write_pct     | decimal(26,2)       | NO   |     | 0.00    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n9 rows in set (0.14 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> SELECT * FROM io_global_by_file_by_bytes LIMIT 5;\r\n+--------------------------------------------+------------+------------+-----------+-------------+---------------+-----------+------------+-----------+\r\n| file                                       | count_read | total_read | avg_read  | count_write | total_written | avg_write | total      | write_pct |\r\n+--------------------------------------------+------------+------------+-----------+-------------+---------------+-----------+------------+-----------+\r\n| @@datadir/ibdata1                          |        147 | 4.27 MiB   | 29.71 KiB |           3 | 48.00 KiB     | 16.00 KiB | 4.31 MiB   |      1.09 |\r\n| @@datadir/mysql/proc.MYD                   |        347 | 85.35 KiB  | 252 bytes |         111 | 19.08 KiB     | 176 bytes | 104.43 KiB |     18.27 |\r\n| @@datadir/ib_logfile0                      |          6 | 68.00 KiB  | 11.33 KiB |           8 | 4.00 KiB      | 512 bytes | 72.00 KiB  |      5.56 |\r\n| /opt/mysql/5.5.33/share/english/errmsg.sys |          3 | 43.68 KiB  | 14.56 KiB |           0 | 0 bytes       | 0 bytes   | 43.68 KiB  |      0.00 |\r\n| /opt/mysql/5.5.33/share/charsets/Index.xml |          1 | 17.89 KiB  | 17.89 KiB |           0 | 0 bytes       | 0 bytes   | 17.89 KiB  |      0.00 |\r\n+--------------------------------------------+------------+------------+-----------+-------------+---------------+-----------+------------+-----------+\r\n```\r\n\r\n#### io_global_by_file_by_latency / x$io_global_by_file_by_latency\r\n\r\n##### Description\r\n\r\nShows the top global IO consumers by latency by file.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc io_global_by_file_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| file          | varchar(512)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| read_latency  | text                | YES  |     | NULL    |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| write_latency | text                | YES  |     | NULL    |       |\r\n| count_misc    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| misc_latency  | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n9 rows in set (0.00 sec)\r\n\r\nmysql> desc x$io_global_by_file_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| file          | varchar(512)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| read_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| write_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| count_misc    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| misc_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n9 rows in set (0.07 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from io_global_by_file_by_latency limit 5;\r\n+-----------------------------------------------------------+-------+---------------+------------+--------------+-------------+---------------+------------+--------------+\r\n| file                                                      | total | total_latency | count_read | read_latency | count_write | write_latency | count_misc | misc_latency |\r\n+-----------------------------------------------------------+-------+---------------+------------+--------------+-------------+---------------+------------+--------------+\r\n| @@datadir/sys/wait_classes_global_by_avg_latency_raw.frm~ |    24 | 451.99 ms     |          0 | 0 ps         |           4 | 108.07 us     |         20 | 451.88 ms    |\r\n| @@datadir/sys/innodb_buffer_stats_by_schema_raw.frm~      |    24 | 379.84 ms     |          0 | 0 ps         |           4 | 108.88 us     |         20 | 379.73 ms    |\r\n| @@datadir/sys/io_by_thread_by_latency_raw.frm~            |    24 | 379.46 ms     |          0 | 0 ps         |           4 | 101.37 us     |         20 | 379.36 ms    |\r\n| @@datadir/ibtmp1                                          |    53 | 373.45 ms     |          0 | 0 ps         |          48 | 246.08 ms     |          5 | 127.37 ms    |\r\n| @@datadir/sys/statement_analysis_raw.frm~                 |    24 | 353.14 ms     |          0 | 0 ps         |           4 | 94.96 us      |         20 | 353.04 ms    |\r\n+-----------------------------------------------------------+-------+---------------+------------+--------------+-------------+---------------+------------+--------------+\r\n```\r\n\r\n#### io_global_by_wait_by_bytes / x$io_global_by_wait_by_bytes\r\n\r\n##### Description\r\n\r\nShows the top global IO consumer classes by bytes usage.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc io_global_by_wait_by_bytes;\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n| Field           | Type                | Null | Key | Default | Extra |\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n| event_name      | varchar(128)        | YES  |     | NULL    |       |\r\n| total           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency   | text                | YES  |     | NULL    |       |\r\n| min_latency     | text                | YES  |     | NULL    |       |\r\n| avg_latency     | text                | YES  |     | NULL    |       |\r\n| max_latency     | text                | YES  |     | NULL    |       |\r\n| count_read      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read      | text                | YES  |     | NULL    |       |\r\n| avg_read        | text                | YES  |     | NULL    |       |\r\n| count_write     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written   | text                | YES  |     | NULL    |       |\r\n| avg_written     | text                | YES  |     | NULL    |       |\r\n| total_requested | text                | YES  |     | NULL    |       |\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n13 rows in set (0.02 sec)\r\n\r\nmysql> desc x$io_global_by_wait_by_bytes;\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n| Field           | Type                | Null | Key | Default | Extra |\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n| event_name      | varchar(128)        | YES  |     | NULL    |       |\r\n| total           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| min_latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| count_read      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read      | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_read        | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n| count_write     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written   | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_written     | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n| total_requested | bigint(21)          | NO   |     | 0       |       |\r\n+-----------------+---------------------+------+-----+---------+-------+\r\n13 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from io_global_by_wait_by_bytes;\r\n+--------------------+--------+---------------+-------------+-------------+-------------+------------+------------+-----------+-------------+---------------+-------------+-----------------+\r\n| event_name         | total  | total_latency | min_latency | avg_latency | max_latency | count_read | total_read | avg_read  | count_write | total_written | avg_written | total_requested |\r\n+--------------------+--------+---------------+-------------+-------------+-------------+------------+------------+-----------+-------------+---------------+-------------+-----------------+\r\n| myisam/dfile       | 163681 | 983.13 ms     | 379.08 ns   | 6.01 us     | 22.06 ms    |      68737 | 127.31 MiB | 1.90 KiB  |     1012221 | 121.52 MiB    | 126 bytes   | 248.83 MiB      |\r\n| myisam/kfile       |   1775 | 375.13 ms     | 1.02 us     | 211.34 µs   | 35.15 ms    |      54066 | 9.97 MiB   | 193 bytes |      428257 | 12.40 MiB     | 30 bytes    | 22.37 MiB       |\r\n| sql/FRM            |  57889 | 8.40 s        | 19.44 ns    | 145.05 us   | 336.71 ms   |       8009 | 2.60 MiB   | 341 bytes |       14675 | 2.91 MiB      | 208 bytes   | 5.51 MiB        |\r\n| sql/global_ddl_log |    164 | 75.96 ms      | 5.72 us     | 463.19 µs   | 7.43 ms     |         20 | 80.00 KiB  | 4.00 KiB  |          76 | 304.00 KiB    | 4.00 KiB    | 384.00 KiB      |\r\n| sql/file_parser    |    419 | 601.37 ms     | 1.96 us     | 1.44 ms     | 37.14 ms    |         66 | 42.01 KiB  | 652 bytes |          64 | 226.98 KiB    | 3.55 KiB    | 268.99 KiB      |\r\n| sql/binlog         |    190 | 6.79 s        | 1.56 us     | 35.76 ms    | 4.21 s      |         52 | 60.54 KiB  | 1.16 KiB  |           0 | 0 bytes       | 0 bytes     | 60.54 KiB       |\r\n| sql/ERRMSG         |      5 | 2.03 s        | 8.61 us     | 405.40 ms   | 2.03 s      |          3 | 51.82 KiB  | 17.27 KiB |           0 | 0 bytes       | 0 bytes     | 51.82 KiB       |\r\n| mysys/charset      |      3 | 196.52 us     | 17.61 µs    | 65.51 µs    | 137.33 µs   |          1 | 17.83 KiB  | 17.83 KiB |           0 | 0 bytes       | 0 bytes     | 17.83 KiB       |\r\n| sql/partition      |     81 | 18.87 ms      | 888.08 ns   | 232.92 us   | 4.67 ms     |         66 | 2.75 KiB   | 43 bytes  |           8 | 288 bytes     | 36 bytes    | 3.04 KiB        |\r\n| sql/dbopt          | 329166 | 26.95 s       | 2.06 us     | 81.89 µs    | 178.71 ms   |          0 | 0 bytes    | 0 bytes   |           9 | 585 bytes     | 65 bytes    | 585 bytes       |\r\n| sql/relaylog       |      7 | 1.18 ms       | 838.84 ns   | 168.30 us   | 892.70 µs   |          0 | 0 bytes    | 0 bytes   |           1 | 120 bytes     | 120 bytes   | 120 bytes       |\r\n| mysys/cnf          |      5 | 171.61 us     | 303.26 ns   | 34.32 µs    | 115.21 µs   |          3 | 56 bytes   | 19 bytes  |           0 | 0 bytes       | 0 bytes     | 56 bytes        |\r\n| sql/pid            |      3 | 220.55 us     | 29.29 µs    | 73.52 µs    | 143.11 µs   |          0 | 0 bytes    | 0 bytes   |           1 | 5 bytes       | 5 bytes     | 5 bytes         |\r\n| sql/casetest       |      1 | 121.19 us     | 121.19 µs   | 121.19 µs   | 121.19 µs   |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     | 0 bytes         |\r\n| sql/binlog_index   |      5 | 593.47 us     | 1.07 µs     | 118.69 µs   | 535.90 µs   |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     | 0 bytes         |\r\n| sql/misc           |     23 | 2.73 ms       | 65.14 us    | 118.50 µs   | 255.31 µs   |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     | 0 bytes         |\r\n+--------------------+--------+---------------+-------------+-------------+-------------+------------+------------+-----------+-------------+---------------+-------------+-----------------+\r\n```\r\n\r\n#### io_global_by_wait_by_latency / x$io_global_by_wait_by_latency\r\n\r\n##### Description\r\n\r\nShows the top global IO consumers by latency.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc io_global_by_wait_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| event_name    | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n| read_latency  | text                | YES  |     | NULL    |       |\r\n| write_latency | text                | YES  |     | NULL    |       |\r\n| misc_latency  | text                | YES  |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read    | text                | YES  |     | NULL    |       |\r\n| avg_read      | text                | YES  |     | NULL    |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written | text                | YES  |     | NULL    |       |\r\n| avg_written   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n14 rows in set (0.19 sec)\r\n\r\nmysql> desc x$io_global_by_wait_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| event_name    | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| read_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| write_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| misc_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| count_read    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_read    | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_read      | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n| count_write   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_written | bigint(20)          | NO   |     | NULL    |       |\r\n| avg_written   | decimal(23,4)       | NO   |     | 0.0000  |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n14 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> SELECT * FROM io_global_by_wait_by_latency;\r\n+-------------------------+-------+---------------+-------------+-------------+--------------+---------------+--------------+------------+------------+-----------+-------------+---------------+-------------+\r\n| event_name              | total | total_latency | avg_latency | max_latency | read_latency | write_latency | misc_latency | count_read | total_read | avg_read  | count_write | total_written | avg_written |\r\n+-------------------------+-------+---------------+-------------+-------------+--------------+---------------+--------------+------------+------------+-----------+-------------+---------------+-------------+\r\n| sql/file_parser         |  5433 | 30.20 s       | 5.56 ms     | 203.65 ms   | 22.08 ms     | 24.89 ms      | 30.16 s      |         24 | 6.18 KiB   | 264 bytes |         737 | 2.15 MiB      | 2.99 KiB    |\r\n| innodb/innodb_data_file |  1344 | 1.52 s        | 1.13 ms     | 350.70 ms   | 203.82 ms    | 450.96 ms     | 868.21 ms    |        147 | 2.30 MiB   | 16.00 KiB |        1001 | 53.61 MiB     | 54.84 KiB   |\r\n| innodb/innodb_log_file  |   828 | 893.48 ms     | 1.08 ms     | 30.11 ms    | 16.32 ms     | 705.89 ms     | 171.27 ms    |          6 | 68.00 KiB  | 11.33 KiB |         413 | 2.19 MiB      | 5.42 KiB    |\r\n| myisam/kfile            |  7642 | 242.34 ms     | 31.71 us    | 19.27 ms    | 73.60 ms     | 23.48 ms      | 145.26 ms    |        758 | 135.63 KiB | 183 bytes |        4386 | 232.52 KiB    | 54 bytes    |\r\n| myisam/dfile            | 12540 | 223.47 ms     | 17.82 us    | 32.50 ms    | 87.76 ms     | 16.97 ms      | 118.74 ms    |       5390 | 4.49 MiB   | 873 bytes |        1448 | 2.65 MiB      | 1.88 KiB    |\r\n| csv/metadata            |     8 | 28.98 ms      | 3.62 ms     | 20.15 ms    | 399.27 us    | 0 ps          | 28.58 ms     |          2 | 70 bytes   | 35 bytes  |           0 | 0 bytes       | 0 bytes     |\r\n| mysys/charset           |     3 | 24.24 ms      | 8.08 ms     | 24.15 ms    | 24.15 ms     | 0 ps          | 93.18 us     |          1 | 17.31 KiB  | 17.31 KiB |           0 | 0 bytes       | 0 bytes     |\r\n| sql/ERRMSG              |     5 | 20.43 ms      | 4.09 ms     | 19.31 ms    | 20.32 ms     | 0 ps          | 103.20 us    |          3 | 58.97 KiB  | 19.66 KiB |           0 | 0 bytes       | 0 bytes     |\r\n| mysys/cnf               |     5 | 11.37 ms      | 2.27 ms     | 11.28 ms    | 11.29 ms     | 0 ps          | 78.22 us     |          3 | 56 bytes   | 19 bytes  |           0 | 0 bytes       | 0 bytes     |\r\n| sql/dbopt               |    57 | 4.04 ms       | 70.92 us    | 843.70 us   | 0 ps         | 186.43 us     | 3.86 ms      |          0 | 0 bytes    | 0 bytes   |           7 | 431 bytes     | 62 bytes    |\r\n| csv/data                |     4 | 411.55 us     | 102.89 us   | 234.89 us   | 0 ps         | 0 ps          | 411.55 us    |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     |\r\n| sql/misc                |    22 | 340.38 us     | 15.47 us    | 33.77 us    | 0 ps         | 0 ps          | 340.38 us    |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     |\r\n| archive/data            |    39 | 277.86 us     | 7.12 us     | 16.18 us    | 0 ps         | 0 ps          | 277.86 us    |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     |\r\n| sql/pid                 |     3 | 218.03 us     | 72.68 us    | 154.84 us   | 0 ps         | 21.64 us      | 196.39 us    |          0 | 0 bytes    | 0 bytes   |           1 | 6 bytes       | 6 bytes     |\r\n| sql/casetest            |     5 | 197.15 us     | 39.43 us    | 126.31 us   | 0 ps         | 0 ps          | 197.15 us    |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     |\r\n| sql/global_ddl_log      |     2 | 14.60 us      | 7.30 us     | 12.12 us    | 0 ps         | 0 ps          | 14.60 us     |          0 | 0 bytes    | 0 bytes   |           0 | 0 bytes       | 0 bytes     |\r\n+-------------------------+-------+---------------+-------------+-------------+--------------+---------------+--------------+------------+------------+-----------+-------------+---------------+-------------+\r\n```\r\n\r\n#### latest_file_io / x$latest_file_io\r\n\r\n##### Description\r\n\r\nShows the latest file IO, by file / thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc latest_file_io;\r\n+-----------+--------------+------+-----+---------+-------+\r\n| Field     | Type         | Null | Key | Default | Extra |\r\n+-----------+--------------+------+-----+---------+-------+\r\n| thread    | varchar(149) | YES  |     | NULL    |       |\r\n| file      | varchar(512) | YES  |     | NULL    |       |\r\n| latency   | text         | YES  |     | NULL    |       |\r\n| operation | varchar(32)  | NO   |     | NULL    |       |\r\n| requested | text         | YES  |     | NULL    |       |\r\n+-----------+--------------+------+-----+---------+-------+\r\n5 rows in set (0.10 sec)\r\n\r\nmysql> desc x$latest_file_io;\r\n+-----------+---------------------+------+-----+---------+-------+\r\n| Field     | Type                | Null | Key | Default | Extra |\r\n+-----------+---------------------+------+-----+---------+-------+\r\n| thread    | varchar(149)        | YES  |     | NULL    |       |\r\n| file      | varchar(512)        | YES  |     | NULL    |       |\r\n| latency   | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| operation | varchar(32)         | NO   |     | NULL    |       |\r\n| requested | bigint(20)          | YES  |     | NULL    |       |\r\n+-----------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.05 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from latest_file_io limit 5;\r\n+----------------------+----------------------------------------+------------+-----------+-----------+\r\n| thread               | file                                   | latency    | operation | requested |\r\n+----------------------+----------------------------------------+------------+-----------+-----------+\r\n| msandbox@localhost:1 | @@tmpdir/#sqlcf28_1_4e.MYI             | 9.26 us    | write     | 124 bytes |\r\n| msandbox@localhost:1 | @@tmpdir/#sqlcf28_1_4e.MYI             | 4.00 us    | write     | 2 bytes   |\r\n| msandbox@localhost:1 | @@tmpdir/#sqlcf28_1_4e.MYI             | 56.34 us   | close     | NULL      |\r\n| msandbox@localhost:1 | @@tmpdir/#sqlcf28_1_4e.MYD             | 53.93 us   | close     | NULL      |\r\n| msandbox@localhost:1 | @@tmpdir/#sqlcf28_1_4e.MYI             | 104.05 ms  | delete    | NULL      |\r\n+----------------------+----------------------------------------+------------+-----------+-----------+\r\n```\r\n\r\n#### memory_by_host_by_current_bytes / x$memory_by_host_by_current_bytes\r\n\r\n##### Description\r\n\r\nSummarizes memory use by host using the 5.7 Performance Schema instrumentation.\r\n\r\nWhen the host found is NULL, it is assumed to be a local \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc memory_by_host_by_current_bytes;\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| Field              | Type          | Null | Key | Default | Extra |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| host               | varchar(60)   | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_allocated  | text          | YES  |     | NULL    |       |\r\n| current_avg_alloc  | text          | YES  |     | NULL    |       |\r\n| current_max_alloc  | text          | YES  |     | NULL    |       |\r\n| total_allocated    | text          | YES  |     | NULL    |       |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.24 sec)\r\n\r\nmysql> desc x$memory_by_host_by_current_bytes;\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| Field              | Type          | Null | Key | Default | Extra |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| host               | varchar(60)   | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_allocated  | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_avg_alloc  | decimal(45,4) | NO   |     | 0.0000  |       |\r\n| current_max_alloc  | bigint(20)    | YES  |     | NULL    |       |\r\n| total_allocated    | decimal(42,0) | YES  |     | NULL    |       |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.28 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from memory_by_host_by_current_bytes WHERE host IS NOT NULL;\r\n   +------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n   | host       | current_count_used | current_allocated | current_avg_alloc | current_max_alloc | total_allocated |\r\n   +------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n   | background |               2773 | 10.84 MiB         | 4.00 KiB          | 8.00 MiB          | 30.69 MiB       |\r\n   | localhost  |               1509 | 809.30 KiB        | 549 bytes         | 176.38 KiB        | 83.59 MiB       |\r\n   +------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n```\r\n\r\n#### memory_by_thread_by_current_bytes / x$memory_by_thread_by_current_bytes\r\n\r\n##### Description\r\n\r\nSummarizes memory use by user using the 5.7 Performance Schema instrumentation.\r\n\r\nThe user columns shows either the background or foreground user name appropriately.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc memory_by_thread_by_current_bytes;\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n| Field              | Type                | Null | Key | Default | Extra |\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n| thread_id          | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| user               | varchar(128)        | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0)       | YES  |     | NULL    |       |\r\n| current_allocated  | text                | YES  |     | NULL    |       |\r\n| current_avg_alloc  | text                | YES  |     | NULL    |       |\r\n| current_max_alloc  | text                | YES  |     | NULL    |       |\r\n| total_allocated    | text                | YES  |     | NULL    |       |\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n7 rows in set (0.49 sec)\r\n\r\nmysql> desc x$memory_by_thread_by_current_bytes;\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n| Field              | Type                | Null | Key | Default | Extra |\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n| thread_id          | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| user               | varchar(128)        | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0)       | YES  |     | NULL    |       |\r\n| current_allocated  | decimal(41,0)       | YES  |     | NULL    |       |\r\n| current_avg_alloc  | decimal(45,4)       | NO   |     | 0.0000  |       |\r\n| current_max_alloc  | bigint(20)          | YES  |     | NULL    |       |\r\n| total_allocated    | decimal(42,0)       | YES  |     | NULL    |       |\r\n+--------------------+---------------------+------+-----+---------+-------+\r\n7 rows in set (0.25 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from sys.memory_by_thread_by_current_bytes limit 5;\r\n+-----------+----------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n| thread_id | user           | current_count_used | current_allocated | current_avg_alloc | current_max_alloc | total_allocated |\r\n+-----------+----------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n|         1 | sql/main       |              29333 | 166.02 MiB        | 5.80 KiB          | 131.13 MiB        | 196.00 MiB      |\r\n|        55 | root@localhost |                175 | 1.04 MiB          | 6.09 KiB          | 350.86 KiB        | 67.37 MiB       |\r\n|        58 | root@localhost |                236 | 368.13 KiB        | 1.56 KiB          | 312.05 KiB        | 130.34 MiB      |\r\n|       904 | root@localhost |                 32 | 18.00 KiB         | 576 bytes         | 16.00 KiB         | 6.68 MiB        |\r\n|       970 | root@localhost |                 12 | 16.80 KiB         | 1.40 KiB          | 16.00 KiB         | 1.20 MiB        |\r\n+-----------+----------------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n```\r\n\r\n#### memory_by_user_by_current_bytes / x$memory_by_user_by_current_bytes\r\n\r\n##### Description\r\n\r\nSummarizes memory use by user using the 5.7 Performance Schema instrumentation.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc memory_by_user_by_current_bytes;\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| Field              | Type          | Null | Key | Default | Extra |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| user               | varchar(32)   | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_allocated  | text          | YES  |     | NULL    |       |\r\n| current_avg_alloc  | text          | YES  |     | NULL    |       |\r\n| current_max_alloc  | text          | YES  |     | NULL    |       |\r\n| total_allocated    | text          | YES  |     | NULL    |       |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.06 sec)\r\n\r\nmysql> desc x$memory_by_user_by_current_bytes;\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| Field              | Type          | Null | Key | Default | Extra |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n| user               | varchar(32)   | YES  |     | NULL    |       |\r\n| current_count_used | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_allocated  | decimal(41,0) | YES  |     | NULL    |       |\r\n| current_avg_alloc  | decimal(45,4) | NO   |     | 0.0000  |       |\r\n| current_max_alloc  | bigint(20)    | YES  |     | NULL    |       |\r\n| total_allocated    | decimal(42,0) | YES  |     | NULL    |       |\r\n+--------------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.12 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from memory_by_user_by_current_bytes;\r\n+------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n| user | current_count_used | current_allocated | current_avg_alloc | current_max_alloc | total_allocated |\r\n+------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n| root |               1401 | 1.09 MiB          | 815 bytes         | 334.97 KiB        | 42.73 MiB       |\r\n| mark |                201 | 496.08 KiB        | 2.47 KiB          | 334.97 KiB        | 5.50 MiB        |\r\n+------+--------------------+-------------------+-------------------+-------------------+-----------------+\r\n```\r\n\r\n#### memory_global_by_current_bytes / x$memory_global_by_current_bytes\r\n\r\n##### Description\r\n\r\nShows the current memory usage within the server globally broken down by allocation type.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc memory_global_by_current_bytes;\r\n+-------------------+--------------+------+-----+---------+-------+\r\n| Field             | Type         | Null | Key | Default | Extra |\r\n+-------------------+--------------+------+-----+---------+-------+\r\n| event_name        | varchar(128) | NO   |     | NULL    |       |\r\n| current_count     | bigint(20)   | NO   |     | NULL    |       |\r\n| current_alloc     | text         | YES  |     | NULL    |       |\r\n| current_avg_alloc | text         | YES  |     | NULL    |       |\r\n| high_count        | bigint(20)   | NO   |     | NULL    |       |\r\n| high_alloc        | text         | YES  |     | NULL    |       |\r\n| high_avg_alloc    | text         | YES  |     | NULL    |       |\r\n+-------------------+--------------+------+-----+---------+-------+\r\n7 rows in set (0.08 sec)\r\n\r\nmysql> desc x$memory_global_by_current_bytes;\r\n+-------------------+---------------+------+-----+---------+-------+\r\n| Field             | Type          | Null | Key | Default | Extra |\r\n+-------------------+---------------+------+-----+---------+-------+\r\n| event_name        | varchar(128)  | NO   |     | NULL    |       |\r\n| current_count     | bigint(20)    | NO   |     | NULL    |       |\r\n| current_alloc     | bigint(20)    | NO   |     | NULL    |       |\r\n| current_avg_alloc | decimal(23,4) | NO   |     | 0.0000  |       |\r\n| high_count        | bigint(20)    | NO   |     | NULL    |       |\r\n| high_alloc        | bigint(20)    | NO   |     | NULL    |       |\r\n| high_avg_alloc    | decimal(23,4) | NO   |     | 0.0000  |       |\r\n+-------------------+---------------+------+-----+---------+-------+\r\n7 rows in set (0.16 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from memory_global_by_current_bytes;\r\n+----------------------------------------+---------------+---------------+-------------------+------------+------------+----------------+\r\n| event_name                             | current_count | current_alloc | current_avg_alloc | high_count | high_alloc | high_avg_alloc |\r\n+----------------------------------------+---------------+---------------+-------------------+------------+------------+----------------+\r\n| memory/sql/TABLE_SHARE::mem_root       |           269 | 568.21 KiB    | 2.11 KiB          |        339 | 706.04 KiB | 2.08 KiB       |\r\n| memory/sql/TABLE                       |           214 | 366.56 KiB    | 1.71 KiB          |        245 | 481.13 KiB | 1.96 KiB       |\r\n| memory/sql/sp_head::main_mem_root      |            32 | 334.97 KiB    | 10.47 KiB         |        421 | 9.73 MiB   | 23.66 KiB      |\r\n| memory/sql/Filesort_buffer::sort_keys  |             1 | 255.89 KiB    | 255.89 KiB        |          1 | 256.00 KiB | 256.00 KiB     |\r\n| memory/mysys/array_buffer              |            82 | 121.66 KiB    | 1.48 KiB          |       1124 | 852.55 KiB | 777 bytes      |\r\n...\r\n+----------------------------------------+---------------+---------------+-------------------+------------+------------+----------------+\r\n```\r\n\r\n#### memory_global_total / x$memory_global_total\r\n\r\n##### Description\r\n\r\nShows the total memory usage within the server globally.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc memory_global_total;\r\n+-----------------+------+------+-----+---------+-------+\r\n| Field           | Type | Null | Key | Default | Extra |\r\n+-----------------+------+------+-----+---------+-------+\r\n| total_allocated | text | YES  |     | NULL    |       |\r\n+-----------------+------+------+-----+---------+-------+\r\n1 row in set (0.07 sec)\r\n\r\nmysql> desc x$memory_global_total;\r\n+-----------------+---------------+------+-----+---------+-------+\r\n| Field           | Type          | Null | Key | Default | Extra |\r\n+-----------------+---------------+------+-----+---------+-------+\r\n| total_allocated | decimal(41,0) | YES  |     | NULL    |       |\r\n+-----------------+---------------+------+-----+---------+-------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from memory_global_total;\r\n+-----------------+\r\n| total_allocated |\r\n+-----------------+\r\n| 458.44 MiB      |\r\n+-----------------+\r\n```\r\n\r\n#### metrics\r\n\r\n##### Description\r\n\r\nCreates a union of the following information:\r\n\r\n   *  performance_schema.global_status (information_schema.GLOBAL_STATUS in MySQL 5.6)\r\n   *  information_schema.INNODB_METRICS\r\n   *  Performance Schema global memory usage information (only in MySQL 5.7)\r\n   *  Current time\r\n\r\nIn MySQL 5.7 it is required that performance_schema = ON, though there is no requirements to which\r\ninstruments and consumers that are enabled. See also the description of the Enabled column below.\r\n\r\nFor view has the following columns:\r\n\r\n   * Variable_name: The name of the variable\r\n   * Variable_value: The value of the variable\r\n   * Type: The type of the variable. This will depend on the source, e.g. Global Status, InnoDB Metrics - ..., etc.\r\n   * Enabled: Whether the variable is enabled or not. Possible values are 'YES', 'NO', 'PARTIAL'.\r\n     PARTIAL is currently only supported for the memory usage variables and means some but not all of the memory/% instruments are enabled.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> DESC metrics;\r\n+----------------+--------------+------+-----+---------+-------+\r\n| Field          | Type         | Null | Key | Default | Extra |\r\n+----------------+--------------+------+-----+---------+-------+\r\n| Variable_name  | varchar(193) | YES  |     | NULL    |       |\r\n| Variable_value | text         | YES  |     | NULL    |       |\r\n| Type           | varchar(210) | YES  |     | NULL    |       |\r\n| Enabled        | varchar(7)   | NO   |     |         |       |\r\n+----------------+--------------+------+-----+---------+-------+\r\n4 rows in set (0.00 sec)\r\n\r\nmysq> DESC metrics_56;\r\n+----------------+--------------+------+-----+---------+-------+\r\n| Field          | Type         | Null | Key | Default | Extra |\r\n+----------------+--------------+------+-----+---------+-------+\r\n| Variable_name  | varchar(193) | YES  |     | NULL    |       |\r\n| Variable_value | text         | YES  |     | NULL    |       |\r\n| Type           | varchar(210) | YES  |     | NULL    |       |\r\n| Enabled        | varchar(7)   | NO   |     |         |       |\r\n+----------------+--------------+------+-----+---------+-------+\r\n4 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> SELECT * FROM metrics;\r\n+-----------------------------------------------+-------------------------...+--------------------------------------+---------+\r\n| Variable_name                                 | Variable_value          ...| Type                                 | Enabled |\r\n+-----------------------------------------------+-------------------------...+--------------------------------------+---------+\r\n| aborted_clients                               | 0                       ...| Global Status                        | YES     |\r\n| aborted_connects                              | 0                       ...| Global Status                        | YES     |\r\n| binlog_cache_disk_use                         | 0                       ...| Global Status                        | YES     |\r\n| binlog_cache_use                              | 0                       ...| Global Status                        | YES     |\r\n| binlog_stmt_cache_disk_use                    | 0                       ...| Global Status                        | YES     |\r\n| binlog_stmt_cache_use                         | 0                       ...| Global Status                        | YES     |\r\n| bytes_received                                | 217081                  ...| Global Status                        | YES     |\r\n| bytes_sent                                    | 27257                   ...| Global Status                        | YES     |\r\n...\r\n| innodb_rwlock_x_os_waits                      | 0                       ...| InnoDB Metrics - server              | YES     |\r\n| innodb_rwlock_x_spin_rounds                   | 2723                    ...| InnoDB Metrics - server              | YES     |\r\n| innodb_rwlock_x_spin_waits                    | 1                       ...| InnoDB Metrics - server              | YES     |\r\n| trx_active_transactions                       | 0                       ...| InnoDB Metrics - transaction         | NO      |\r\n...\r\n| trx_rseg_current_size                         | 0                       ...| InnoDB Metrics - transaction         | NO      |\r\n| trx_rseg_history_len                          | 4                       ...| InnoDB Metrics - transaction         | YES     |\r\n| trx_rw_commits                                | 0                       ...| InnoDB Metrics - transaction         | NO      |\r\n| trx_undo_slots_cached                         | 0                       ...| InnoDB Metrics - transaction         | NO      |\r\n| trx_undo_slots_used                           | 0                       ...| InnoDB Metrics - transaction         | NO      |\r\n| memory_current_allocated                      | 138244216               ...| Performance Schema                   | PARTIAL |\r\n| memory_total_allocated                        | 138244216               ...| Performance Schema                   | PARTIAL |\r\n| NOW()                                         | 2015-05-31 13:27:50.382 ...| System Time                          | YES     |\r\n| UNIX_TIMESTAMP()                              | 1433042870.382          ...| System Time                          | YES     |\r\n+-----------------------------------------------+-------------------------...+--------------------------------------+---------+\r\n412 rows in set (0.02 sec)\r\n```\r\n\r\n#### processlist / x$processlist\r\n\r\n##### Description\r\n\r\nA detailed non-blocking processlist view to replace [INFORMATION_SCHEMA. | SHOW FULL] PROCESSLIST.\r\n\r\nPerforms less locking than the legacy sources, whilst giving extra information.\r\n\r\nThe output includes both background threads and user connections by default.  See also `session` / `x$session`\r\nfor a view that contains only user session information.\r\n\r\n##### Structures (5.7)\r\n\r\n```SQL\r\nmysql> desc processlist;\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| Field                  | Type                                     | Null | Key | Default | Extra |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| thd_id                 | bigint(20) unsigned                      | NO   |     | NULL    |       |\r\n| conn_id                | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| user                   | varchar(128)                             | YES  |     | NULL    |       |\r\n| db                     | varchar(64)                              | YES  |     | NULL    |       |\r\n| command                | varchar(16)                              | YES  |     | NULL    |       |\r\n| state                  | varchar(64)                              | YES  |     | NULL    |       |\r\n| time                   | bigint(20)                               | YES  |     | NULL    |       |\r\n| current_statement      | longtext                                 | YES  |     | NULL    |       |\r\n| statement_latency      | text                                     | YES  |     | NULL    |       |\r\n| progress               | decimal(26,2)                            | YES  |     | NULL    |       |\r\n| lock_latency           | text                                     | YES  |     | NULL    |       |\r\n| rows_examined          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_sent              | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_affected          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_tables             | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_disk_tables        | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| full_scan              | varchar(3)                               | NO   |     |         |       |\r\n| last_statement         | longtext                                 | YES  |     | NULL    |       |\r\n| last_statement_latency | text                                     | YES  |     | NULL    |       |\r\n| current_memory         | text                                     | YES  |     | NULL    |       |\r\n| last_wait              | varchar(128)                             | YES  |     | NULL    |       |\r\n| last_wait_latency      | text                                     | YES  |     | NULL    |       |\r\n| source                 | varchar(64)                              | YES  |     | NULL    |       |\r\n| trx_latency            | text                                     | YES  |     | NULL    |       |\r\n| trx_state              | enum('ACTIVE','COMMITTED','ROLLED BACK') | YES  |     | NULL    |       |\r\n| trx_autocommit         | enum('YES','NO')                         | YES  |     | NULL    |       |\r\n| pid                    | varchar(1024)                            | YES  |     | NULL    |       |\r\n| program_name           | varchar(1024)                            | YES  |     | NULL    |       |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n28 rows in set (0.04 sec)\r\n\r\nmysql> desc x$processlist;\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| Field                  | Type                                     | Null | Key | Default | Extra |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| thd_id                 | bigint(20) unsigned                      | NO   |     | NULL    |       |\r\n| conn_id                | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| user                   | varchar(128)                             | YES  |     | NULL    |       |\r\n| db                     | varchar(64)                              | YES  |     | NULL    |       |\r\n| command                | varchar(16)                              | YES  |     | NULL    |       |\r\n| state                  | varchar(64)                              | YES  |     | NULL    |       |\r\n| time                   | bigint(20)                               | YES  |     | NULL    |       |\r\n| current_statement      | longtext                                 | YES  |     | NULL    |       |\r\n| statement_latency      | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| progress               | decimal(26,2)                            | YES  |     | NULL    |       |\r\n| lock_latency           | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_examined          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_sent              | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_affected          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_tables             | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_disk_tables        | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| full_scan              | varchar(3)                               | NO   |     |         |       |\r\n| last_statement         | longtext                                 | YES  |     | NULL    |       |\r\n| last_statement_latency | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| current_memory         | decimal(41,0)                            | YES  |     | NULL    |       |\r\n| last_wait              | varchar(128)                             | YES  |     | NULL    |       |\r\n| last_wait_latency      | varchar(20)                              | YES  |     | NULL    |       |\r\n| source                 | varchar(64)                              | YES  |     | NULL    |       |\r\n| trx_latency            | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| trx_state              | enum('ACTIVE','COMMITTED','ROLLED BACK') | YES  |     | NULL    |       |\r\n| trx_autocommit         | enum('YES','NO')                         | YES  |     | NULL    |       |\r\n| pid                    | varchar(1024)                            | YES  |     | NULL    |       |\r\n| program_name           | varchar(1024)                            | YES  |     | NULL    |       |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n28 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from sys.processlist where conn_id is not null and command != 'daemon' and conn_id != connection_id()\\G\r\n*************************** 1. row ***************************\r\n                thd_id: 44524\r\n               conn_id: 44502\r\n                  user: msandbox@localhost\r\n                    db: test\r\n               command: Query\r\n                 state: alter table (flush)\r\n                  time: 18\r\n     current_statement: alter table t1 add column g int\r\n     statement_latency: 18.45 s\r\n              progress: 98.84\r\n          lock_latency: 265.43 ms\r\n         rows_examined: 0\r\n             rows_sent: 0\r\n         rows_affected: 0\r\n            tmp_tables: 0\r\n       tmp_disk_tables: 0\r\n             full_scan: NO\r\n        last_statement: NULL\r\nlast_statement_latency: NULL\r\n        current_memory: 664.06 KiB\r\n             last_wait: wait/io/file/innodb/innodb_data_file\r\n     last_wait_latency: 1.07 us\r\n                source: fil0fil.cc:5146\r\n           trx_latency: NULL\r\n             trx_state: NULL\r\n        trx_autocommit: NULL\r\n                   pid: 4212\r\n          program_name: mysql\r\n```\r\n\r\n#### ps_check_lost_instrumentation\r\n\r\n##### Description\r\n\r\nUsed to check whether Performance Schema is not able to monitor all runtime data - only returns variables that have lost instruments\r\n\r\n##### Structure\r\n\r\n```SQL\r\nmysql> desc ps_check_lost_instrumentation;\r\n+----------------+---------------+------+-----+---------+-------+\r\n| Field          | Type          | Null | Key | Default | Extra |\r\n+----------------+---------------+------+-----+---------+-------+\r\n| variable_name  | varchar(64)   | NO   |     |         |       |\r\n| variable_value | varchar(1024) | YES  |     | NULL    |       |\r\n+----------------+---------------+------+-----+---------+-------+\r\n2 rows in set (0.09 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from ps_check_lost_instrumentation;\r\n+----------------------------------------+----------------+\r\n| variable_name                          | variable_value |\r\n+----------------------------------------+----------------+\r\n| Performance_schema_file_handles_lost   | 101223         |\r\n| Performance_schema_file_instances_lost | 1231           |\r\n+----------------------------------------+----------------+\r\n```\r\n\r\n#### schema_auto_increment_columns\r\n\r\n##### Description\r\n\r\nPresent current auto_increment usage/capacity in all tables.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_auto_increment_columns;\r\n+----------------------+------------------------+------+-----+---------+-------+\r\n| Field                | Type                   | Null | Key | Default | Extra |\r\n+----------------------+------------------------+------+-----+---------+-------+\r\n| table_schema         | varchar(64)            | NO   |     |         |       |\r\n| table_name           | varchar(64)            | NO   |     |         |       |\r\n| column_name          | varchar(64)            | NO   |     |         |       |\r\n| data_type            | varchar(64)            | NO   |     |         |       |\r\n| column_type          | longtext               | NO   |     | NULL    |       |\r\n| is_signed            | int(1)                 | NO   |     | 0       |       |\r\n| is_unsigned          | int(1)                 | NO   |     | 0       |       |\r\n| max_value            | bigint(21) unsigned    | YES  |     | NULL    |       |\r\n| auto_increment       | bigint(21) unsigned    | YES  |     | NULL    |       |\r\n| auto_increment_ratio | decimal(25,4) unsigned | YES  |     | NULL    |       |\r\n+----------------------+------------------------+------+-----+---------+-------+\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_auto_increment_columns limit 5;\r\n+-------------------+-------------------+-------------+-----------+-------------+-----------+-------------+---------------------+----------------+----------------------+\r\n| table_schema      | table_name        | column_name | data_type | column_type | is_signed | is_unsigned | max_value           | auto_increment | auto_increment_ratio |\r\n+-------------------+-------------------+-------------+-----------+-------------+-----------+-------------+---------------------+----------------+----------------------+\r\n| test              | t1                | i           | tinyint   | tinyint(4)  |         1 |           0 |                 127 |             34 |               0.2677 |\r\n| mem__advisor_text | template_meta     | hib_id      | int       | int(11)     |         1 |           0 |          2147483647 |            516 |               0.0000 |\r\n| mem__advisors     | advisor_schedules | schedule_id | int       | int(11)     |         1 |           0 |          2147483647 |            249 |               0.0000 |\r\n| mem__advisors     | app_identity_path | hib_id      | int       | int(11)     |         1 |           0 |          2147483647 |            251 |               0.0000 |\r\n| mem__bean_config  | plists            | id          | bigint    | bigint(20)  |         1 |           0 | 9223372036854775807 |              1 |               0.0000 |\r\n+-------------------+-------------------+-------------+-----------+-------------+-----------+-------------+---------------------+----------------+----------------------+\r\n```\r\n\r\n#### schema_index_statistics / x$schema_index_statistics\r\n\r\n##### Description\r\n\r\nStatistics around indexes.\r\n\r\nOrdered by the total wait time descending - top indexes are most contended.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_index_statistics;\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| Field          | Type                | Null | Key | Default | Extra |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| table_schema   | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name     | varchar(64)         | YES  |     | NULL    |       |\r\n| index_name     | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_selected  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| select_latency | text                | YES  |     | NULL    |       |\r\n| rows_inserted  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency | text                | YES  |     | NULL    |       |\r\n| rows_updated   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency | text                | YES  |     | NULL    |       |\r\n| rows_deleted   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency | text                | YES  |     | NULL    |       |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n11 rows in set (0.17 sec)\r\n\r\nmysql> desc x$schema_index_statistics;\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| Field          | Type                | Null | Key | Default | Extra |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n| table_schema   | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name     | varchar(64)         | YES  |     | NULL    |       |\r\n| index_name     | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_selected  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| select_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_inserted  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_updated   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_deleted   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+----------------+---------------------+------+-----+---------+-------+\r\n11 rows in set (0.42 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_index_statistics limit 5;\r\n+------------------+-------------+------------+---------------+----------------+---------------+----------------+--------------+----------------+--------------+----------------+\r\n| table_schema     | table_name  | index_name | rows_selected | select_latency | rows_inserted | insert_latency | rows_updated | update_latency | rows_deleted | delete_latency |\r\n+------------------+-------------+------------+---------------+----------------+---------------+----------------+--------------+----------------+--------------+----------------+\r\n| mem              | mysqlserver | PRIMARY    |          6208 | 108.27 ms      |             0 | 0 ps           |         5470 | 1.47 s         |            0 | 0 ps           |\r\n| mem              | innodb      | PRIMARY    |          4666 | 76.27 ms       |             0 | 0 ps           |         4454 | 571.47 ms      |            0 | 0 ps           |\r\n| mem              | connection  | PRIMARY    |          1064 | 20.98 ms       |             0 | 0 ps           |         1064 | 457.30 ms      |            0 | 0 ps           |\r\n| mem              | environment | PRIMARY    |          5566 | 151.17 ms      |             0 | 0 ps           |          694 | 252.57 ms      |            0 | 0 ps           |\r\n| mem              | querycache  | PRIMARY    |          1698 | 27.99 ms       |             0 | 0 ps           |         1698 | 371.72 ms      |            0 | 0 ps           |\r\n+------------------+-------------+------------+---------------+----------------+---------------+----------------+--------------+----------------+--------------+----------------+\r\n```\r\n\r\n#### schema_object_overview\r\n\r\n##### Description\r\n\r\nShows an overview of the types of objects within each schema\r\n\r\nNote: On instances with a large numbers of objects, this could take some time to execute, and may not be recommended.\r\n\r\n##### Structure\r\n\r\n```SQL\r\nmysql> desc schema_object_overview;\r\n+-------------+-------------+------+-----+---------+-------+\r\n| Field       | Type        | Null | Key | Default | Extra |\r\n+-------------+-------------+------+-----+---------+-------+\r\n| db          | varchar(64) | NO   |     |         |       |\r\n| object_type | varchar(64) | NO   |     |         |       |\r\n| count       | bigint(21)  | NO   |     | 0       |       |\r\n+-------------+-------------+------+-----+---------+-------+\r\n3 rows in set (0.08 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_object_overview;\r\n+--------------------+---------------+-------+\r\n| db                 | object_type   | count |\r\n+--------------------+---------------+-------+\r\n| information_schema | SYSTEM VIEW   |    60 |\r\n| mysql              | BASE TABLE    |    31 |\r\n| mysql              | INDEX (BTREE) |    69 |\r\n| performance_schema | BASE TABLE    |    76 |\r\n| sys                | BASE TABLE    |     1 |\r\n| sys                | FUNCTION      |    12 |\r\n| sys                | INDEX (BTREE) |     1 |\r\n| sys                | PROCEDURE     |    22 |\r\n| sys                | TRIGGER       |     2 |\r\n| sys                | VIEW          |    91 |\r\n+--------------------+---------------+-------+\r\n10 rows in set (1.58 sec)\r\n```\r\n\r\n#### schema_table_statistics / x$schema_table_statistics\r\n\r\n##### Description\r\n\r\nStatistics around tables.\r\n\r\nOrdered by the total wait time descending - top tables are most contended.\r\n\r\nAlso includes the helper view (used by schema_table_statistics_with_buffer as well):\r\n\r\n* x$ps_schema_table_statistics_io\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_table_statistics;\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| Field             | Type                | Null | Key | Default | Extra |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| table_schema      | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name        | varchar(64)         | YES  |     | NULL    |       |\r\n| total_latency     | text                | YES  |     | NULL    |       |\r\n| rows_fetched      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| fetch_latency     | text                | YES  |     | NULL    |       |\r\n| rows_inserted     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency    | text                | YES  |     | NULL    |       |\r\n| rows_updated      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency    | text                | YES  |     | NULL    |       |\r\n| rows_deleted      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency    | text                | YES  |     | NULL    |       |\r\n| io_read_requests  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_read           | text                | YES  |     | NULL    |       |\r\n| io_read_latency   | text                | YES  |     | NULL    |       |\r\n| io_write_requests | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write          | text                | YES  |     | NULL    |       |\r\n| io_write_latency  | text                | YES  |     | NULL    |       |\r\n| io_misc_requests  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_latency   | text                | YES  |     | NULL    |       |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n19 rows in set (0.12 sec)\r\n\r\nmysql> desc x$schema_table_statistics;\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| Field             | Type                | Null | Key | Default | Extra |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| table_schema      | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name        | varchar(64)         | YES  |     | NULL    |       |\r\n| total_latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_fetched      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| fetch_latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_inserted     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_updated      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_deleted      | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency    | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| io_read_requests  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_read           | decimal(41,0)       | YES  |     | NULL    |       |\r\n| io_read_latency   | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write_requests | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write          | decimal(41,0)       | YES  |     | NULL    |       |\r\n| io_write_latency  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_requests  | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_latency   | decimal(42,0)       | YES  |     | NULL    |       |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n19 rows in set (0.13 sec)\r\n\r\nmysql> desc x$ps_schema_table_statistics_io;\r\n+---------------------------+---------------+------+-----+---------+-------+\r\n| Field                     | Type          | Null | Key | Default | Extra |\r\n+---------------------------+---------------+------+-----+---------+-------+\r\n| table_schema              | varchar(64)   | YES  |     | NULL    |       |\r\n| table_name                | varchar(64)   | YES  |     | NULL    |       |\r\n| count_read                | decimal(42,0) | YES  |     | NULL    |       |\r\n| sum_number_of_bytes_read  | decimal(41,0) | YES  |     | NULL    |       |\r\n| sum_timer_read            | decimal(42,0) | YES  |     | NULL    |       |\r\n| count_write               | decimal(42,0) | YES  |     | NULL    |       |\r\n| sum_number_of_bytes_write | decimal(41,0) | YES  |     | NULL    |       |\r\n| sum_timer_write           | decimal(42,0) | YES  |     | NULL    |       |\r\n| count_misc                | decimal(42,0) | YES  |     | NULL    |       |\r\n| sum_timer_misc            | decimal(42,0) | YES  |     | NULL    |       |\r\n+---------------------------+---------------+------+-----+---------+-------+\r\n10 rows in set (0.10 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_table_statistics\\G\r\n*************************** 1. row ***************************\r\n     table_schema: sys\r\n       table_name: sys_config\r\n    total_latency: 0 ps\r\n     rows_fetched: 0\r\n    fetch_latency: 0 ps\r\n    rows_inserted: 0\r\n   insert_latency: 0 ps\r\n     rows_updated: 0\r\n   update_latency: 0 ps\r\n     rows_deleted: 0\r\n   delete_latency: 0 ps\r\n io_read_requests: 8\r\n          io_read: 2.28 KiB\r\n  io_read_latency: 727.32 us\r\nio_write_requests: 0\r\n         io_write: 0 bytes\r\n io_write_latency: 0 ps\r\n io_misc_requests: 10\r\n  io_misc_latency: 126.88 us\r\n```\r\n\r\n#### schema_redundant_indexes / x$schema_flattened_keys\r\n\r\n##### Description\r\n\r\nShows indexes which are made redundant (or duplicate) by other (dominant) keys.\r\n\r\nAlso includes the the helper view `x$schema_flattened_keys`.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc sys.schema_redundant_indexes;\r\n+----------------------------+--------------+------+-----+---------+-------+\r\n| Field                      | Type         | Null | Key | Default | Extra |\r\n+----------------------------+--------------+------+-----+---------+-------+\r\n| table_schema               | varchar(64)  | NO   |     |         |       |\r\n| table_name                 | varchar(64)  | NO   |     |         |       |\r\n| redundant_index_name       | varchar(64)  | NO   |     |         |       |\r\n| redundant_index_columns    | text         | YES  |     | NULL    |       |\r\n| redundant_index_non_unique | bigint(1)    | YES  |     | NULL    |       |\r\n| dominant_index_name        | varchar(64)  | NO   |     |         |       |\r\n| dominant_index_columns     | text         | YES  |     | NULL    |       |\r\n| dominant_index_non_unique  | bigint(1)    | YES  |     | NULL    |       |\r\n| subpart_exists             | int(1)       | NO   |     | 0       |       |\r\n| sql_drop_index             | varchar(223) | YES  |     | NULL    |       |\r\n+----------------------------+--------------+------+-----+---------+-------+\r\n10 rows in set (0.00 sec)\r\n\r\nmysql> desc sys.x$schema_flattened_keys;\r\n+----------------+-------------+------+-----+---------+-------+\r\n| Field          | Type        | Null | Key | Default | Extra |\r\n+----------------+-------------+------+-----+---------+-------+\r\n| table_schema   | varchar(64) | NO   |     |         |       |\r\n| table_name     | varchar(64) | NO   |     |         |       |\r\n| index_name     | varchar(64) | NO   |     |         |       |\r\n| non_unique     | bigint(1)   | YES  |     | NULL    |       |\r\n| subpart_exists | bigint(1)   | YES  |     | NULL    |       |\r\n| index_columns  | text        | YES  |     | NULL    |       |\r\n+----------------+-------------+------+-----+---------+-------+\r\n6 rows in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from sys.schema_redundant_indexes\\G\r\n*************************** 1. row ***************************\r\n              table_schema: test\r\n                table_name: rkey\r\n      redundant_index_name: j\r\n   redundant_index_columns: j\r\nredundant_index_non_unique: 1\r\n       dominant_index_name: j_2\r\n    dominant_index_columns: j,k\r\n dominant_index_non_unique: 1\r\n            subpart_exists: 0\r\n            sql_drop_index: ALTER TABLE `test`.`rkey` DROP INDEX `j`\r\n1 row in set (0.20 sec)\r\n\r\nmysql> SHOW CREATE TABLE test.rkey\\G\r\n*************************** 1. row ***************************\r\n       Table: rkey\r\nCreate Table: CREATE TABLE `rkey` (\r\n  `i` int(11) NOT NULL,\r\n  `j` int(11) DEFAULT NULL,\r\n  `k` int(11) DEFAULT NULL,\r\n  PRIMARY KEY (`i`),\r\n  KEY `j` (`j`),\r\n  KEY `j_2` (`j`,`k`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\r\n1 row in set (0.06 sec)\r\n```\r\n\r\n#### schema_table_lock_waits / x$schema_table_lock_waits\r\n\r\n##### Description\r\n\r\nShows sessions that are blocked waiting on table metadata locks, and who is blocking them.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_table_lock_waits;\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n| Field                        | Type                | Null | Key | Default | Extra |\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n| object_schema                | varchar(64)         | YES  |     | NULL    |       |\r\n| object_name                  | varchar(64)         | YES  |     | NULL    |       |\r\n| waiting_thread_id            | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| waiting_pid                  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| waiting_account              | text                | YES  |     | NULL    |       |\r\n| waiting_lock_type            | varchar(32)         | NO   |     | NULL    |       |\r\n| waiting_lock_duration        | varchar(32)         | NO   |     | NULL    |       |\r\n| waiting_query                | longtext            | YES  |     | NULL    |       |\r\n| waiting_query_secs           | bigint(20)          | YES  |     | NULL    |       |\r\n| waiting_query_rows_affected  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| waiting_query_rows_examined  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| blocking_thread_id           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| blocking_pid                 | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| blocking_account             | text                | YES  |     | NULL    |       |\r\n| blocking_lock_type           | varchar(32)         | NO   |     | NULL    |       |\r\n| blocking_lock_duration       | varchar(32)         | NO   |     | NULL    |       |\r\n| sql_kill_blocking_query      | varchar(31)         | YES  |     | NULL    |       |\r\n| sql_kill_blocking_connection | varchar(25)         | YES  |     | NULL    |       |\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n18 rows in set (0.15 sec)\r\n\r\nmysql> desc x$schema_table_lock_waits;\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n| Field                        | Type                | Null | Key | Default | Extra |\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n| object_schema                | varchar(64)         | YES  |     | NULL    |       |\r\n| object_name                  | varchar(64)         | YES  |     | NULL    |       |\r\n| waiting_thread_id            | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| waiting_pid                  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| waiting_account              | text                | YES  |     | NULL    |       |\r\n| waiting_lock_type            | varchar(32)         | NO   |     | NULL    |       |\r\n| waiting_lock_duration        | varchar(32)         | NO   |     | NULL    |       |\r\n| waiting_query                | longtext            | YES  |     | NULL    |       |\r\n| waiting_query_secs           | bigint(20)          | YES  |     | NULL    |       |\r\n| waiting_query_rows_affected  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| waiting_query_rows_examined  | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| blocking_thread_id           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| blocking_pid                 | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| blocking_account             | text                | YES  |     | NULL    |       |\r\n| blocking_lock_type           | varchar(32)         | NO   |     | NULL    |       |\r\n| blocking_lock_duration       | varchar(32)         | NO   |     | NULL    |       |\r\n| sql_kill_blocking_query      | varchar(31)         | YES  |     | NULL    |       |\r\n| sql_kill_blocking_connection | varchar(25)         | YES  |     | NULL    |       |\r\n+------------------------------+---------------------+------+-----+---------+-------+\r\n18 rows in set (0.03 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from sys.schema_table_lock_waits\\G\r\n*************************** 1. row ***************************\r\n               object_schema: test\r\n                 object_name: t\r\n           waiting_thread_id: 43\r\n                 waiting_pid: 21\r\n             waiting_account: msandbox@localhost\r\n           waiting_lock_type: SHARED_UPGRADABLE\r\n       waiting_lock_duration: TRANSACTION\r\n               waiting_query: alter table test.t add foo int\r\n          waiting_query_secs: 988\r\n waiting_query_rows_affected: 0\r\n waiting_query_rows_examined: 0\r\n          blocking_thread_id: 42\r\n                blocking_pid: 20\r\n            blocking_account: msandbox@localhost\r\n          blocking_lock_type: SHARED_NO_READ_WRITE\r\n      blocking_lock_duration: TRANSACTION\r\n     sql_kill_blocking_query: KILL QUERY 20\r\nsql_kill_blocking_connection: KILL 20\r\n```\r\n\r\n#### schema_table_statistics_with_buffer / x$schema_table_statistics_with_buffer\r\n\r\n##### Description\r\n\r\nStatistics around tables.\r\n\r\nOrdered by the total wait time descending - top tables are most contended.\r\n\r\nMore statistics such as caching stats for the InnoDB buffer pool with InnoDB tables\r\n\r\nUses the x$ps_schema_table_statistics_io helper view from schema_table_statistics.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_table_statistics_with_buffer;\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n| Field                      | Type                | Null | Key | Default | Extra |\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n| table_schema               | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name                 | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_fetched               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| fetch_latency              | text                | YES  |     | NULL    |       |\r\n| rows_inserted              | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency             | text                | YES  |     | NULL    |       |\r\n| rows_updated               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency             | text                | YES  |     | NULL    |       |\r\n| rows_deleted               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency             | text                | YES  |     | NULL    |       |\r\n| io_read_requests           | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_read                    | text                | YES  |     | NULL    |       |\r\n| io_read_latency            | text                | YES  |     | NULL    |       |\r\n| io_write_requests          | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write                   | text                | YES  |     | NULL    |       |\r\n| io_write_latency           | text                | YES  |     | NULL    |       |\r\n| io_misc_requests           | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_latency            | text                | YES  |     | NULL    |       |\r\n| innodb_buffer_allocated    | text                | YES  |     | NULL    |       |\r\n| innodb_buffer_data         | text                | YES  |     | NULL    |       |\r\n| innodb_buffer_free         | text                | YES  |     | NULL    |       |\r\n| innodb_buffer_pages        | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_pages_hashed | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_pages_old    | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_rows_cached  | decimal(44,0)       | YES  |     | 0       |       |\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n25 rows in set (0.05 sec)\r\n\r\nmysql> desc x$schema_table_statistics_with_buffer;\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n| Field                      | Type                | Null | Key | Default | Extra |\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n| table_schema               | varchar(64)         | YES  |     | NULL    |       |\r\n| table_name                 | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_fetched               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| fetch_latency              | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_inserted              | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| insert_latency             | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_updated               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| update_latency             | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_deleted               | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| delete_latency             | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| io_read_requests           | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_read                    | decimal(41,0)       | YES  |     | NULL    |       |\r\n| io_read_latency            | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write_requests          | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_write                   | decimal(41,0)       | YES  |     | NULL    |       |\r\n| io_write_latency           | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_requests           | decimal(42,0)       | YES  |     | NULL    |       |\r\n| io_misc_latency            | decimal(42,0)       | YES  |     | NULL    |       |\r\n| innodb_buffer_allocated    | decimal(43,0)       | YES  |     | NULL    |       |\r\n| innodb_buffer_data         | decimal(43,0)       | YES  |     | NULL    |       |\r\n| innodb_buffer_free         | decimal(44,0)       | YES  |     | NULL    |       |\r\n| innodb_buffer_pages        | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_pages_hashed | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_pages_old    | bigint(21)          | YES  |     | 0       |       |\r\n| innodb_buffer_rows_cached  | decimal(44,0)       | YES  |     | 0       |       |\r\n+----------------------------+---------------------+------+-----+---------+-------+\r\n25 rows in set (0.17 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_table_statistics_with_buffer limit 1\\G\r\n*************************** 1. row ***************************\r\n                 table_schema: mem\r\n                   table_name: mysqlserver\r\n                 rows_fetched: 27087\r\n                fetch_latency: 442.72 ms\r\n                rows_inserted: 2\r\n               insert_latency: 185.04 us\r\n                 rows_updated: 5096\r\n               update_latency: 1.39 s\r\n                 rows_deleted: 0\r\n               delete_latency: 0 ps\r\n             io_read_requests: 2565\r\n                io_read_bytes: 1121627\r\n              io_read_latency: 10.07 ms\r\n            io_write_requests: 1691\r\n               io_write_bytes: 128383\r\n             io_write_latency: 14.17 ms\r\n             io_misc_requests: 2698\r\n              io_misc_latency: 433.66 ms\r\n          innodb_buffer_pages: 19\r\n   innodb_buffer_pages_hashed: 19\r\n      innodb_buffer_pages_old: 19\r\ninnodb_buffer_bytes_allocated: 311296\r\n     innodb_buffer_bytes_data: 1924\r\n    innodb_buffer_rows_cached: 2\r\n```\r\n\r\n#### schema_tables_with_full_table_scans / x$schema_tables_with_full_table_scans\r\n\r\n##### Description\r\n\r\nFinds tables that are being accessed by full table scans ordering by the number of rows scanned descending.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc schema_tables_with_full_table_scans;\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| Field             | Type                | Null | Key | Default | Extra |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| object_schema     | varchar(64)         | YES  |     | NULL    |       |\r\n| object_name       | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_full_scanned | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| latency           | text                | YES  |     | NULL    |       |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n4 rows in set (0.02 sec)\r\n\r\nmysql> desc x$schema_tables_with_full_table_scans;\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| Field             | Type                | Null | Key | Default | Extra |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n| object_schema     | varchar(64)         | YES  |     | NULL    |       |\r\n| object_name       | varchar(64)         | YES  |     | NULL    |       |\r\n| rows_full_scanned | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| latency           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+-------------------+---------------------+------+-----+---------+-------+\r\n4 rows in set (0.03 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_tables_with_full_table_scans limit 5;\r\n+--------------------+--------------------------------+-------------------+-----------+\r\n| object_schema      | object_name                    | rows_full_scanned | latency   |\r\n+--------------------+--------------------------------+-------------------+-----------+\r\n| mem30__instruments | fsstatistics                   |          10207042 | 13.10 s   |\r\n| mem30__instruments | preparedstatementapidata       |            436428 | 973.27 ms |\r\n| mem30__instruments | mysqlprocessactivity           |            411702 | 282.07 ms |\r\n| mem30__instruments | querycachequeriesincachedata   |            374011 | 767.15 ms |\r\n| mem30__instruments | rowaccessesdata                |            322321 | 1.55 s    |\r\n+--------------------+--------------------------------+-------------------+-----------+\r\n```\r\n\r\n#### schema_unused_indexes\r\n\r\n##### Description\r\n\r\nFinds indexes that have had no events against them (and hence, no usage).\r\n\r\nTo trust whether the data from this view is representative of your workload, you should ensure that the server has been up for a representative amount of time before using it.\r\n\r\nPRIMARY (key) indexes are ignored.\r\n\r\n##### Structure\r\n\r\n```SQL\r\nmysql> desc schema_unused_indexes;\r\n+---------------+-------------+------+-----+---------+-------+\r\n| Field         | Type        | Null | Key | Default | Extra |\r\n+---------------+-------------+------+-----+---------+-------+\r\n| object_schema | varchar(64) | YES  |     | NULL    |       |\r\n| object_name   | varchar(64) | YES  |     | NULL    |       |\r\n| index_name    | varchar(64) | YES  |     | NULL    |       |\r\n+---------------+-------------+------+-----+---------+-------+\r\n3 rows in set (0.09 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from schema_unused_indexes limit 5;\r\n+--------------------+---------------------+--------------------+\r\n| object_schema      | object_name         | index_name         |\r\n+--------------------+---------------------+--------------------+\r\n| mem30__bean_config | plists              | path               |\r\n| mem30__config      | group_selections    | name               |\r\n| mem30__config      | notification_groups | name               |\r\n| mem30__config      | user_form_defaults  | FKC1AEF1F9E7EE2CFB |\r\n| mem30__enterprise  | whats_new_entries   | entryId            |\r\n+--------------------+---------------------+--------------------+\r\n```\r\n\r\n#### session / x$session\r\n\r\n##### Description\r\n\r\nA detailed non-blocking processlist view to replace [INFORMATION_SCHEMA. | SHOW FULL] PROCESSLIST.\r\n\r\nPerforms less locking than the legacy sources, whilst giving extra information.\r\n\r\nThe output of this view is restricted to threads from user sessions.  See also processlist / x$processlist which contains both user and background threads.\r\n\r\n##### Structures (5.7)\r\n\r\n```SQL\r\nmysql> desc session;\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| Field                  | Type                                     | Null | Key | Default | Extra |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| thd_id                 | bigint(20) unsigned                      | NO   |     | NULL    |       |\r\n| conn_id                | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| user                   | varchar(128)                             | YES  |     | NULL    |       |\r\n| db                     | varchar(64)                              | YES  |     | NULL    |       |\r\n| command                | varchar(16)                              | YES  |     | NULL    |       |\r\n| state                  | varchar(64)                              | YES  |     | NULL    |       |\r\n| time                   | bigint(20)                               | YES  |     | NULL    |       |\r\n| current_statement      | longtext                                 | YES  |     | NULL    |       |\r\n| statement_latency      | text                                     | YES  |     | NULL    |       |\r\n| progress               | decimal(26,2)                            | YES  |     | NULL    |       |\r\n| lock_latency           | text                                     | YES  |     | NULL    |       |\r\n| rows_examined          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_sent              | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_affected          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_tables             | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_disk_tables        | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| full_scan              | varchar(3)                               | NO   |     |         |       |\r\n| last_statement         | longtext                                 | YES  |     | NULL    |       |\r\n| last_statement_latency | text                                     | YES  |     | NULL    |       |\r\n| current_memory         | text                                     | YES  |     | NULL    |       |\r\n| last_wait              | varchar(128)                             | YES  |     | NULL    |       |\r\n| last_wait_latency      | text                                     | YES  |     | NULL    |       |\r\n| source                 | varchar(64)                              | YES  |     | NULL    |       |\r\n| trx_latency            | text                                     | YES  |     | NULL    |       |\r\n| trx_state              | enum('ACTIVE','COMMITTED','ROLLED BACK') | YES  |     | NULL    |       |\r\n| trx_autocommit         | enum('YES','NO')                         | YES  |     | NULL    |       |\r\n| pid                    | varchar(1024)                            | YES  |     | NULL    |       |\r\n| program_name           | varchar(1024)                            | YES  |     | NULL    |       |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n28 rows in set (0.00 sec)\r\n\r\nmysql> desc x$session;\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| Field                  | Type                                     | Null | Key | Default | Extra |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n| thd_id                 | bigint(20) unsigned                      | NO   |     | NULL    |       |\r\n| conn_id                | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| user                   | varchar(128)                             | YES  |     | NULL    |       |\r\n| db                     | varchar(64)                              | YES  |     | NULL    |       |\r\n| command                | varchar(16)                              | YES  |     | NULL    |       |\r\n| state                  | varchar(64)                              | YES  |     | NULL    |       |\r\n| time                   | bigint(20)                               | YES  |     | NULL    |       |\r\n| current_statement      | longtext                                 | YES  |     | NULL    |       |\r\n| statement_latency      | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| progress               | decimal(26,2)                            | YES  |     | NULL    |       |\r\n| lock_latency           | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_examined          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_sent              | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| rows_affected          | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_tables             | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| tmp_disk_tables        | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| full_scan              | varchar(3)                               | NO   |     |         |       |\r\n| last_statement         | longtext                                 | YES  |     | NULL    |       |\r\n| last_statement_latency | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| current_memory         | decimal(41,0)                            | YES  |     | NULL    |       |\r\n| last_wait              | varchar(128)                             | YES  |     | NULL    |       |\r\n| last_wait_latency      | varchar(20)                              | YES  |     | NULL    |       |\r\n| source                 | varchar(64)                              | YES  |     | NULL    |       |\r\n| trx_latency            | bigint(20) unsigned                      | YES  |     | NULL    |       |\r\n| trx_state              | enum('ACTIVE','COMMITTED','ROLLED BACK') | YES  |     | NULL    |       |\r\n| trx_autocommit         | enum('YES','NO')                         | YES  |     | NULL    |       |\r\n| pid                    | varchar(1024)                            | YES  |     | NULL    |       |\r\n| program_name           | varchar(1024)                            | YES  |     | NULL    |       |\r\n+------------------------+------------------------------------------+------+-----+---------+-------+\r\n28 rows in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from sys.session\\G\r\n*************************** 1. row ***************************\r\n                thd_id: 24\r\n               conn_id: 2\r\n                  user: root@localhost\r\n                    db: sys\r\n               command: Query\r\n                 state: Sending data\r\n                  time: 0\r\n     current_statement: select * from sys.session\r\n     statement_latency: 137.22 ms\r\n              progress: NULL\r\n          lock_latency: 33.75 ms\r\n         rows_examined: 0\r\n             rows_sent: 0\r\n         rows_affected: 0\r\n            tmp_tables: 4\r\n       tmp_disk_tables: 1\r\n             full_scan: YES\r\n        last_statement: NULL\r\nlast_statement_latency: NULL\r\n        current_memory: 3.26 MiB\r\n             last_wait: wait/synch/mutex/innodb/file_format_max_mutex\r\n     last_wait_latency: 64.09 ns\r\n                source: trx0sys.cc:778\r\n           trx_latency: 7.88 s\r\n             trx_state: ACTIVE\r\n        trx_autocommit: NO\r\n                   pid: 4212\r\n          program_name: mysql\r\n```\r\n\r\n#### session_ssl_status\r\n\r\n##### Description\r\n\r\nShows SSL version, cipher and the count of re-used SSL sessions per connection\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc sys.session_ssl_status;\r\n+---------------------+---------------------+------+-----+---------+-------+\r\n| Field               | Type                | Null | Key | Default | Extra |\r\n+---------------------+---------------------+------+-----+---------+-------+\r\n| thread_id           | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| ssl_version         | varchar(1024)       | YES  |     | NULL    |       |\r\n| ssl_cipher          | varchar(1024)       | YES  |     | NULL    |       |\r\n| ssl_sessions_reused | varchar(1024)       | YES  |     | NULL    |       |\r\n+---------------------+---------------------+------+-----+---------+-------+\r\n4 rows in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from session_ssl_status;\r\n+-----------+-------------+--------------------+---------------------+\r\n| thread_id | ssl_version | ssl_cipher         | ssl_sessions_reused |\r\n+-----------+-------------+--------------------+---------------------+\r\n|        26 | TLSv1       | DHE-RSA-AES256-SHA | 0                   |\r\n|        27 | TLSv1       | DHE-RSA-AES256-SHA | 0                   |\r\n|        28 | TLSv1       | DHE-RSA-AES256-SHA | 0                   |\r\n+-----------+-------------+--------------------+---------------------+\r\n3 rows in set (0.00 sec)\r\n```\r\n\r\n#### statement_analysis / x$statement_analysis\r\n\r\n##### Description\r\n\r\nLists a normalized statement view with aggregated statistics, mimics the MySQL Enterprise Monitor Query Analysis view, ordered by the total execution time per normalized statement\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statement_analysis;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| full_scan         | varchar(1)          | NO   |     |                     |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| err_count         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warn_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | text                | YES  |     | NULL                |       |\r\n| max_latency       | text                | YES  |     | NULL                |       |\r\n| avg_latency       | text                | YES  |     | NULL                |       |\r\n| lock_latency      | text                | YES  |     | NULL                |       |\r\n| rows_sent         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent_avg     | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_examined     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_examined_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_affected     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_affected_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| tmp_tables        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| tmp_disk_tables   | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sorted       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| sort_merge_passes | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n23 rows in set (0.26 sec)\r\n\r\nmysql> desc x$statement_analysis;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| full_scan         | varchar(1)          | NO   |     |                     |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| err_count         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warn_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| max_latency       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_latency       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| lock_latency      | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent_avg     | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_examined     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_examined_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_affected     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_affected_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| tmp_tables        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| tmp_disk_tables   | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sorted       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| sort_merge_passes | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n23 rows in set (0.27 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statement_analysis limit 1\\G\r\n*************************** 1. row ***************************\r\n            query: SELECT * FROM `schema_object_o ... MA` , `information_schema` ...\r\n               db: sys\r\n        full_scan: *\r\n       exec_count: 2\r\n        err_count: 0\r\n       warn_count: 0\r\n    total_latency: 16.75 s\r\n      max_latency: 16.57 s\r\n      avg_latency: 8.38 s\r\n     lock_latency: 16.69 s\r\n        rows_sent: 84\r\n    rows_sent_avg: 42\r\n    rows_examined: 20012\r\nrows_examined_avg: 10006\r\n    rows_affected: 0\r\nrows_affected_avg: 0\r\n       tmp_tables: 378\r\n  tmp_disk_tables: 66\r\n      rows_sorted: 168\r\nsort_merge_passes: 0\r\n           digest: 54f9bd520f0bbf15db0c2ed93386bec9\r\n       first_seen: 2014-03-07 13:13:41\r\n        last_seen: 2014-03-07 13:13:48\r\n```\r\n\r\n#### statements_with_errors_or_warnings / x$statements_with_errors_or_warnings\r\n\r\n##### Description\r\n\r\nLists all normalized statements that have raised errors or warnings.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statements_with_errors_or_warnings;\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n| Field       | Type                | Null | Key | Default             | Extra |\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n| query       | longtext            | YES  |     | NULL                |       |\r\n| db          | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count  | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| errors      | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| error_pct   | decimal(27,4)       | NO   |     | 0.0000              |       |\r\n| warnings    | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warning_pct | decimal(27,4)       | NO   |     | 0.0000              |       |\r\n| first_seen  | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen   | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest      | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n10 rows in set (0.55 sec)\r\n\r\nmysql> desc x$statements_with_errors_or_warnings;\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n| Field       | Type                | Null | Key | Default             | Extra |\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n| query       | longtext            | YES  |     | NULL                |       |\r\n| db          | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count  | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| errors      | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| error_pct   | decimal(27,4)       | NO   |     | 0.0000              |       |\r\n| warnings    | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warning_pct | decimal(27,4)       | NO   |     | 0.0000              |       |\r\n| first_seen  | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen   | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest      | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------+---------------------+------+-----+---------------------+-------+\r\n10 rows in set (0.25 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statements_with_errors_or_warnings LIMIT 1\\G\r\n*************************** 1. row ***************************\r\n      query: CREATE OR REPLACE ALGORITHM =  ... _delete` AS `rows_deleted` ...\r\n         db: sys\r\n exec_count: 2\r\n     errors: 1\r\n  error_pct: 50.0000\r\n   warnings: 0\r\nwarning_pct: 0.0000\r\n first_seen: 2014-03-07 12:56:54\r\n  last_seen: 2014-03-07 13:01:01\r\n     digest: 943a788859e623d5f7798ba0ae0fd8a9\r\n```\r\n\r\n#### statements_with_full_table_scans / x$statements_with_full_table_scans\r\n\r\n##### Description\r\n\r\nLists all normalized statements that use have done a full table scan ordered by number the percentage of times a full scan was done, then by the statement latency.\r\n\r\nThis view ignores SHOW statements, as these always cause a full table scan, and there is nothing that can be done about this.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statements_with_full_table_scans;\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n| Field                    | Type                   | Null | Key | Default             | Extra |\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n| query                    | longtext               | YES  |     | NULL                |       |\r\n| db                       | varchar(64)            | YES  |     | NULL                |       |\r\n| exec_count               | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| total_latency            | text                   | YES  |     | NULL                |       |\r\n| no_index_used_count      | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| no_good_index_used_count | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| no_index_used_pct        | decimal(24,0)          | NO   |     | 0                   |       |\r\n| rows_sent                | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| rows_examined            | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| rows_sent_avg            | decimal(21,0) unsigned | YES  |     | NULL                |       |\r\n| rows_examined_avg        | decimal(21,0) unsigned | YES  |     | NULL                |       |\r\n| first_seen               | timestamp              | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen                | timestamp              | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest                   | varchar(32)            | YES  |     | NULL                |       |\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n14 rows in set (0.04 sec)\r\n\r\nmysql> desc x$statements_with_full_table_scans;\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n| Field                    | Type                   | Null | Key | Default             | Extra |\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n| query                    | longtext               | YES  |     | NULL                |       |\r\n| db                       | varchar(64)            | YES  |     | NULL                |       |\r\n| exec_count               | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| total_latency            | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| no_index_used_count      | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| no_good_index_used_count | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| no_index_used_pct        | decimal(24,0)          | NO   |     | 0                   |       |\r\n| rows_sent                | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| rows_examined            | bigint(20) unsigned    | NO   |     | NULL                |       |\r\n| rows_sent_avg            | decimal(21,0) unsigned | YES  |     | NULL                |       |\r\n| rows_examined_avg        | decimal(21,0) unsigned | YES  |     | NULL                |       |\r\n| first_seen               | timestamp              | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen                | timestamp              | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest                   | varchar(32)            | YES  |     | NULL                |       |\r\n+--------------------------+------------------------+------+-----+---------------------+-------+\r\n14 rows in set (0.14 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statements_with_full_table_scans limit 1\\G\r\n*************************** 1. row ***************************\r\n                   query: SELECT * FROM `schema_tables_w ... ex_usage` . `COUNT_READ` DESC\r\n                      db: sys\r\n              exec_count: 1\r\n           total_latency: 88.20 ms\r\n     no_index_used_count: 1\r\nno_good_index_used_count: 0\r\n       no_index_used_pct: 100\r\n               rows_sent: 0\r\n           rows_examined: 1501\r\n           rows_sent_avg: 0\r\n       rows_examined_avg: 1501\r\n              first_seen: 2014-03-07 13:58:20\r\n               last_seen: 2014-03-07 13:58:20\r\n                  digest: 64baecd5c1e1e1651a6b92e55442a288\r\n```\r\n\r\n#### statements_with_runtimes_in_95th_percentile / x$statements_with_runtimes_in_95th_percentile\r\n\r\n##### Description\r\n\r\nLists all statements whose average runtime, in microseconds, is in the top 95th percentile.\r\n\r\nAlso includes two helper views:\r\n\r\n* x$ps_digest_avg_latency_distribution\r\n* x$ps_digest_95th_percentile_by_avg_us\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statements_with_runtimes_in_95th_percentile;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| full_scan         | varchar(1)          | NO   |     |                     |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| err_count         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warn_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | text                | YES  |     | NULL                |       |\r\n| max_latency       | text                | YES  |     | NULL                |       |\r\n| avg_latency       | text                | YES  |     | NULL                |       |\r\n| rows_sent         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent_avg     | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_examined     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_examined_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n16 rows in set (0.11 sec)\r\n\r\nmysql> desc x$statements_with_runtimes_in_95th_percentile;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| full_scan         | varchar(1)          | NO   |     |                     |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| err_count         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| warn_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| max_latency       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_latency       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent         | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sent_avg     | decimal(21,0)       | NO   |     | 0                   |       |\r\n| rows_examined     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_examined_avg | decimal(21,0)       | NO   |     | 0                   |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n16 rows in set (0.00 sec)\r\n\r\nmysql> desc x$ps_digest_avg_latency_distribution;\r\n+--------+---------------+------+-----+---------+-------+\r\n| Field  | Type          | Null | Key | Default | Extra |\r\n+--------+---------------+------+-----+---------+-------+\r\n| cnt    | bigint(21)    | NO   |     | 0       |       |\r\n| avg_us | decimal(21,0) | YES  |     | NULL    |       |\r\n+--------+---------------+------+-----+---------+-------+\r\n2 rows in set (0.10 sec)\r\n\r\nmysql> desc x$ps_digest_95th_percentile_by_avg_us;\r\n+------------+---------------+------+-----+---------+-------+\r\n| Field      | Type          | Null | Key | Default | Extra |\r\n+------------+---------------+------+-----+---------+-------+\r\n| avg_us     | decimal(21,0) | YES  |     | NULL    |       |\r\n| percentile | decimal(46,4) | NO   |     | 0.0000  |       |\r\n+------------+---------------+------+-----+---------+-------+\r\n2 rows in set (0.15 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statements_with_runtimes_in_95th_percentile\\G\r\n*************************** 1. row ***************************\r\n            query: SELECT * FROM `schema_object_o ... MA` , `information_schema` ...\r\n               db: sys\r\n        full_scan: *\r\n       exec_count: 2\r\n        err_count: 0\r\n       warn_count: 0\r\n    total_latency: 16.75 s\r\n      max_latency: 16.57 s\r\n      avg_latency: 8.38 s\r\n        rows_sent: 84\r\n    rows_sent_avg: 42\r\n    rows_examined: 20012\r\nrows_examined_avg: 10006\r\n       first_seen: 2014-03-07 13:13:41\r\n        last_seen: 2014-03-07 13:13:48\r\n           digest: 54f9bd520f0bbf15db0c2ed93386bec9\r\n```\r\n\r\n#### statements_with_sorting / x$statements_with_sorting\r\n\r\n##### Description\r\n\r\nLists all normalized statements that have done sorts, ordered by total_latency descending.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statements_with_sorting;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | text                | YES  |     | NULL                |       |\r\n| sort_merge_passes | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_sort_merges   | decimal(21,0)       | NO   |     | 0                   |       |\r\n| sorts_using_scans | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| sort_using_range  | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sorted       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_rows_sorted   | decimal(21,0)       | NO   |     | 0                   |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n13 rows in set (0.01 sec)\r\n\r\nmysql> desc x$statements_with_sorting;\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| Field             | Type                | Null | Key | Default             | Extra |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n| query             | longtext            | YES  |     | NULL                |       |\r\n| db                | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency     | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| sort_merge_passes | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_sort_merges   | decimal(21,0)       | NO   |     | 0                   |       |\r\n| sorts_using_scans | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| sort_using_range  | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| rows_sorted       | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_rows_sorted   | decimal(21,0)       | NO   |     | 0                   |       |\r\n| first_seen        | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen         | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest            | varchar(32)         | YES  |     | NULL                |       |\r\n+-------------------+---------------------+------+-----+---------------------+-------+\r\n13 rows in set (0.04 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statements_with_sorting limit 1\\G\r\n*************************** 1. row ***************************\r\n            query: SELECT * FROM `schema_object_o ... MA` , `information_schema` ...\r\n               db: sys\r\n       exec_count: 2\r\n    total_latency: 16.75 s\r\nsort_merge_passes: 0\r\n  avg_sort_merges: 0\r\nsorts_using_scans: 12\r\n sort_using_range: 0\r\n      rows_sorted: 168\r\n  avg_rows_sorted: 84\r\n       first_seen: 2014-03-07 13:13:41\r\n        last_seen: 2014-03-07 13:13:48\r\n           digest: 54f9bd520f0bbf15db0c2ed93386bec9\r\n```\r\n\r\n#### statements_with_temp_tables / x$statements_with_temp_tables\r\n\r\n##### Description\r\n\r\nLists all normalized statements that use temporary tables ordered by number of on disk temporary tables descending first, then by the number of memory tables.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc statements_with_temp_tables;\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n| Field                    | Type                | Null | Key | Default             | Extra |\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n| query                    | longtext            | YES  |     | NULL                |       |\r\n| db                       | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count               | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency            | text                | YES  |     | NULL                |       |\r\n| memory_tmp_tables        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| disk_tmp_tables          | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_tmp_tables_per_query | decimal(21,0)       | NO   |     | 0                   |       |\r\n| tmp_tables_to_disk_pct   | decimal(24,0)       | NO   |     | 0                   |       |\r\n| first_seen               | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen                | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest                   | varchar(32)         | YES  |     | NULL                |       |\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n11 rows in set (0.30 sec)\r\n\r\nmysql> desc x$statements_with_temp_tables;\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n| Field                    | Type                | Null | Key | Default             | Extra |\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n| query                    | longtext            | YES  |     | NULL                |       |\r\n| db                       | varchar(64)         | YES  |     | NULL                |       |\r\n| exec_count               | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| total_latency            | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| memory_tmp_tables        | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| disk_tmp_tables          | bigint(20) unsigned | NO   |     | NULL                |       |\r\n| avg_tmp_tables_per_query | decimal(21,0)       | NO   |     | 0                   |       |\r\n| tmp_tables_to_disk_pct   | decimal(24,0)       | NO   |     | 0                   |       |\r\n| first_seen               | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| last_seen                | timestamp           | NO   |     | 0000-00-00 00:00:00 |       |\r\n| digest                   | varchar(32)         | YES  |     | NULL                |       |\r\n+--------------------------+---------------------+------+-----+---------------------+-------+\r\n11 rows in set (0.05 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from statements_with_temp_tables limit 1\\G\r\n*************************** 1. row ***************************\r\n                   query: SELECT * FROM `schema_object_o ... MA` , `information_schema` ...\r\n                      db: sys\r\n              exec_count: 2\r\n           total_latency: 16.75 s\r\n       memory_tmp_tables: 378\r\n         disk_tmp_tables: 66\r\navg_tmp_tables_per_query: 189\r\n  tmp_tables_to_disk_pct: 17\r\n              first_seen: 2014-03-07 13:13:41\r\n               last_seen: 2014-03-07 13:13:48\r\n                  digest: 54f9bd520f0bbf15db0c2ed93386bec9\r\n```\r\n\r\n#### user_summary / x$user_summary\r\n\r\n##### Description\r\n\r\nSummarizes statement activity, file IO and connections by user.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures (5.7)\r\n\r\n```SQL\r\nmysql> desc user_summary;\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| Field                  | Type          | Null | Key | Default | Extra |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| user                   | varchar(32)   | YES  |     | NULL    |       |\r\n| statements             | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_latency      | text          | YES  |     | NULL    |       |\r\n| statement_avg_latency  | text          | YES  |     | NULL    |       |\r\n| table_scans            | decimal(65,0) | YES  |     | NULL    |       |\r\n| file_ios               | decimal(64,0) | YES  |     | NULL    |       |\r\n| file_io_latency        | text          | YES  |     | NULL    |       |\r\n| current_connections    | decimal(41,0) | YES  |     | NULL    |       |\r\n| total_connections      | decimal(41,0) | YES  |     | NULL    |       |\r\n| unique_hosts           | bigint(21)    | NO   |     | 0       |       |\r\n| current_memory         | text          | YES  |     | NULL    |       |\r\n| total_memory_allocated | text          | YES  |     | NULL    |       |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n12 rows in set (0.00 sec)\r\n\r\nmysql> desc x$user_summary;\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| Field                  | Type          | Null | Key | Default | Extra |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n| user                   | varchar(32)   | YES  |     | NULL    |       |\r\n| statements             | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_latency      | decimal(64,0) | YES  |     | NULL    |       |\r\n| statement_avg_latency  | decimal(65,4) | NO   |     | 0.0000  |       |\r\n| table_scans            | decimal(65,0) | YES  |     | NULL    |       |\r\n| file_ios               | decimal(64,0) | YES  |     | NULL    |       |\r\n| file_io_latency        | decimal(64,0) | YES  |     | NULL    |       |\r\n| current_connections    | decimal(41,0) | YES  |     | NULL    |       |\r\n| total_connections      | decimal(41,0) | YES  |     | NULL    |       |\r\n| unique_hosts           | bigint(21)    | NO   |     | 0       |       |\r\n| current_memory         | decimal(63,0) | YES  |     | NULL    |       |\r\n| total_memory_allocated | decimal(64,0) | YES  |     | NULL    |       |\r\n+------------------------+---------------+------+-----+---------+-------+\r\n12 rows in set (0.01 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary\\G\r\n*************************** 1. row ***************************\r\n                  user: root\r\n            statements: 4981\r\n     statement_latency: 26.54 s\r\n statement_avg_latency: 5.33 ms\r\n           table_scans: 74\r\n              file_ios: 7792\r\n       file_io_latency: 40.08 s\r\n   current_connections: 1\r\n     total_connections: 2\r\n          unique_hosts: 1\r\n        current_memory: 3.57 MiB\r\ntotal_memory_allocated: 83.37 MiB\r\n*************************** 2. row ***************************\r\n                  user: background\r\n            statements: 0\r\n     statement_latency: 0 ps\r\n statement_avg_latency: 0 ps\r\n           table_scans: 0\r\n              file_ios: 1618\r\n       file_io_latency: 4.78 s\r\n   current_connections: 21\r\n     total_connections: 23\r\n          unique_hosts: 0\r\n        current_memory: 165.94 MiB\r\ntotal_memory_allocated: 197.29 MiB\r\n```\r\n\r\n#### user_summary_by_file_io / x$user_summary_by_file_io\r\n\r\n##### Description\r\n\r\nSummarizes file IO totals per user.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc user_summary_by_file_io;\r\n+------------+---------------+------+-----+---------+-------+\r\n| Field      | Type          | Null | Key | Default | Extra |\r\n+------------+---------------+------+-----+---------+-------+\r\n| user       | varchar(32)   | YES  |     | NULL    |       |\r\n| ios        | decimal(42,0) | YES  |     | NULL    |       |\r\n| io_latency | text          | YES  |     | NULL    |       |\r\n+------------+---------------+------+-----+---------+-------+\r\n3 rows in set (0.20 sec)\r\n\r\nmysql> desc x$user_summary_by_file_io;\r\n+------------+---------------+------+-----+---------+-------+\r\n| Field      | Type          | Null | Key | Default | Extra |\r\n+------------+---------------+------+-----+---------+-------+\r\n| user       | varchar(32)   | YES  |     | NULL    |       |\r\n| ios        | decimal(42,0) | YES  |     | NULL    |       |\r\n| io_latency | decimal(42,0) | YES  |     | NULL    |       |\r\n+------------+---------------+------+-----+---------+-------+\r\n3 rows in set (0.02 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary_by_file_io;\r\n+------------+-------+------------+\r\n| user       | ios   | io_latency |\r\n+------------+-------+------------+\r\n| root       | 26457 | 21.58 s    |\r\n| background |  1189 | 394.21 ms  |\r\n+------------+-------+------------+\r\n```\r\n\r\n#### user_summary_by_file_io_type / x$user_summary_by_file_io_type\r\n\r\n##### Description\r\n\r\nSummarizes file IO by event type per user.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc user_summary_by_file_io_type;\r\n+-------------+---------------------+------+-----+---------+-------+\r\n| Field       | Type                | Null | Key | Default | Extra |\r\n+-------------+---------------------+------+-----+---------+-------+\r\n| user        | varchar(32)         | YES  |     | NULL    |       |\r\n| event_name  | varchar(128)        | NO   |     | NULL    |       |\r\n| total       | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| latency     | text                | YES  |     | NULL    |       |\r\n| max_latency | text                | YES  |     | NULL    |       |\r\n+-------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.02 sec)\r\n\r\nmysql> desc x$user_summary_by_file_io_type;\r\n+-------------+---------------------+------+-----+---------+-------+\r\n| Field       | Type                | Null | Key | Default | Extra |\r\n+-------------+---------------------+------+-----+---------+-------+\r\n| user        | varchar(32)         | YES  |     | NULL    |       |\r\n| event_name  | varchar(128)        | NO   |     | NULL    |       |\r\n| total       | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| latency     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+-------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.00 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary_by_file_io_type;\r\n+------------+--------------------------------------+-------+-----------+-------------+\r\n| user       | event_name                           | total | latency   | max_latency |\r\n+------------+--------------------------------------+-------+-----------+-------------+\r\n| background | wait/io/file/innodb/innodb_data_file |  1434 | 3.29 s    | 147.56 ms   |\r\n| background | wait/io/file/sql/FRM                 |   910 | 286.61 ms | 32.92 ms    |\r\n| background | wait/io/file/sql/relaylog            |     9 | 252.28 ms | 144.17 ms   |\r\n| background | wait/io/file/sql/binlog              |    56 | 193.73 ms | 153.72 ms   |\r\n| background | wait/io/file/sql/binlog_index        |    22 | 183.02 ms | 81.83 ms    |\r\n| background | wait/io/file/innodb/innodb_log_file  |    20 | 117.17 ms | 36.53 ms    |\r\n| background | wait/io/file/sql/relaylog_index      |     9 | 50.15 ms  | 48.04 ms    |\r\n| background | wait/io/file/sql/ERRMSG              |     5 | 35.41 ms  | 31.78 ms    |\r\n| background | wait/io/file/myisam/kfile            |    67 | 18.14 ms  | 9.00 ms     |\r\n| background | wait/io/file/mysys/charset           |     3 | 7.46 ms   | 4.13 ms     |\r\n| background | wait/io/file/sql/casetest            |     5 | 6.01 ms   | 5.86 ms     |\r\n| background | wait/io/file/sql/pid                 |     3 | 5.96 ms   | 3.06 ms     |\r\n| background | wait/io/file/myisam/dfile            |    43 | 980.38 us | 152.46 us   |\r\n| background | wait/io/file/mysys/cnf               |     5 | 154.97 us | 58.87 us    |\r\n| background | wait/io/file/sql/global_ddl_log      |     2 | 18.64 us  | 16.40 us    |\r\n| root       | wait/io/file/sql/file_parser         | 11048 | 48.79 s   | 201.11 ms   |\r\n| root       | wait/io/file/innodb/innodb_data_file |  4699 | 3.02 s    | 46.93 ms    |\r\n| root       | wait/io/file/sql/FRM                 | 10403 | 2.38 s    | 61.72 ms    |\r\n| root       | wait/io/file/myisam/dfile            | 22143 | 726.77 ms | 308.79 ms   |\r\n| root       | wait/io/file/myisam/kfile            |  6213 | 435.35 ms | 88.76 ms    |\r\n| root       | wait/io/file/sql/dbopt               |   159 | 130.86 ms | 15.46 ms    |\r\n| root       | wait/io/file/csv/metadata            |     8 | 86.60 ms  | 50.32 ms    |\r\n| root       | wait/io/file/sql/binlog              |    15 | 38.79 ms  | 9.40 ms     |\r\n| root       | wait/io/file/sql/misc                |    21 | 22.33 ms  | 15.30 ms    |\r\n| root       | wait/io/file/csv/data                |     4 | 297.46 us | 111.93 us   |\r\n| root       | wait/io/file/archive/data            |     3 | 54.10 us  | 40.74 us    |\r\n+------------+--------------------------------------+-------+-----------+-------------+\r\n```\r\n\r\n#### user_summary_by_stages / x$user_summary_by_stages\r\n\r\n##### Description\r\n\r\nSummarizes stages by user, ordered by user and total latency per stage.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc user_summary_by_stages;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(32)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.01 sec)\r\n\r\nmysql> desc x$user_summary_by_stages;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(16)         | YES  |     | NULL    |       |\r\n| event_name    | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.05 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary_by_stages;\r\n+------+--------------------------------+-------+---------------+-------------+\r\n| user | event_name                     | total | total_latency | avg_latency |\r\n+------+--------------------------------+-------+---------------+-------------+\r\n| root | stage/sql/Opening tables       |   889 | 1.97 ms       | 2.22 us     |\r\n| root | stage/sql/Creating sort index  |     4 | 1.79 ms       | 446.30 us   |\r\n| root | stage/sql/init                 |    10 | 312.27 us     | 31.23 us    |\r\n| root | stage/sql/checking permissions |    10 | 300.62 us     | 30.06 us    |\r\n| root | stage/sql/freeing items        |     5 | 85.89 us      | 17.18 us    |\r\n| root | stage/sql/statistics           |     5 | 79.15 us      | 15.83 us    |\r\n| root | stage/sql/preparing            |     5 | 69.12 us      | 13.82 us    |\r\n| root | stage/sql/optimizing           |     5 | 53.11 us      | 10.62 us    |\r\n| root | stage/sql/Sending data         |     5 | 44.66 us      | 8.93 us     |\r\n| root | stage/sql/closing tables       |     5 | 37.54 us      | 7.51 us     |\r\n| root | stage/sql/System lock          |     5 | 34.28 us      | 6.86 us     |\r\n| root | stage/sql/query end            |     5 | 24.37 us      | 4.87 us     |\r\n| root | stage/sql/end                  |     5 | 8.60 us       | 1.72 us     |\r\n| root | stage/sql/Sorting result       |     5 | 8.33 us       | 1.67 us     |\r\n| root | stage/sql/executing            |     5 | 5.37 us       | 1.07 us     |\r\n| root | stage/sql/cleaning up          |     5 | 4.60 us       | 919.00 ns   |\r\n+------+--------------------------------+-------+---------------+-------------+\r\n```\r\n\r\n#### user_summary_by_statement_latency / x$user_summary_by_statement_latency\r\n\r\n##### Description\r\n\r\nSummarizes overall statement statistics by user.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc user_summary_by_statement_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| user          | varchar(32)   | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | text          | YES  |     | NULL    |       |\r\n| max_latency   | text          | YES  |     | NULL    |       |\r\n| lock_latency  | text          | YES  |     | NULL    |       |\r\n| rows_sent     | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_examined | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_affected | decimal(42,0) | YES  |     | NULL    |       |\r\n| full_scans    | decimal(43,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n9 rows in set (0.00 sec)\r\n\r\nmysql> desc x$user_summary_by_statement_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| user          | varchar(32)   | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | decimal(42,0) | YES  |     | NULL    |       |\r\n| max_latency   | decimal(42,0) | YES  |     | NULL    |       |\r\n| lock_latency  | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_sent     | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_examined | decimal(42,0) | YES  |     | NULL    |       |\r\n| rows_affected | decimal(42,0) | YES  |     | NULL    |       |\r\n| full_scans    | decimal(43,0) | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n9 rows in set (0.28 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary_by_statement_latency;\r\n+------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n| user | total | total_latency | max_latency | lock_latency | rows_sent | rows_examined | rows_affected | full_scans |\r\n+------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n| root |  3381 | 00:02:09.13   | 1.48 s      | 1.07 s       |      1151 |         93947 |           150 |         91 |\r\n+------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n```\r\n\r\n#### user_summary_by_statement_type / x$user_summary_by_statement_type\r\n\r\n##### Description\r\n\r\nSummarizes the types of statements executed by each user.\r\n\r\nWhen the user found is NULL, it is assumed to be a \"background\" thread.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc user_summary_by_statement_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(32)         | YES  |     | NULL    |       |\r\n| statement     | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n| lock_latency  | text                | YES  |     | NULL    |       |\r\n| rows_sent     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_examined | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_affected | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| full_scans    | bigint(21) unsigned | NO   |     | 0       |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n10 rows in set (0.21 sec)\r\n\r\nmysql> desc x$user_summary_by_statement_type;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(32)         | YES  |     | NULL    |       |\r\n| statement     | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| lock_latency  | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_sent     | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_examined | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| rows_affected | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| full_scans    | bigint(21) unsigned | NO   |     | 0       |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n10 rows in set (0.37 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from user_summary_by_statement_type;\r\n+------+------------------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n| user | statement        | total | total_latency | max_latency | lock_latency | rows_sent | rows_examined | rows_affected | full_scans |\r\n+------+------------------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n| root | create_view      |  1332 | 00:03:39.08   | 677.76 ms   | 494.56 ms    |         0 |             0 |             0 |          0 |\r\n| root | select           |    88 | 20.13 s       | 16.57 s     | 17.40 s      |      1804 |         77285 |             0 |         48 |\r\n| root | drop_db          |    16 | 6.83 s        | 1.14 s      | 5.73 s       |         0 |             0 |           953 |          0 |\r\n| root | drop_view        |   392 | 1.70 s        | 739.49 ms   | 0 ps         |         0 |             0 |             0 |          0 |\r\n| root | show_databases   |    16 | 1.37 s        | 587.44 ms   | 1.31 ms      |       400 |           400 |             0 |         16 |\r\n| root | show_tables      |    34 | 676.78 ms     | 167.04 ms   | 3.46 ms      |      1087 |          1087 |             0 |         34 |\r\n| root | create_db        |    22 | 334.90 ms     | 38.93 ms    | 0 ps         |         0 |             0 |            22 |          0 |\r\n| root | create_procedure |   352 | 250.02 ms     | 21.90 ms    | 165.17 ms    |         0 |             0 |             0 |          0 |\r\n| root | drop_function    |   176 | 122.44 ms     | 69.18 ms    | 87.24 ms     |         0 |             0 |             0 |          0 |\r\n| root | create_function  |   176 | 76.12 ms      | 1.36 ms     | 49.50 ms     |         0 |             0 |             0 |          0 |\r\n| root | drop_procedure   |   352 | 67.41 ms      | 1.57 ms     | 36.22 ms     |         0 |             0 |             0 |          0 |\r\n| root | update           |     2 | 41.75 ms      | 35.96 ms    | 35.52 ms     |         0 |           557 |           338 |          0 |\r\n| root | error            |     3 | 17.22 ms      | 17.05 ms    | 0 ps         |         0 |             0 |             0 |          0 |\r\n| root | set_option       |    88 | 8.02 ms       | 1.63 ms     | 0 ps         |         0 |             0 |             0 |          0 |\r\n| root | call_procedure   |     2 | 2.98 ms       | 2.29 ms     | 95.00 us     |         0 |             0 |             0 |          0 |\r\n| root | Init DB          |    22 | 1.07 ms       | 117.65 us   | 0 ps         |         0 |             0 |             0 |          0 |\r\n| root | show_status      |     1 | 408.69 us     | 408.69 us   | 102.00 us    |        23 |            23 |             0 |          1 |\r\n+------+------------------+-------+---------------+-------------+--------------+-----------+---------------+---------------+------------+\r\n```\r\n\r\n#### wait_classes_global_by_avg_latency / x$wait_classes_global_by_avg_latency\r\n\r\n##### Description\r\n\r\nLists the top wait classes by average latency, ignoring idle (this may be very large).\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc wait_classes_global_by_avg_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| event_class   | varchar(128)  | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | text          | YES  |     | NULL    |       |\r\n| min_latency   | text          | YES  |     | NULL    |       |\r\n| avg_latency   | text          | YES  |     | NULL    |       |\r\n| max_latency   | text          | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.11 sec)\r\n\r\nmysql> desc x$wait_classes_global_by_avg_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| event_class   | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | decimal(42,0)       | YES  |     | NULL    |       |\r\n| total_latency | decimal(42,0)       | YES  |     | NULL    |       |\r\n| min_latency   | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| avg_latency   | decimal(46,4)       | NO   |     | 0.0000  |       |\r\n| max_latency   | bigint(20) unsigned | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.02 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from wait_classes_global_by_avg_latency where event_class != 'idle';\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n| event_class       | total  | total_latency | min_latency | avg_latency | max_latency |\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n| wait/io/file      | 543123 | 44.60 s       | 19.44 ns    | 82.11 us    | 4.21 s      |\r\n| wait/io/table     |  22002 | 766.60 ms     | 148.72 ns   | 34.84 us    | 44.97 ms    |\r\n| wait/io/socket    |  79613 | 967.17 ms     | 0 ps        | 12.15 us    | 27.10 ms    |\r\n| wait/lock/table   |  35409 | 18.68 ms      | 65.45 ns    | 527.51 ns   | 969.88 us   |\r\n| wait/synch/rwlock |  37935 | 4.61 ms       | 21.38 ns    | 121.61 ns   | 34.65 us    |\r\n| wait/synch/mutex  | 390622 | 18.60 ms      | 19.44 ns    | 47.61 ns    | 10.32 us    |\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n```\r\n\r\n#### wait_classes_global_by_latency / x$wait_classes_global_by_latency\r\n\r\n##### Description\r\n\r\nLists the top wait classes by total latency, ignoring idle (this may be very large).\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc wait_classes_global_by_latency;\r\n+---------------+---------------+------+-----+---------+-------+\r\n| Field         | Type          | Null | Key | Default | Extra |\r\n+---------------+---------------+------+-----+---------+-------+\r\n| event_class   | varchar(128)  | YES  |     | NULL    |       |\r\n| total         | decimal(42,0) | YES  |     | NULL    |       |\r\n| total_latency | text          | YES  |     | NULL    |       |\r\n| min_latency   | text          | YES  |     | NULL    |       |\r\n| avg_latency   | text          | YES  |     | NULL    |       |\r\n| max_latency   | text          | YES  |     | NULL    |       |\r\n+---------------+---------------+------+-----+---------+-------+\r\n6 rows in set (0.00 sec)\r\n\r\nmysql> desc x$wait_classes_global_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| event_class   | varchar(128)        | YES  |     | NULL    |       |\r\n| total         | decimal(42,0)       | YES  |     | NULL    |       |\r\n| total_latency | decimal(42,0)       | YES  |     | NULL    |       |\r\n| min_latency   | bigint(20) unsigned | YES  |     | NULL    |       |\r\n| avg_latency   | decimal(46,4)       | NO   |     | 0.0000  |       |\r\n| max_latency   | bigint(20) unsigned | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.02 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from wait_classes_global_by_latency;\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n| event_class       | total  | total_latency | min_latency | avg_latency | max_latency |\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n| wait/io/file      | 550470 | 46.01 s       | 19.44 ns    | 83.58 us    | 4.21 s      |\r\n| wait/io/socket    | 228833 | 2.71 s        | 0 ps        | 11.86 us    | 29.93 ms    |\r\n| wait/io/table     |  64063 | 1.89 s        | 99.79 ns    | 29.43 us    | 68.07 ms    |\r\n| wait/lock/table   |  76029 | 47.19 ms      | 65.45 ns    | 620.74 ns   | 969.88 us   |\r\n| wait/synch/mutex  | 635925 | 34.93 ms      | 19.44 ns    | 54.93 ns    | 107.70 us   |\r\n| wait/synch/rwlock |  61287 | 7.62 ms       | 21.38 ns    | 124.37 ns   | 34.65 us    |\r\n+-------------------+--------+---------------+-------------+-------------+-------------+\r\n```\r\n\r\n#### waits_by_user_by_latency / x$waits_by_user_by_latency\r\n\r\n##### Description\r\n\r\nLists the top wait events per user by their total latency, ignoring idle (this may be very large) per user.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc waits_by_user_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(32)         | YES  |     | NULL    |       |\r\n| event         | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.00 sec)\r\n\r\nmysql> desc x$waits_by_user_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| user          | varchar(32)         | YES  |     | NULL    |       |\r\n| event         | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.30 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from waits_by_user_by_latency;\r\n+------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n| user | event                                               | total  | total_latency | avg_latency | max_latency |\r\n+------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n| root | wait/io/file/sql/file_parser                        |  13743 | 00:01:00.46   | 4.40 ms     | 231.88 ms   |\r\n| root | wait/io/file/innodb/innodb_data_file                |   4699 | 3.02 s        | 643.38 us   | 46.93 ms    |\r\n| root | wait/io/file/sql/FRM                                |  11462 | 2.60 s        | 226.83 us   | 61.72 ms    |\r\n| root | wait/io/file/myisam/dfile                           |  26776 | 746.70 ms     | 27.89 us    | 308.79 ms   |\r\n| root | wait/io/file/myisam/kfile                           |   7126 | 462.66 ms     | 64.93 us    | 88.76 ms    |\r\n| root | wait/io/file/sql/dbopt                              |    179 | 137.58 ms     | 768.59 us   | 15.46 ms    |\r\n| root | wait/io/file/csv/metadata                           |      8 | 86.60 ms      | 10.82 ms    | 50.32 ms    |\r\n| root | wait/synch/mutex/mysys/IO_CACHE::append_buffer_lock | 798080 | 66.46 ms      | 82.94 ns    | 161.03 us   |\r\n| root | wait/io/file/sql/binlog                             |     19 | 49.11 ms      | 2.58 ms     | 9.40 ms     |\r\n| root | wait/io/file/sql/misc                               |     26 | 22.38 ms      | 860.80 us   | 15.30 ms    |\r\n| root | wait/io/file/csv/data                               |      4 | 297.46 us     | 74.37 us    | 111.93 us   |\r\n| root | wait/synch/rwlock/sql/MDL_lock::rwlock              |    944 | 287.86 us     | 304.62 ns   | 874.64 ns   |\r\n| root | wait/io/file/archive/data                           |      4 | 82.71 us      | 20.68 us    | 40.74 us    |\r\n| root | wait/synch/mutex/myisam/MYISAM_SHARE::intern_lock   |     60 | 12.21 us      | 203.20 ns   | 512.72 ns   |\r\n| root | wait/synch/mutex/innodb/trx_mutex                   |     81 | 5.93 us       | 73.14 ns    | 252.59 ns   |\r\n+------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n```\r\n\r\n#### waits_by_host_by_latency / x$waits_by_host_by_latency\r\n\r\n##### Description\r\n\r\nLists the top wait events per host by their total latency, ignoring idle (this may be very large) per host.\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc waits_by_host_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event         | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.36 sec)\r\n\r\nmysql> desc x$waits_by_host_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| host          | varchar(60)         | YES  |     | NULL    |       |\r\n| event         | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n6 rows in set (0.25 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\n mysql> select * from waits_by_host_by_latency;\r\n  +------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n  | host | event                                               | total  | total_latency | avg_latency | max_latency |\r\n  +------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n  | hal1 | wait/io/file/sql/file_parser                        |  13743 | 00:01:00.46   | 4.40 ms     | 231.88 ms   |\r\n  | hal1 | wait/io/file/innodb/innodb_data_file                |   4699 | 3.02 s        | 643.38 us   | 46.93 ms    |\r\n  | hal1 | wait/io/file/sql/FRM                                |  11462 | 2.60 s        | 226.83 us   | 61.72 ms    |\r\n  | hal1 | wait/io/file/myisam/dfile                           |  26776 | 746.70 ms     | 27.89 us    | 308.79 ms   |\r\n  | hal1 | wait/io/file/myisam/kfile                           |   7126 | 462.66 ms     | 64.93 us    | 88.76 ms    |\r\n  | hal1 | wait/io/file/sql/dbopt                              |    179 | 137.58 ms     | 768.59 us   | 15.46 ms    |\r\n  | hal1 | wait/io/file/csv/metadata                           |      8 | 86.60 ms      | 10.82 ms    | 50.32 ms    |\r\n  | hal1 | wait/synch/mutex/mysys/IO_CACHE::append_buffer_lock | 798080 | 66.46 ms      | 82.94 ns    | 161.03 us   |\r\n  | hal1 | wait/io/file/sql/binlog                             |     19 | 49.11 ms      | 2.58 ms     | 9.40 ms     |\r\n  | hal1 | wait/io/file/sql/misc                               |     26 | 22.38 ms      | 860.80 us   | 15.30 ms    |\r\n  | hal1 | wait/io/file/csv/data                               |      4 | 297.46 us     | 74.37 us    | 111.93 us   |\r\n  | hal1 | wait/synch/rwlock/sql/MDL_lock::rwlock              |    944 | 287.86 us     | 304.62 ns   | 874.64 ns   |\r\n  | hal1 | wait/io/file/archive/data                           |      4 | 82.71 us      | 20.68 us    | 40.74 us    |\r\n  | hal1 | wait/synch/mutex/myisam/MYISAM_SHARE::intern_lock   |     60 | 12.21 us      | 203.20 ns   | 512.72 ns   |\r\n  | hal1 | wait/synch/mutex/innodb/trx_mutex                   |     81 | 5.93 us       | 73.14 ns    | 252.59 ns   |\r\n  +------+-----------------------------------------------------+--------+---------------+-------------+-------------+\r\n```\r\n\r\n#### waits_global_by_latency / x$waits_global_by_latency\r\n\r\n##### Description\r\n\r\nLists the top wait events by their total latency, ignoring idle (this may be very large).\r\n\r\n##### Structures\r\n\r\n```SQL\r\nmysql> desc waits_global_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| events        | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | text                | YES  |     | NULL    |       |\r\n| avg_latency   | text                | YES  |     | NULL    |       |\r\n| max_latency   | text                | YES  |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.01 sec)\r\n\r\nmysql> desc x$waits_global_by_latency;\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| Field         | Type                | Null | Key | Default | Extra |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n| events        | varchar(128)        | NO   |     | NULL    |       |\r\n| total         | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| total_latency | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| avg_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n| max_latency   | bigint(20) unsigned | NO   |     | NULL    |       |\r\n+---------------+---------------------+------+-----+---------+-------+\r\n5 rows in set (0.03 sec)\r\n```\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select * from waits_global_by_latency;\r\n+-----------------------------------------------------+---------+---------------+-------------+-------------+\r\n| events                                              | total   | total_latency | avg_latency | max_latency |\r\n+-----------------------------------------------------+---------+---------------+-------------+-------------+\r\n| wait/io/file/sql/file_parser                        | 14936   | 00:01:06.64   | 4.46 ms     | 231.88 ms   |\r\n| wait/io/file/innodb/innodb_data_file                |    6133 | 6.31 s        | 1.03 ms     | 147.56 ms   |\r\n| wait/io/file/sql/FRM                                |   12677 | 2.83 s        | 223.37 us   | 40.86 ms    |\r\n| wait/io/file/myisam/dfile                           |   28446 | 754.40 ms     | 26.52 us    | 308.79 ms   |\r\n| wait/io/file/myisam/kfile                           |    7572 | 491.17 ms     | 64.87 us    | 88.76 ms    |\r\n| wait/io/file/sql/relaylog                           |       9 | 252.28 ms     | 28.03 ms    | 144.17 ms   |\r\n| wait/io/file/sql/binlog                             |      76 | 242.87 ms     | 3.20 ms     | 153.72 ms   |\r\n| wait/io/file/sql/binlog_index                       |      21 | 173.07 ms     | 8.24 ms     | 81.83 ms    |\r\n| wait/io/file/sql/dbopt                              |     184 | 149.52 ms     | 812.62 us   | 15.46 ms    |\r\n| wait/io/file/innodb/innodb_log_file                 |      20 | 117.17 ms     | 5.86 ms     | 36.53 ms    |\r\n| wait/synch/mutex/mysys/IO_CACHE::append_buffer_lock | 1197128 | 99.27 ms      | 82.56 ns    | 161.03 us   |\r\n| wait/io/file/csv/metadata                           |       8 | 86.60 ms      | 10.82 ms    | 50.32 ms    |\r\n| wait/io/file/sql/relaylog_index                     |      10 | 60.10 ms      | 6.01 ms     | 48.04 ms    |\r\n| wait/io/file/sql/ERRMSG                             |       5 | 35.41 ms      | 7.08 ms     | 31.78 ms    |\r\n| wait/io/file/sql/misc                               |      28 | 22.40 ms      | 800.06 us   | 15.30 ms    |\r\n| wait/io/file/mysys/charset                          |       3 | 7.46 ms       | 2.49 ms     | 4.13 ms     |\r\n| wait/io/file/sql/casetest                           |       5 | 6.01 ms       | 1.20 ms     | 5.86 ms     |\r\n| wait/io/file/sql/pid                                |       3 | 5.96 ms       | 1.99 ms     | 3.06 ms     |\r\n| wait/synch/rwlock/sql/MDL_lock::rwlock              |    1396 | 420.58 us     | 301.22 ns   | 874.64 ns   |\r\n| wait/io/file/csv/data                               |       4 | 297.46 us     | 74.37 us    | 111.93 us   |\r\n| wait/io/file/mysys/cnf                              |       5 | 154.97 us     | 30.99 us    | 58.87 us    |\r\n| wait/io/file/archive/data                           |       4 | 82.71 us      | 20.68 us    | 40.74 us    |\r\n| wait/synch/mutex/myisam/MYISAM_SHARE::intern_lock   |      90 | 19.23 us      | 213.38 ns   | 576.81 ns   |\r\n| wait/io/file/sql/global_ddl_log                     |       2 | 18.64 us      | 9.32 us     | 16.40 us    |\r\n| wait/synch/mutex/innodb/trx_mutex                   |     108 | 8.23 us       | 76.15 ns    | 365.69 ns   |\r\n+-----------------------------------------------------+---------+---------------+-------------+-------------+\r\n```\r\n\r\n### Functions\r\n\r\n#### extract_schema_from_file_name\r\n\r\n##### Description\r\n\r\nTakes a raw file path, and attempts to extract the schema name from it.\r\n\r\nUseful for when interacting with Performance Schema data concerning IO statistics, for example.\r\n\r\nCurrently relies on the fact that a table data file will be within a specified database directory (will not work with partitions or tables that specify an individual DATA_DIRECTORY).\r\n\r\n##### Parameters\r\n\r\n* path (VARCHAR(512)): The full file path to a data file to extract the schema name from.\r\n\r\n##### Returns\r\n\r\nVARCHAR(64)\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.extract_schema_from_file_name('/var/lib/mysql/employees/employee.ibd');\r\n+----------------------------------------------------------------------------+\r\n| sys.extract_schema_from_file_name('/var/lib/mysql/employees/employee.ibd') |\r\n+----------------------------------------------------------------------------+\r\n| employees                                                                  |\r\n+----------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### extract_table_from_file_name\r\n\r\n##### Description\r\n\r\nTakes a raw file path, and extracts the table name from it.\r\n\r\nUseful for when interacting with Performance Schema data concerning IO statistics, for example.\r\n\r\n##### Parameters\r\n\r\n* path (VARCHAR(512)): The full file path to a data file to extract the table name from.\r\n\r\n##### Returns\r\n\r\nVARCHAR(64)\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.extract_table_from_file_name('/var/lib/mysql/employees/employee.ibd');\r\n+---------------------------------------------------------------------------+\r\n| sys.extract_table_from_file_name('/var/lib/mysql/employees/employee.ibd') |\r\n+---------------------------------------------------------------------------+\r\n| employee                                                                  |\r\n+---------------------------------------------------------------------------+\r\n1 row in set (0.02 sec)\r\n```         \r\n\r\n#### format_bytes\r\n\r\n##### Description\r\n\r\nTakes a raw bytes value, and converts it to a human readable format.\r\n\r\n##### Parameters\r\n\r\n* bytes (TEXT): A raw bytes value.\r\n\r\n##### Returns\r\n\r\nTEXT\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.format_bytes(2348723492723746) AS size;\r\n+----------+\r\n| size     |\r\n+----------+\r\n| 2.09 PiB |\r\n+----------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> SELECT sys.format_bytes(2348723492723) AS size;\r\n+----------+\r\n| size     |\r\n+----------+\r\n| 2.14 TiB |\r\n+----------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> SELECT sys.format_bytes(23487234) AS size;\r\n+-----------+\r\n| size      |\r\n+-----------+\r\n| 22.40 MiB |\r\n+-----------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### format_path\r\n\r\n##### Description\r\n\r\nTakes a raw path value, and strips out the datadir or tmpdir replacing with @@datadir and @@tmpdir respectively. \r\n\r\nAlso normalizes the paths across operating systems, so backslashes on Windows are converted to forward slashes.\r\n\r\n##### Parameters\r\n\r\n* path (VARCHAR(512)): The raw file path value to format.\r\n\r\n##### Returns\r\n\r\nVARCHAR(512) CHARSET UTF8\r\n\r\n##### Example\r\n```SQL\r\nmysql> select @@datadir;\r\n+-----------------------------------------------+\r\n| @@datadir                                     |\r\n+-----------------------------------------------+\r\n| /Users/mark/sandboxes/SmallTree/AMaster/data/ |\r\n+-----------------------------------------------+\r\n1 row in set (0.06 sec)\r\n\r\nmysql> select format_path('/Users/mark/sandboxes/SmallTree/AMaster/data/mysql/proc.MYD') AS path;\r\n+--------------------------+\r\n| path                     |\r\n+--------------------------+\r\n| @@datadir/mysql/proc.MYD |\r\n+--------------------------+\r\n1 row in set (0.03 sec)\r\n```\r\n\r\n#### format_statement\r\n\r\n##### Description\r\n\r\nFormats a normalized statement, truncating it if it is > 64 characters long by default.\r\n\r\nTo configure the length to truncate the statement to by default, update the `statement_truncate_len` variable with `sys_config` table to a different value. Alternatively, to change it just for just your particular session, use `SET @sys.statement_truncate_len := <some new value>`.\r\n\r\nUseful for printing statement related data from Performance Schema from the command line.\r\n\r\n##### Parameters\r\n\r\n* statement (LONGTEXT): The statement to format.\r\n\r\n##### Returns\r\n\r\nVARCHAR(65)\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.format_statement(digest_text)\r\n    ->   FROM performance_schema.events_statements_summary_by_digest\r\n    ->  ORDER by sum_timer_wait DESC limit 5;\r\n+-------------------------------------------------------------------+\r\n| sys.format_statement(digest_text)                                 |\r\n+-------------------------------------------------------------------+\r\n| CREATE SQL SECURITY INVOKER VI ... KE ? AND `variable_value` > ?  |\r\n| CREATE SQL SECURITY INVOKER VI ... ait` IS NOT NULL , `esc` . ... |\r\n| CREATE SQL SECURITY INVOKER VI ... ait` IS NOT NULL , `sys` . ... |\r\n| CREATE SQL SECURITY INVOKER VI ...  , `compressed_size` ) ) DESC  |\r\n| CREATE SQL SECURITY INVOKER VI ... LIKE ? ORDER BY `timer_start`  |\r\n+-------------------------------------------------------------------+\r\n5 rows in set (0.00 sec)\r\n```\r\n\r\n#### format_time\r\n\r\n##### Description\r\n\r\nTakes a raw picoseconds value, and converts it to a human readable form.\r\n             \r\nPicoseconds are the precision that all latency values are printed in within Performance Schema, however are not user friendly when wanting to scan output from the command line.\r\n\r\n##### Parameters\r\n\r\n* picoseconds (TEXT): The raw picoseconds value to convert.\r\n\r\n##### Returns\r\n\r\nTEXT\r\n\r\n##### Example\r\n```SQL\r\nmysql> select format_time(342342342342345);\r\n+------------------------------+\r\n| format_time(342342342342345) |\r\n+------------------------------+\r\n| 00:05:42                     |\r\n+------------------------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> select format_time(342342342);\r\n+------------------------+\r\n| format_time(342342342) |\r\n+------------------------+\r\n| 342.34 us              |\r\n+------------------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> select format_time(34234);\r\n +--------------------+\r\n| format_time(34234) |\r\n+--------------------+\r\n| 34.23 ns           |\r\n+--------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### list_add\r\n\r\n##### Description\r\n\r\nTakes a list, and a value to add to the list, and returns the resulting list.\r\n\r\nUseful for altering certain session variables, like sql_mode or optimizer_switch for instance.\r\n\r\n##### Parameters\r\n\r\nin_list (TEXT): The comma separated list to add a value to\r\n\r\nin_add_value (TEXT): The value to add to the input list\r\n\r\n##### Returns\r\n\r\nTEXT\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select @@sql_mode;\r\n+-----------------------------------------------------------------------------------+\r\n| @@sql_mode                                                                        |\r\n+-----------------------------------------------------------------------------------+\r\n| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |\r\n+-----------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> set sql_mode = sys.list_add(@@sql_mode, 'ANSI_QUOTES');\r\nQuery OK, 0 rows affected (0.06 sec)\r\n\r\nmysql> select @@sql_mode;\r\n+-----------------------------------------------------------------------------------------------+\r\n| @@sql_mode                                                                                    |\r\n+-----------------------------------------------------------------------------------------------+\r\n| ANSI_QUOTES,ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |\r\n+-----------------------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### list_drop\r\n\r\n##### Description\r\n\r\nTakes a list, and a value to attempt to remove from the list, and returns the resulting list.\r\n\r\nUseful for altering certain session variables, like sql_mode or optimizer_switch for instance.\r\n\r\n##### Parameters\r\n\r\nin_list (TEXT): The comma separated list to drop a value from\r\n\r\nin_drop_value (TEXT): The value to drop from the input list\r\n\r\n##### Returns\r\n\r\nTEXT\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> select @@sql_mode;\r\n+-----------------------------------------------------------------------------------------------+\r\n| @@sql_mode                                                                                    |\r\n+-----------------------------------------------------------------------------------------------+\r\n| ANSI_QUOTES,ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |\r\n+-----------------------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> set sql_mode = sys.list_drop(@@sql_mode, 'ONLY_FULL_GROUP_BY');\r\nQuery OK, 0 rows affected (0.03 sec)\r\n\r\nmysql> select @@sql_mode;\r\n+----------------------------------------------------------------------------+\r\n| @@sql_mode                                                                 |\r\n+----------------------------------------------------------------------------+\r\n| ANSI_QUOTES,STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |\r\n+----------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_is_account_enabled\r\n\r\n##### Description\r\n\r\nDetermines whether instrumentation of an account is enabled within Performance Schema.\r\n\r\n##### Parameters\r\n\r\n* in_host VARCHAR(60): The hostname of the account to check.\r\n* in_user VARCHAR(32): The username of the account to check.\r\n\r\n##### Returns\r\n\r\nENUM('YES', 'NO')\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_is_account_enabled('localhost', 'root');\r\n+------------------------------------------------+\r\n| sys.ps_is_account_enabled('localhost', 'root') |\r\n+------------------------------------------------+\r\n| YES                                            |\r\n+------------------------------------------------+\r\n1 row in set (0.01 sec)\r\n```\r\n\r\n#### ps_is_consumer_enabled\r\n\r\n##### Description\r\n\r\nDetermines whether a consumer is enabled (taking the consumer hierarchy into consideration) within the Performance Schema.\r\n\r\n##### Parameters\r\n\r\n* in_consumer VARCHAR(64): The name of the consumer to check.\r\n\r\n##### Returns\r\n\r\nENUM('YES', 'NO')\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_is_consumer_enabled('events_stages_history');\r\n+-----------------------------------------------------+\r\n| sys.ps_is_consumer_enabled('events_stages_history') |\r\n+-----------------------------------------------------+\r\n| NO                                                  |\r\n+-----------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_is_instrument_default_enabled\r\n\r\n##### Description\r\n\r\nReturns whether an instrument is enabled by default in this version of MySQL.\r\n\r\n##### Parameters\r\n\r\n* in_instrument VARCHAR(128): The instrument to check.\r\n\r\n##### Returns\r\n\r\nENUM('YES', 'NO')\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_is_instrument_default_enabled('statement/sql/select');\r\n+--------------------------------------------------------------+\r\n| sys.ps_is_instrument_default_enabled('statement/sql/select') |\r\n+--------------------------------------------------------------+\r\n| YES                                                          |\r\n+--------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_is_instrument_default_timed\r\n\r\n##### Description\r\n\r\nReturns whether an instrument is timed by default in this version of MySQL.\r\n\r\n##### Parameters\r\n\r\n* in_instrument VARCHAR(128): The instrument to check.\r\n\r\n##### Returns\r\n\r\nENUM('YES', 'NO')\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_is_instrument_default_timed('statement/sql/select');\r\n+------------------------------------------------------------+\r\n| sys.ps_is_instrument_default_timed('statement/sql/select') |\r\n+------------------------------------------------------------+\r\n| YES                                                        |\r\n+------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_is_thread_instrumented\r\n\r\n##### Description\r\n\r\nChecks whether the provided connection id is instrumented within Performance Schema.\r\n\r\n##### Parameters\r\n\r\n* in_connection_id (BIGINT UNSIGNED): the id of the connection to check.\r\n\r\n##### Returns\r\n\r\nENUM('YES', 'NO', 'UNKNOWN')\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_is_thread_instrumented(CONNECTION_ID());\r\n+------------------------------------------------+\r\n| sys.ps_is_thread_instrumented(CONNECTION_ID()) |\r\n+------------------------------------------------+\r\n| YES                                            |\r\n+------------------------------------------------+\r\n1 row in set (0.10 sec)\r\n```\r\n\r\n#### ps_thread_id\r\n\r\n##### Description\r\n\r\nReturn the Performance Schema THREAD_ID for the specified connection ID.\r\n\r\n##### Parameters\r\n\r\n* in_connection_id (BIGINT UNSIGNED): The id of the connection to return the thread id for. If NULL, the current connection thread id is returned.\r\n\r\n##### Returns\r\n\r\nBIGINT UNSIGNED\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT sys.ps_thread_id(79);\r\n+----------------------+\r\n| sys.ps_thread_id(79) |\r\n+----------------------+\r\n|                   98 |\r\n+----------------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> SELECT sys.ps_thread_id(CONNECTION_ID());\r\n+-----------------------------------+\r\n| sys.ps_thread_id(CONNECTION_ID()) |\r\n+-----------------------------------+\r\n|                                98 |\r\n+-----------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_thread_stack\r\n\r\n##### Description\r\n\r\nOutputs a JSON formatted stack of all statements, stages and events within Performance Schema for the specified thread.\r\n\r\n##### Parameters\r\n\r\n* thd_id (BIGINT): The id of the thread to trace. This should match the thread_id column from the performance_schema.threads table.\r\n\r\n##### Example\r\n\r\n(line separation added for output)\r\n\r\n```SQL\r\n mysql> SELECT sys.ps_thread_stack(37, FALSE) AS thread_stack\\G\r\n*************************** 1. row ***************************\r\nthread_stack: {\"rankdir\": \"LR\",\"nodesep\": \"0.10\",\"stack_created\": \"2014-02-19 13:39:03\",\r\n\"mysql_version\": \"5.7.3-m13\",\"mysql_user\": \"root@localhost\",\"events\": \r\n[{\"nesting_event_id\": \"0\", \"event_id\": \"10\", \"timer_wait\": 256.35, \"event_info\": \r\n\"sql/select\", \"wait_info\": \"select @@version_comment limit 1\\nerrors: 0\\nwarnings: 0\\nlock time:\r\n...\r\n```\r\n\r\n#### ps_thread_trx_info\r\n\r\n##### Description\r\n\r\nReturns a JSON object with info on the given thread's current transaction, and the statements it has already executed, derived from the `performance_schema.events_transactions_current` and `performance_schema.events_statements_history` tables (so the consumers for these also have to be enabled within Performance Schema to get full data in the object).\r\n\r\nWhen the output exceeds the default truncation length (65535), a JSON error object is returned, such as:\r\n\r\n`{ \"error\": \"Trx info truncated: Row 6 was cut by GROUP_CONCAT()\" }`\r\n\r\nSimilar error objects are returned for other warnings/and exceptions raised when calling the function.\r\n\r\nThe max length of the output of this function can be controlled with the `ps_thread_trx_info.max_length` variable set via `sys_config`, or the `@sys.ps_thread_trx_info.max_length` user variable, as appropriate.\r\n\r\n##### Parameters\r\n\r\n* in_thread_id (BIGINT UNSIGNED): The id of the thread to return the transaction info for.\r\n\r\n##### Example\r\n\r\n```SQL\r\nSELECT sys.ps_thread_trx_info(48)\\G\r\n*************************** 1. row ***************************\r\nsys.ps_thread_trx_info(48): [\r\n  {\r\n    \"time\": \"790.70 us\",\r\n    \"state\": \"COMMITTED\",\r\n    \"mode\": \"READ WRITE\",\r\n    \"autocommitted\": \"NO\",\r\n    \"gtid\": \"AUTOMATIC\",\r\n    \"isolation\": \"REPEATABLE READ\",\r\n    \"statements_executed\": [\r\n      {\r\n        \"sql_text\": \"INSERT INTO info VALUES (1, \\'foo\\')\",\r\n        \"time\": \"471.02 us\",\r\n        \"schema\": \"trx\",\r\n        \"rows_examined\": 0,\r\n        \"rows_affected\": 1,\r\n        \"rows_sent\": 0,\r\n        \"tmp_tables\": 0,\r\n        \"tmp_disk_tables\": 0,\r\n        \"sort_rows\": 0,\r\n        \"sort_merge_passes\": 0\r\n      },\r\n      {\r\n        \"sql_text\": \"COMMIT\",\r\n        \"time\": \"254.42 us\",\r\n        \"schema\": \"trx\",\r\n        \"rows_examined\": 0,\r\n        \"rows_affected\": 0,\r\n        \"rows_sent\": 0,\r\n        \"tmp_tables\": 0,\r\n        \"tmp_disk_tables\": 0,\r\n        \"sort_rows\": 0,\r\n        \"sort_merge_passes\": 0\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    \"time\": \"426.20 us\",\r\n    \"state\": \"COMMITTED\",\r\n    \"mode\": \"READ WRITE\",\r\n    \"autocommitted\": \"NO\",\r\n    \"gtid\": \"AUTOMATIC\",\r\n    \"isolation\": \"REPEATABLE READ\",\r\n    \"statements_executed\": [\r\n      {\r\n        \"sql_text\": \"INSERT INTO info VALUES (2, \\'bar\\')\",\r\n        \"time\": \"107.33 us\",\r\n        \"schema\": \"trx\",\r\n        \"rows_examined\": 0,\r\n        \"rows_affected\": 1,\r\n        \"rows_sent\": 0,\r\n        \"tmp_tables\": 0,\r\n        \"tmp_disk_tables\": 0,\r\n        \"sort_rows\": 0,\r\n        \"sort_merge_passes\": 0\r\n      },\r\n      {\r\n        \"sql_text\": \"COMMIT\",\r\n        \"time\": \"213.23 us\",\r\n        \"schema\": \"trx\",\r\n        \"rows_examined\": 0,\r\n        \"rows_affected\": 0,\r\n        \"rows_sent\": 0,\r\n        \"tmp_tables\": 0,\r\n        \"tmp_disk_tables\": 0,\r\n        \"sort_rows\": 0,\r\n        \"sort_merge_passes\": 0\r\n      }\r\n    ]\r\n  }\r\n]\r\n1 row in set (0.03 sec)\r\n```\r\n\r\n#### sys_get_config\r\n\r\n##### Description\r\n\r\nReturns the value for the requested variable using the following logic:\r\n\r\n1. If the option exists in sys.sys_config return the value from there.\r\n2. Else fall back on the provided default value.\r\n\r\nNotes for using sys_get_config():\r\n\r\n* If the default value argument to sys_get_config() is NULL and case 2. is reached, NULL is returned.\r\n  It is then expected that the caller is able to handle NULL for the given configuration option.\r\n* The convention is to name the user variables @sys.<name of variable>. It is <name of variable> that\r\n  is stored in the sys_config table and is what is expected as the argument to sys_get_config().\r\n* If you want to check whether the configuration option has already been set and if not assign with\r\n  the return value of sys_get_config() you can use IFNULL(...) (see example below). However this should\r\n  not be done inside a loop (e.g. for each row in a result set) as for repeated calls where assignment\r\n  is only needed in the first iteration using IFNULL(...) is expected to be significantly slower than\r\n  using an IF (...) THEN ... END IF; block (see example below).\r\n\r\n##### Parameters\r\n\r\n* in_variable_name (VARCHAR(128)): The name of the config option to return the value for.\r\n* in_default_value (VARCHAR(128)): The default value to return if neither a use variable exists nor the variable exists in sys.sys_config.\r\n\r\n##### Returns\r\n\r\nVARCHAR(128)\r\n\r\n##### Example\r\n```SQL\r\n-- Get the configuration value from sys.sys_config falling back on 128 if the option is not present in the table.\r\nmysql> SELECT sys.sys_get_config('statement_truncate_len', 128) AS Value;\r\n+-------+\r\n| Value |\r\n+-------+\r\n| 64    |\r\n+-------+\r\n1 row in set (0.00 sec)\r\n\r\n-- Check whether the option is already set, if not assign - IFNULL(...) one liner example.\r\nmysql> SET @sys.statement_truncate_len = IFNULL(@sys.statement_truncate_len, sys.sys_get_config('statement_truncate_len', 64));\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\n-- Check whether the option is already set, if not assign - IF ... THEN ... END IF example.\r\nIF (@sys.statement_truncate_len IS NULL) THEN\r\n    SET @sys.statement_truncate_len = sys.sys_get_config('statement_truncate_len', 64);\r\nEND IF;\r\n```\r\n\r\n#### version_major\r\n\r\n##### Description\r\n\r\nReturns the major version of MySQL Server.\r\n\r\n##### Returns\r\n\r\nTINYINT UNSIGNED\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT VERSION(), sys.version_major();\r\n+--------------------------------------+---------------------+\r\n| VERSION()                            | sys.version_major() |\r\n+--------------------------------------+---------------------+\r\n| 5.7.9-enterprise-commercial-advanced | 5                   |\r\n+--------------------------------------+---------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### version_minor\r\n\r\n##### Description\r\n\r\nReturns the minor (release series) version of MySQL Server.\r\n\r\n##### Returns\r\n\r\nTINYINT UNSIGNED\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT VERSION(), sys.server_minor();\r\n+--------------------------------------+---------------------+\r\n| VERSION()                            | sys.version_minor() |\r\n+--------------------------------------+---------------------+\r\n| 5.7.9-enterprise-commercial-advanced | 7                   |\r\n+--------------------------------------+---------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### version_patch\r\n\r\n##### Description\r\n\r\nReturns the patch release version of MySQL Server.\r\n\r\n##### Returns\r\n\r\nTINYINT UNSIGNED\r\n\r\n##### Example\r\n```SQL\r\nmysql> SELECT VERSION(), sys.version_patch();\r\n+--------------------------------------+---------------------+\r\n| VERSION()                            | sys.version_patch() |\r\n+--------------------------------------+---------------------+\r\n| 5.7.9-enterprise-commercial-advanced | 9                   |\r\n+--------------------------------------+---------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n\r\n### Procedures\r\n\r\n#### create_synonym_db\r\n\r\n##### Description\r\n\r\nTakes a source database name and synonym name, and then creates the synonym database with views that point to all of the tables within the source database.\r\n\r\nUseful for creating a \"ps\" synonym for \"performance_schema\", or \"is\" instead of \"information_schema\", for example.\r\n\r\n##### Parameters\r\n\r\n* in_db_name (VARCHAR(64)):\r\n** The database name that you would like to create a synonym for.\r\n* in_synonym (VARCHAR(64)):\r\n** The database synonym name.\r\n\r\n##### Example\r\n```SQL\r\nmysql> SHOW DATABASES;\r\n+--------------------+\r\n| Database           |\r\n+--------------------+\r\n| information_schema |\r\n| mysql              |\r\n| performance_schema |\r\n| sys                |\r\n| test               |\r\n+--------------------+\r\n5 rows in set (0.00 sec)\r\n\r\nmysql> CALL sys.create_synonym_db('performance_schema', 'ps');\r\n+-------------------------------------+\r\n| summary                             |\r\n+-------------------------------------+\r\n| Created 74 views in the ps database |\r\n+-------------------------------------+\r\n1 row in set (8.57 sec)\r\n\r\nQuery OK, 0 rows affected (8.57 sec)\r\n\r\nmysql> SHOW DATABASES;\r\n+--------------------+\r\n| Database           |\r\n+--------------------+\r\n| information_schema |\r\n| mysql              |\r\n| performance_schema |\r\n| ps                 |\r\n| sys                |\r\n| test               |\r\n+--------------------+\r\n6 rows in set (0.00 sec)\r\n\r\nmysql> SHOW FULL TABLES FROM ps;\r\n+-----------------------------------------+------------+\r\n| Tables_in_ps                            | Table_type |\r\n+-----------------------------------------+------------+\r\n| accounts                                | VIEW       |\r\n| cond_instances                          | VIEW       |\r\n| events_stages_current                   | VIEW       |\r\n| events_stages_history                   | VIEW       |\r\n...\r\n```\r\n\r\n#### execute_prepared_stmt\r\n\r\n##### Description\r\n\r\nTakes the query in the argument and executes it using a prepared statement. The prepared statement is deallocated,\r\nso the procedure is mainly useful for executing one off dynamically created queries.\r\n\r\nThe sys_execute_prepared_stmt prepared statement name is used for the query and is required not to exist.\r\n\r\n##### Parameters\r\n\r\n* in_query (longtext CHARACTER SET UTF8):\r\n** The query to execute.\r\n\r\nThe following configuration option is supported:\r\n\r\n   * sys.debug\r\n     Whether to provide debugging output.\r\n     Default is 'OFF'. Set to 'ON' to include.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.execute_prepared_stmt(''SELECT * FROM sys.sys_config'');\r\n+------------------------+-------+---------------------+--------+\r\n| variable               | value | set_time            | set_by |\r\n+------------------------+-------+---------------------+--------+\r\n| statement_truncate_len | 64    | 2015-06-30 13:06:00 | NULL   |\r\n+------------------------+-------+---------------------+--------+\r\n1 row in set (0.00 sec)\r\n\r\nQuery OK, 0 rows affected (0.00 sec)\r\n```\r\n\r\n#### diagnostics\r\n\r\n##### Description\r\n\r\nCreate a report of the current status of the server for diagnostics purposes. Data collected includes (some items depends on versions and settings):\r\n\r\n* The GLOBAL VARIABLES\r\n* Several sys schema views including metrics or equivalent (depending on version and settings)\r\n* Queries in the 95th percentile\r\n* Several ndbinfo views for MySQL Cluster\r\n* Replication (both master and slave) information.\r\n\r\nSome of the sys schema views are calculated as initial (optional), overall, delta:\r\n\r\n* The initial view is the content of the view at the start of this procedure.\r\n  This output will be the same as the the start values used for the delta view.\r\n  The initial view is included if @sys.diagnostics.include_raw = 'ON'.\r\n* The overall view is the content of the view at the end of this procedure.\r\n  This output is the same as the end values used for the delta view.\r\n  The overall view is always included.\r\n* The delta view is the difference from the beginning to the end. Note that for min and max values\r\n  they are simply the min or max value from the end view respectively, so does not necessarily reflect\r\n  the minimum/maximum value in the monitored period.\r\n  Note: except for the metrics view the delta is only calculation between the first and last outputs.\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\nVersions supported:\r\n* MySQL 5.6: 5.6.10 and later\r\n* MySQL 5.7: 5.7.9 and later\r\n\r\nSome configuration options are supported:\r\n\r\n* sys.diagnostics.allow_i_s_tables\r\n  Specifies whether it is allowed to do table scan queries on information_schema.TABLES. This can be expensive if there\r\n  are many tables. Set to 'ON' to allow, 'OFF' to not allow.\r\n  Default is 'OFF'.\r\n\r\n* sys.diagnostics.include_raw\r\n  Set to 'ON' to include the raw data (e.g. the original output of \"SELECT * FROM sys.metrics\").\r\n  Use this to get the initial values of the various views.\r\n  Default is 'OFF'.\r\n\r\n* sys.statement_truncate_len\r\n  How much of queries in the process list output to include.\r\n  Default is 64.\r\n\r\n* sys.debug\r\n  Whether to provide debugging output.\r\n  Default is 'OFF'. Set to 'ON' to include.\r\n\r\n##### Parameters\r\n\r\n* in_max_runtime (INT UNSIGNED):\r\nThe maximum time to keep collecting data.\r\nUse NULL to get the default which is 60 seconds, otherwise enter a value greater than 0.\r\n* in_interval (INT UNSIGNED):\r\nHow long to sleep between data collections.\r\nUse NULL to get the default which is 30 seconds, otherwise enter a value greater than 0.\r\n* in_auto_config (ENUM('current', 'medium', 'full'))\r\nAutomatically enable Performance Schema instruments and consumers.\r\nNOTE: The more that are enabled, the more impact on the performance.\r\nIf another setting the 'current' is chosen, the current settings\r\nare restored at the end of the procedure.\r\nSupported values are:\r\n** current - use the current settings.\r\n** medium - enable some settings. This requires the SUPER privilege.\r\n** full - enables all settings. This will have a big impact on the\r\n   performance - be careful using this option. This requires the SUPER privilege.\r\n\r\n##### Example\r\n```SQL\r\nmysql> TEE diag.out;\r\nmysql> CALL sys.diagnostics(120, 30, 'current');\r\n...\r\nmysql> NOTEE;\r\n```\r\n\r\n#### ps_setup_disable_background_threads\r\n\r\n##### Description\r\n\r\nDisable all background thread instrumentation within Performance Schema.\r\n\r\n##### Parameters\r\n\r\nNone.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_background_threads();\r\n+--------------------------------+\r\n| summary                        |\r\n+--------------------------------+\r\n| Disabled 18 background threads |\r\n+--------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_disable_instrument\r\n\r\n##### Description\r\n\r\nDisables instruments within Performance Schema  matching the input pattern.\r\n\r\n##### Parameters\r\n\r\n* in_pattern (VARCHAR(128)): A LIKE pattern match (using \"%in_pattern%\") of events to disable\r\n\r\n##### Example\r\n\r\nTo disable all mutex instruments:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_instrument('wait/synch/mutex');\r\n+--------------------------+\r\n| summary                  |\r\n+--------------------------+\r\n| Disabled 155 instruments |\r\n+--------------------------+\r\n1 row in set (0.02 sec)\r\n```\r\nTo disable just a the scpecific TCP/IP based network IO instrument:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_instrument('wait/io/socket/sql/server_tcpip_socket');\r\n+------------------------+\r\n| summary                |\r\n+------------------------+\r\n| Disabled 1 instruments |\r\n+------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\nTo enable all instruments:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_instrument('');\r\n+--------------------------+\r\n| summary                  |\r\n+--------------------------+\r\n| Disabled 547 instruments |\r\n+--------------------------+\r\n1 row in set (0.01 sec)\r\n```\r\n\r\n#### ps_setup_disable_consumer\r\n\r\n##### Description\r\n\r\nDisables consumers within Performance Schema matching the input pattern.\r\n\r\n##### Parameters\r\n\r\n* consumer (VARCHAR(128)): A LIKE pattern match (using \"%consumer%\") of consumers to disable\r\n\r\n##### Example\r\n\r\nTo disable all consumers:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_consumer('');\r\n+--------------------------+\r\n| summary                  |\r\n+--------------------------+\r\n| Disabled 15 consumers    |\r\n+--------------------------+\r\n1 row in set (0.02 sec)\r\n```\r\n\r\nTo disable just the event_stage consumers:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_consumer('stage');\r\n+------------------------+\r\n| summary                |\r\n+------------------------+\r\n| Disabled 3 consumers   |\r\n+------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_disable_thread\r\n\r\n##### Description\r\n\r\nDisable the given connection/thread in Performance Schema.\r\n\r\n##### Parameters\r\n\r\n* in_connection_id (BIGINT): The connection ID (PROCESSLIST_ID from performance_schema.threads or the ID shown within SHOW PROCESSLIST)\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_thread(3);\r\n+-------------------+\r\n| summary           |\r\n+-------------------+\r\n| Disabled 1 thread |\r\n+-------------------+\r\n1 row in set (0.01 sec)\r\n```\r\nTo disable the current connection:\r\n```SQL\r\nmysql> CALL sys.ps_setup_disable_thread(CONNECTION_ID());\r\n+-------------------+\r\n| summary           |\r\n+-------------------+\r\n| Disabled 1 thread |\r\n+-------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_enable_background_threads\r\n\r\n##### Description\r\n\r\nEnable all background thread instrumentation within Performance Schema.\r\n\r\n##### Parameters\r\n\r\nNone.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_background_threads();\r\n+-------------------------------+\r\n| summary                       |\r\n+-------------------------------+\r\n| Enabled 18 background threads |\r\n+-------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_enable_consumer\r\n\r\n##### Description\r\n\r\nEnables consumers within Performance Schema matching the input pattern.\r\n\r\n##### Parameters\r\n\r\n* consumer (VARCHAR(128)): A LIKE pattern match (using \"%consumer%\") of consumers to enable\r\n\r\n##### Example\r\n\r\nTo enable all consumers:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_consumer('');\r\n+-------------------------+\r\n| summary                 |\r\n+-------------------------+\r\n| Enabled 10 consumers    |\r\n+-------------------------+\r\n1 row in set (0.02 sec)\r\n```\r\n\r\nTo enable just \"waits\" consumers:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_consumer('waits');\r\n+-----------------------+\r\n| summary               |\r\n+-----------------------+\r\n| Enabled 3 consumers   |\r\n+-----------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_enable_instrument\r\n\r\n##### Description\r\n\r\nEnables instruments within Performance Schema matching the input pattern.\r\n\r\n##### Parameters\r\n\r\n\r\n* in_pattern (VARCHAR(128)): A LIKE pattern match (using \"%in_pattern%\") of events to enable\r\n\r\n##### Example\r\n\r\nTo enable all mutex instruments:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_instrument('wait/synch/mutex');\r\n+-------------------------+\r\n| summary                 |\r\n+-------------------------+\r\n| Enabled 155 instruments |\r\n+-------------------------+\r\n1 row in set (0.02 sec)\r\n```\r\nTo enable just a the scpecific TCP/IP based network IO instrument:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_instrument('wait/io/socket/sql/server_tcpip_socket');\r\n+-----------------------+\r\n| summary               |\r\n+-----------------------+\r\n| Enabled 1 instruments |\r\n+-----------------------+\r\n1 row in set (0.00 sec)\r\n```\r\nTo enable all instruments:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_instrument('');\r\n+-------------------------+\r\n| summary                 |\r\n+-------------------------+\r\n| Enabled 547 instruments |\r\n+-------------------------+\r\n1 row in set (0.01 sec)\r\n```\r\n\r\n#### ps_setup_enable_thread\r\n\r\n##### Description\r\n\r\nEnable the given connection/thread in Performance Schema.\r\n\r\n##### Parameters\r\n\r\n\r\n* in_connection_id (BIGINT): The connection ID (PROCESSLIST_ID from performance_schema.threads or the ID shown within SHOW PROCESSLIST)\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_thread(3);\r\n+------------------+\r\n| summary          |\r\n+------------------+\r\n| Enabled 1 thread |\r\n+------------------+\r\n1 row in set (0.01 sec)\r\n```\r\nTo enable the current connection:\r\n```SQL\r\nmysql> CALL sys.ps_setup_enable_thread(CONNECTION_ID());\r\n+------------------+\r\n| summary          |\r\n+------------------+\r\n| Enabled 1 thread |\r\n+------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n#### ps_setup_reload_saved\r\n\r\n##### Description\r\n\r\nReloads a saved Performance Schema configuration, so that you can alter the setup for debugging purposes, but restore it to a previous state.\r\n             \r\nUse the companion procedure - ps_setup_save(), to save a configuration.\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\n##### Parameters\r\n\r\nNone.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_save();\r\nQuery OK, 0 rows affected (0.08 sec)\r\n\r\nmysql> UPDATE performance_schema.setup_instruments SET enabled = 'YES', timed = 'YES';\r\nQuery OK, 547 rows affected (0.40 sec)\r\nRows matched: 784  Changed: 547  Warnings: 0\r\n\r\n/* Run some tests that need more detailed instrumentation here */\r\n\r\nmysql> CALL sys.ps_setup_reload_saved();\r\nQuery OK, 0 rows affected (0.32 sec)\r\n```\r\n\r\n#### ps_setup_reset_to_default\r\n\r\n##### Description\r\n\r\nResets the Performance Schema setup to the default settings.\r\n\r\n##### Parameters\r\n\r\n* in_verbose (BOOLEAN): Whether to print each setup stage (including the SQL) whilst running.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_reset_to_default(true)\\G\r\n*************************** 1. row ***************************\r\nstatus: Resetting: setup_actors\r\nDELETE\r\nFROM performance_schema.setup_actors\r\nWHERE NOT (HOST = '%' AND USER = '%' AND ROLE = '%')\r\n1 row in set (0.00 sec)\r\n\r\n*************************** 1. row ***************************\r\nstatus: Resetting: setup_actors\r\nINSERT IGNORE INTO performance_schema.setup_actors\r\nVALUES ('%', '%', '%')\r\n1 row in set (0.00 sec)\r\n...\r\n\r\nmysql> CALL sys.ps_setup_reset_to_default(false)G\r\nQuery OK, 0 rows affected (0.00 sec)\r\n```\r\n\r\n#### ps_setup_save\r\n\r\n##### Description\r\n\r\nSaves the current configuration of Performance Schema, so that you can alter the setup for debugging purposes, but restore it to a previous state.\r\n\r\nUse the companion procedure - ps_setup_reload_saved(), to restore the saved config.\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\n##### Parameters\r\n\r\nNone.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_save();\r\nQuery OK, 0 rows affected (0.08 sec)\r\n\r\nmysql> UPDATE performance_schema.setup_instruments \r\n    ->    SET enabled = 'YES', timed = 'YES';\r\nQuery OK, 547 rows affected (0.40 sec)\r\nRows matched: 784  Changed: 547  Warnings: 0\r\n\r\n/* Run some tests that need more detailed instrumentation here */\r\n\r\nmysql> CALL sys.ps_setup_reload_saved();\r\nQuery OK, 0 rows affected (0.32 sec)\r\n```\r\n\r\n#### ps_setup_show_disabled\r\n\r\n##### Description\r\n\r\nShows all currently disable Performance Schema configuration.\r\n\r\n##### Parameters\r\n\r\n* in_in_show_instruments (BOOLEAN): Whether to print disabled instruments (can print many items)\r\n* in_in_show_threads (BOOLEAN): Whether to print disabled threads\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_disabled(TRUE, TRUE);\r\n+----------------------------+\r\n| performance_schema_enabled |\r\n+----------------------------+\r\n|                          1 |\r\n+----------------------------+\r\n1 row in set (0.00 sec)\r\n\r\n+--------------------+\r\n| enabled_users      |\r\n+--------------------+\r\n| 'mark'@'localhost' |\r\n+--------------------+\r\n1 row in set (0.00 sec)\r\n\r\n+-------------+----------------------+---------+-------+\r\n| object_type | objects              | enabled | timed |\r\n+-------------+----------------------+---------+-------+\r\n| EVENT       | mysql.%              | NO      | NO    |\r\n| EVENT       | performance_schema.% | NO      | NO    |\r\n| EVENT       | information_schema.% | NO      | NO    |\r\n| FUNCTION    | mysql.%              | NO      | NO    |\r\n| FUNCTION    | performance_schema.% | NO      | NO    |\r\n| FUNCTION    | information_schema.% | NO      | NO    |\r\n| PROCEDURE   | mysql.%              | NO      | NO    |\r\n| PROCEDURE   | performance_schema.% | NO      | NO    |\r\n| PROCEDURE   | information_schema.% | NO      | NO    |\r\n| TABLE       | mysql.%              | NO      | NO    |\r\n| TABLE       | performance_schema.% | NO      | NO    |\r\n| TABLE       | information_schema.% | NO      | NO    |\r\n| TRIGGER     | mysql.%              | NO      | NO    |\r\n| TRIGGER     | performance_schema.% | NO      | NO    |\r\n| TRIGGER     | information_schema.% | NO      | NO    |\r\n+-------------+----------------------+---------+-------+\r\n15 rows in set (0.00 sec)\r\n\r\n+----------------------------------+\r\n| disabled_consumers               |\r\n+----------------------------------+\r\n| events_stages_current            |\r\n| events_stages_history            |\r\n| events_stages_history_long       |\r\n| events_statements_history        |\r\n| events_statements_history_long   |\r\n| events_transactions_history      |\r\n| events_transactions_history_long |\r\n| events_waits_current             |\r\n| events_waits_history             |\r\n| events_waits_history_long        |\r\n+----------------------------------+\r\n10 rows in set (0.00 sec)\r\n\r\nEmpty set (0.00 sec)\r\n             \r\n+---------------------------------------------------------------------------------------+-------+\r\n| disabled_instruments                                                                  | timed |\r\n+---------------------------------------------------------------------------------------+-------+\r\n| wait/synch/mutex/sql/TC_LOG_MMAP::LOCK_tc                                             | NO    |\r\n| wait/synch/mutex/sql/LOCK_des_key_file                                                | NO    |\r\n| wait/synch/mutex/sql/MYSQL_BIN_LOG::LOCK_commit                                       | NO    |\r\n...\r\n| memory/sql/servers_cache                                                              | NO    |\r\n| memory/sql/udf_mem                                                                    | NO    |\r\n| wait/lock/metadata/sql/mdl                                                            | NO    |\r\n+---------------------------------------------------------------------------------------+-------+\r\n547 rows in set (0.00 sec)\r\n\r\nQuery OK, 0 rows affected (0.01 sec)\r\n```\r\n\r\n#### ps_setup_show_disabled_consumers\r\n\r\n##### Description\r\n\r\nShows all currently disabled consumers.\r\n\r\n##### Parameters\r\n\r\nNone\r\n \r\n##### Example\r\n\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_disabled_consumers();\r\n\r\n+---------------------------+\r\n| disabled_consumers        |\r\n+---------------------------+\r\n| events_statements_current |\r\n| global_instrumentation    |\r\n| thread_instrumentation    |\r\n| statements_digest         |\r\n+---------------------------+\r\n4 rows in set (0.05 sec)\r\n```\r\n\r\n#### ps_setup_show_disabled_instruments\r\n\r\n##### Description\r\n\r\nShows all currently disabled instruments.\r\n\r\n##### Parameters\r\n\r\nNone\r\n\t\t\t \r\n##### Example\r\n\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_disabled_instruments();\r\n```\r\n\r\n#### ps_setup_show_enabled\r\n\r\n##### Description\r\n\r\nShows all currently enabled Performance Schema configuration.\r\n\r\n##### Parameters\r\n\r\n* in_show_instruments (BOOLEAN): Whether to print enabled instruments (can print many items)\r\n* in_show_threads (BOOLEAN): Whether to print enabled threads\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_enabled(TRUE, TRUE);\r\n+----------------------------+\r\n| performance_schema_enabled |\r\n+----------------------------+\r\n|                          1 |\r\n+----------------------------+\r\n1 row in set (0.00 sec)\r\n\r\n+---------------+\r\n| enabled_users |\r\n+---------------+\r\n| '%'@'%'       |\r\n+---------------+\r\n1 row in set (0.01 sec)\r\n\r\n+----------------------+---------+-------+\r\n| objects              | enabled | timed |\r\n+----------------------+---------+-------+\r\n| mysql.%              | NO      | NO    |\r\n| performance_schema.% | NO      | NO    |\r\n| information_schema.% | NO      | NO    |\r\n| %.%                  | YES     | YES   |\r\n+----------------------+---------+-------+\r\n4 rows in set (0.01 sec)\r\n\r\n+---------------------------+\r\n| enabled_consumers         |\r\n+---------------------------+\r\n| events_statements_current |\r\n| global_instrumentation    |\r\n| thread_instrumentation    |\r\n| statements_digest         |\r\n+---------------------------+\r\n4 rows in set (0.05 sec)\r\n\r\n+--------------------------+-------------+\r\n| enabled_threads          | thread_type |\r\n+--------------------------+-------------+\r\n| innodb/srv_master_thread | BACKGROUND  |\r\n| root@localhost           | FOREGROUND  |\r\n| root@localhost           | FOREGROUND  |\r\n| root@localhost           | FOREGROUND  |\r\n| root@localhost           | FOREGROUND  |\r\n+--------------------------+-------------+\r\n5 rows in set (0.03 sec)\r\n\r\n+-------------------------------------+-------+\r\n| enabled_instruments                 | timed |\r\n+-------------------------------------+-------+\r\n| wait/io/file/sql/map                | YES   |\r\n| wait/io/file/sql/binlog             | YES   |\r\n...\r\n| statement/com/Error                 | YES   |\r\n| statement/com/                      | YES   |\r\n| idle                                | YES   |\r\n+-------------------------------------+-------+\r\n210 rows in set (0.08 sec)\r\n\r\nQuery OK, 0 rows affected (0.89 sec)\r\n```\r\n\r\n#### ps_setup_show_enabled_consumers\r\n\r\n##### Description\r\n\r\nShows all currently enabled consumers.\r\n\r\n##### Parameters\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_enabled_consumers();\r\n\r\n+---------------------------+\r\n| enabled_consumers         |\r\n+---------------------------+\r\n| events_statements_current |\r\n| global_instrumentation    |\r\n| thread_instrumentation    |\r\n| statements_digest         |\r\n+---------------------------+\r\n4 rows in set (0.05 sec)\r\n```\r\n\r\n#### ps_setup_show_enabled_instruments\r\n\r\n##### Description\r\n\r\nShows all currently enabled instruments.\r\n\r\n##### Parameters\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```SQL\r\nmysql> CALL sys.ps_setup_show_enabled_instruments();\r\n```\r\n\r\n#### ps_statement_avg_latency_histogram\r\n\r\n##### Description\r\n\r\nOutputs a textual histogram graph of the average latency values across all normalized queries tracked within the Performance Schema events_statements_summary_by_digest table.\r\n\r\nCan be used to show a very high level picture of what kind of latency distribution statements running within this instance have.\r\n\r\n##### Parameters\r\n\r\nNone.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_statement_avg_latency_histogram()G\r\n*************************** 1. row ***************************\r\nPerformance Schema Statement Digest Average Latency Histogram:\r\n\r\n  . = 1 unit\r\n  * = 2 units\r\n  # = 3 units\r\n\r\n(0 - 38ms)     240 | ################################################################################\r\n(38 - 77ms)    38  | ......................................\r\n(77 - 115ms)   3   | ...\r\n(115 - 154ms)  62  | *******************************\r\n(154 - 192ms)  3   | ...\r\n(192 - 231ms)  0   |\r\n(231 - 269ms)  0   |\r\n(269 - 307ms)  0   |\r\n(307 - 346ms)  0   |\r\n(346 - 384ms)  1   | .\r\n(384 - 423ms)  1   | .\r\n(423 - 461ms)  0   |\r\n(461 - 499ms)  0   |\r\n(499 - 538ms)  0   |\r\n(538 - 576ms)  0   |\r\n(576 - 615ms)  1   | .\r\n\r\n  Total Statements: 350; Buckets: 16; Bucket Size: 38 ms;\r\n```\r\n\r\n#### ps_trace_statement_digest\r\n\r\n##### Description\r\n\r\nTraces all instrumentation within Performance Schema for a specific Statement Digest. \r\n\r\nWhen finding a statement of interest within the performance_schema.events_statements_summary_by_digest table, feed the DIGEST MD5 value in to this procedure, set how long to poll for, and at what interval to poll, and it will generate a report of all statistics tracked within Performance Schema for that digest for the interval.\r\n\r\nIt will also attempt to generate an EXPLAIN for the longest running example of the digest during the interval.\r\n\r\nNote this may fail, as Performance Schema truncates long SQL_TEXT values (and hence the EXPLAIN will fail due to parse errors).\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\n##### Parameters\r\n\r\n* in_digest VARCHAR(32): The statement digest identifier you would like to analyze\r\n* in_runtime (INT): The number of seconds to run analysis for (defaults to a minute)\r\n* in_interval (DECIMAL(2,2)): The interval (in seconds, may be fractional) at which to try and take snapshots (defaults to a second)\r\n* in_start_fresh (BOOLEAN): Whether to TRUNCATE the events_statements_history_long and events_stages_history_long tables before starting (default false)\r\n* in_auto_enable (BOOLEAN): Whether to automatically turn on required consumers (default false)\r\n\r\n##### Example\r\n```SQL\r\nmysql> call ps_analyze_statement_digest('891ec6860f98ba46d89dd20b0c03652c', 10, 0.1, true, true);\r\n+--------------------+\r\n| SUMMARY STATISTICS |\r\n+--------------------+\r\n| SUMMARY STATISTICS |\r\n+--------------------+\r\n1 row in set (9.11 sec)\r\n\r\n+------------+-----------+-----------+-----------+---------------+------------+------------+\r\n| executions | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scans |\r\n+------------+-----------+-----------+-----------+---------------+------------+------------+\r\n|         21 | 4.11 ms   | 2.00 ms   |         0 |            21 |          0 |          0 |\r\n+------------+-----------+-----------+-----------+---------------+------------+------------+\r\n1 row in set (9.11 sec)\r\n\r\n+------------------------------------------+-------+-----------+\r\n| event_name                               | count | latency   |\r\n+------------------------------------------+-------+-----------+\r\n| stage/sql/checking query cache for query |    16 | 724.37 us |\r\n| stage/sql/statistics                     |    16 | 546.92 us |\r\n| stage/sql/freeing items                  |    18 | 520.11 us |\r\n| stage/sql/init                           |    51 | 466.80 us |\r\n...\r\n| stage/sql/cleaning up                    |    18 | 11.92 us  |\r\n| stage/sql/executing                      |    16 | 6.95 us   |\r\n+------------------------------------------+-------+-----------+\r\n17 rows in set (9.12 sec)\r\n\r\n+---------------------------+\r\n| LONGEST RUNNING STATEMENT |\r\n+---------------------------+\r\n| LONGEST RUNNING STATEMENT |\r\n+---------------------------+\r\n1 row in set (9.16 sec)\r\n             \r\n+-----------+-----------+-----------+-----------+---------------+------------+-----------+\r\n| thread_id | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scan |\r\n+-----------+-----------+-----------+-----------+---------------+------------+-----------+\r\n|    166646 | 618.43 us | 1.00 ms   |         0 |             1 |          0 |         0 |\r\n+-----------+-----------+-----------+-----------+---------------+------------+-----------+\r\n1 row in set (9.16 sec)\r\n\r\n// Truncated for clarity...\r\n+-----------------------------------------------------------------+\r\n| sql_text                                                        |\r\n+-----------------------------------------------------------------+\r\n| select hibeventhe0_.id as id1382_, hibeventhe0_.createdTime ... |\r\n+-----------------------------------------------------------------+\r\n1 row in set (9.17 sec)\r\n\r\n+------------------------------------------+-----------+\r\n| event_name                               | latency   |\r\n+------------------------------------------+-----------+\r\n| stage/sql/init                           | 8.61 us   |\r\n| stage/sql/Waiting for query cache lock   | 453.23 us |\r\n| stage/sql/init                           | 331.07 ns |\r\n| stage/sql/checking query cache for query | 43.04 us  |\r\n...\r\n| stage/sql/freeing items                  | 30.46 us  |\r\n| stage/sql/cleaning up                    | 662.13 ns |\r\n+------------------------------------------+-----------+\r\n             18 rows in set (9.23 sec)\r\n\r\n+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+\r\n| id | select_type | table        | type  | possible_keys | key       | key_len | ref         | rows | Extra |\r\n+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+\r\n|  1 | SIMPLE      | hibeventhe0_ | const | fixedTime     | fixedTime | 775     | const,const |    1 | NULL  |\r\n+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+\r\n1 row in set (9.27 sec)\r\n\r\nQuery OK, 0 rows affected (9.28 sec)\r\n```\r\n\r\n#### ps_trace_thread\r\n\r\n##### Description\r\n\r\nDumps all data within Performance Schema for an instrumented thread, to create a DOT formatted graph file. \r\n\r\nEach resultset returned from the procedure should be used for a complete graph\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\n##### Parameters\r\n\r\n* in_thread_id (INT): The thread that you would like a stack trace for\r\n* in_outfile  (VARCHAR(255)): The filename the dot file will be written to\r\n* in_max_runtime (DECIMAL(20,2)): The maximum time to keep collecting data. Use NULL to get the default which is 60 seconds.\r\n* in_interval (DECIMAL(20,2)): How long to sleep between data collections. Use NULL to get the default which is 1 second.\r\n* in_start_fresh (BOOLEAN): Whether to reset all Performance Schema data before tracing.\r\n* in_auto_setup (BOOLEAN): Whether to disable all other threads and enable all consumers/instruments. This will also reset the settings at the end of the run.\r\n* in_debug (BOOLEAN): Whether you would like to include file:lineno in the graph\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_trace_thread(25, CONCAT('/tmp/stack-', REPLACE(NOW(), ' ', '-'), '.dot'), NULL, NULL, TRUE, TRUE, TRUE);\r\n+-------------------+\r\n| summary           |\r\n+-------------------+\r\n| Disabled 1 thread |\r\n+-------------------+\r\n1 row in set (0.00 sec)\r\n\r\n+---------------------------------------------+\r\n| Info                                        |\r\n+---------------------------------------------+\r\n| Data collection starting for THREAD_ID = 25 |\r\n+---------------------------------------------+\r\n1 row in set (0.03 sec)\r\n\r\n+-----------------------------------------------------------+\r\n| Info                                                      |\r\n+-----------------------------------------------------------+\r\n| Stack trace written to /tmp/stack-2014-02-16-21:18:41.dot |\r\n+-----------------------------------------------------------+\r\n1 row in set (60.07 sec)\r\n\r\n+-------------------------------------------------------------------+\r\n| Convert to PDF                                                    |\r\n+-------------------------------------------------------------------+\r\n| dot -Tpdf -o /tmp/stack_25.pdf /tmp/stack-2014-02-16-21:18:41.dot |\r\n+-------------------------------------------------------------------+\r\n1 row in set (60.07 sec)\r\n\r\n+-------------------------------------------------------------------+\r\n| Convert to PNG                                                    |\r\n+-------------------------------------------------------------------+\r\n| dot -Tpng -o /tmp/stack_25.png /tmp/stack-2014-02-16-21:18:41.dot |\r\n+-------------------------------------------------------------------+\r\n1 row in set (60.07 sec)\r\n\r\n+------------------+\r\n| summary          |\r\n+------------------+\r\n| Enabled 1 thread |\r\n+------------------+\r\n1 row in set (60.32 sec)\r\n```\r\n\r\n#### ps_truncate_all_tables\r\n\r\n##### Description\r\n\r\nTruncates all summary tables within Performance Schema, resetting all aggregated instrumentation as a snapshot.\r\n\r\n##### Parameters\r\n\r\n* in_verbose (BOOLEAN): Whether to print each TRUNCATE statement before running\r\n\r\n##### Example\r\n```SQL\r\nmysql> CALL sys.ps_truncate_all_tables(false);\r\n+---------------------+\r\n| summary             |\r\n+---------------------+\r\n| Truncated 44 tables |\r\n+---------------------+\r\n1 row in set (0.10 sec)\r\n```\r\n\r\n#### statement_performance_analyzer\r\n\r\n##### Description\r\nCreate a report of the statements running on the server.\r\n\r\nThe views are calculated based on the overall and/or delta activity.\r\n\r\nRequires the SUPER privilege for \"SET sql_log_bin = 0;\".\r\n\r\nThe following configuration options are supported:\r\n\r\n   * sys.statement_performance_analyzer.limit\r\n     The maximum number of rows to include for the views that does not have a built-in limit (e.g. the 95th percentile view).\r\n     If not set the limit is 100.\r\n\r\n   * sys.statement_performance_analyzer.view\r\n     Used together with the 'custom' view. If the value contains a space, it is considered a query, otherwise it must be\r\n     an existing view querying the performance_schema.events_statements_summary_by_digest table. There cannot be any limit\r\n     clause including in the query or view definition if @sys.statement_performance_analyzer.limit > 0.\r\n     If specifying a view, use the same format as for in_table.\r\n\r\n   * sys.debug\r\n     Whether to provide debugging output.\r\n     Default is 'OFF'. Set to 'ON' to include.\r\n\r\n##### Parameters\r\n\r\n* in_action (ENUM('snapshot', 'overall', 'delta', 'create_tmp', 'create_table', 'save', 'cleanup')):\r\n  The action to take. Supported actions are:\r\n    - snapshot      Store a snapshot. The default is to make a snapshot of the current content of\r\n                    performance_schema.events_statements_summary_by_digest, but by setting in_table\r\n                    this can be overwritten to copy the content of the specified table.\r\n                    The snapshot is stored in the sys.tmp_digests temporary table.\r\n    - overall       Generate analyzis based on the content specified by in_table. For the overall analyzis,\r\n                    in_table can be NOW() to use a fresh snapshot. This will overwrite an existing snapshot.\r\n                    Use NULL for in_table to use the existing snapshot. If in_table IS NULL and no snapshot\r\n                    exists, a new will be created.\r\n                    See also in_views and @sys.statement_performance_analyzer.limit.\r\n    - delta         Generate a delta analysis. The delta will be calculated between the reference table in\r\n                    in_table and the snapshot. An existing snapshot must exist.\r\n                    The action uses the sys.tmp_digests_delta temporary table.\r\n                    See also in_views and @sys.statement_performance_analyzer.limit.\r\n    - create_table  Create a regular table suitable for storing the snapshot for later use, e.g. for\r\n                    calculating deltas.\r\n    - create_tmp    Create a temporary table suitable for storing the snapshot for later use, e.g. for\r\n                    calculating deltas.\r\n    - save          Save the snapshot in the table specified by in_table. The table must exists and have\r\n                    the correct structure.\r\n                    If no snapshot exists, a new is created.\r\n    - cleanup       Remove the temporary tables used for the snapshot and delta.\r\n\r\n* in_table (VARCHAR(129)):\r\n  The table argument used for some actions. Use the format 'db1.t1' or 't1' without using any backticks (`)\r\n  for quoting. Periods (.) are not supported in the database and table names.\r\n  \r\n  The meaning of the table for each action supporting the argument is:\r\n\r\n    - snapshot      The snapshot is created based on the specified table. Set to NULL or NOW() to use\r\n                    the current content of performance_schema.events_statements_summary_by_digest.\r\n    - overall       The table with the content to create the overall analyzis for. The following values\r\n                    can be used:\r\n                      - A table name - use the content of that table.\r\n                      - NOW()        - create a fresh snapshot and overwrite the existing snapshot.\r\n                      - NULL         - use the last stored snapshot.\r\n    - delta         The table name is mandatory and specified the reference view to compare the currently\r\n                    stored snapshot against. If no snapshot exists, a new will be created.\r\n    - create_table  The name of the regular table to create.\r\n    - create_tmp    The name of the temporary table to create.\r\n    - save          The name of the table to save the currently stored snapshot into.\r\n\r\n* in_views (SET ('with_runtimes_in_95th_percentile', 'analysis', 'with_errors_or_warnings',\r\n                 'with_full_table_scans', 'with_sorting', 'with_temp_tables', 'custom'))\r\n  Which views to include:\r\n\r\n    - with_runtimes_in_95th_percentile  Based on the sys.statements_with_runtimes_in_95th_percentile view\r\n    - analysis                          Based on the sys.statement_analysis view\r\n    - with_errors_or_warnings           Based on the sys.statements_with_errors_or_warnings view\r\n    - with_full_table_scans             Based on the sys.statements_with_full_table_scans view\r\n    - with_sorting                      Based on the sys.statements_with_sorting view\r\n    - with_temp_tables                  Based on the sys.statements_with_temp_tables view\r\n    - custom                            Use a custom view. This view must be specified in @sys.statement_performance_analyzer.view to an existing view or a query\r\n\r\n  Default is to include all except 'custom'.\r\n\r\n##### Example\r\n```SQL\r\n-- To create a report with the queries in the 95th percentile since last truncate of performance_schema.events_statements_summary_by_digest and the delta for a 1 minute period:\r\n--\r\n--    1. Create a temporary table to store the initial snapshot.\r\n--    2. Create the initial snapshot.\r\n--    3. Save the initial snapshot in the temporary table.\r\n--    4. Wait one minute.\r\n--    5. Create a new snapshot.\r\n--    6. Perform analyzis based on the new snapshot.\r\n--    7. Perform analyzis based on the delta between the initial and new snapshots.\r\n\r\nmysql> CALL sys.statement_performance_analyzer('create_tmp', 'mydb.tmp_digests_ini', NULL);\r\nQuery OK, 0 rows affected (0.08 sec)\r\n\r\nmysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);\r\nQuery OK, 0 rows affected (0.02 sec)\r\n\r\nmysql> CALL sys.statement_performance_analyzer('save', 'mydb.tmp_digests_ini', NULL);\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\nmysql> DO SLEEP(60);\r\nQuery OK, 0 rows affected (1 min 0.00 sec)\r\n\r\nmysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);\r\nQuery OK, 0 rows affected (0.02 sec)\r\n\r\nmysql> CALL sys.statement_performance_analyzer('overall', NULL, 'with_runtimes_in_95th_percentile');\r\n+-----------------------------------------+\r\n| Next Output                             |\r\n+-----------------------------------------+\r\n| Queries with Runtime in 95th Percentile |\r\n+-----------------------------------------+\r\n1 row in set (0.05 sec)\r\n\r\n...\r\n\r\nmysql> CALL sys.statement_performance_analyzer('delta', 'mydb.tmp_digests_ini', 'with_runtimes_in_95th_percentile');\r\n+-----------------------------------------+\r\n| Next Output                             |\r\n+-----------------------------------------+\r\n| Queries with Runtime in 95th Percentile |\r\n+-----------------------------------------+\r\n1 row in set (0.03 sec)\r\n\r\n...\r\n\r\n\r\n-- To create an overall report of the 95th percentile queries and the top 10 queries with full table scans:\r\n\r\nmysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);\r\nQuery OK, 0 rows affected (0.01 sec)                                   \r\n\r\nmysql> SET @sys.statement_performance_analyzer.limit = 10;\r\nQuery OK, 0 rows affected (0.00 sec)          \r\n\r\nmysql> CALL sys.statement_performance_analyzer('overall', NULL, 'with_runtimes_in_95th_percentile,with_full_table_scans');\r\n+-----------------------------------------+\r\n| Next Output                             |\r\n+-----------------------------------------+\r\n| Queries with Runtime in 95th Percentile |\r\n+-----------------------------------------+\r\n1 row in set (0.01 sec)\r\n\r\n...\r\n\r\n+-------------------------------------+\r\n| Next Output                         |\r\n+-------------------------------------+\r\n| Top 10 Queries with Full Table Scan |\r\n+-------------------------------------+\r\n1 row in set (0.09 sec)\r\n\r\n...\r\n\r\n\r\n-- Use a custom view showing the top 10 query sorted by total execution time refreshing the view every minute using\r\n-- the watch command in Linux.\r\n\r\nmysql> CREATE OR REPLACE VIEW mydb.my_statements AS\r\n    -> SELECT sys.format_statement(DIGEST_TEXT) AS query,\r\n    ->        SCHEMA_NAME AS db,\r\n    ->        COUNT_STAR AS exec_count,\r\n    ->        sys.format_time(SUM_TIMER_WAIT) AS total_latency,\r\n    ->        sys.format_time(AVG_TIMER_WAIT) AS avg_latency,\r\n    ->        ROUND(IFNULL(SUM_ROWS_SENT / NULLIF(COUNT_STAR, 0), 0)) AS rows_sent_avg,\r\n    ->        ROUND(IFNULL(SUM_ROWS_EXAMINED / NULLIF(COUNT_STAR, 0), 0)) AS rows_examined_avg,\r\n    ->        ROUND(IFNULL(SUM_ROWS_AFFECTED / NULLIF(COUNT_STAR, 0), 0)) AS rows_affected_avg,\r\n    ->        DIGEST AS digest\r\n    ->   FROM performance_schema.events_statements_summary_by_digest\r\n    -> ORDER BY SUM_TIMER_WAIT DESC;\r\nQuery OK, 0 rows affected (0.01 sec)\r\n\r\nmysql> CALL sys.statement_performance_analyzer('create_table', 'mydb.digests_prev', NULL);\r\nQuery OK, 0 rows affected (0.10 sec)\r\n\r\nshell$ watch -n 60 \"mysql sys --table -e \\\"\r\n> SET @sys.statement_performance_analyzer.view = 'mydb.my_statements';\r\n> SET @sys.statement_performance_analyzer.limit = 10;\r\n> CALL statement_performance_analyzer('snapshot', NULL, NULL);\r\n> CALL statement_performance_analyzer('delta', 'mydb.digests_prev', 'custom');\r\n> CALL statement_performance_analyzer('save', 'mydb.digests_prev', NULL);\r\n> \\\"\"\r\n\r\nEvery 60.0s: mysql sys --table -e \"                                                                                                   ...  Mon Dec 22 10:58:51 2014\r\n\r\n+----------------------------------+\r\n| Next Output                      |\r\n+----------------------------------+\r\n| Top 10 Queries Using Custom View |\r\n+----------------------------------+\r\n+-------------------+-------+------------+---------------+-------------+---------------+-------------------+-------------------+----------------------------------+\r\n| query             | db    | exec_count | total_latency | avg_latency | rows_sent_avg | rows_examined_avg | rows_affected_avg | digest                           |\r\n+-------------------+-------+------------+---------------+-------------+---------------+-------------------+-------------------+----------------------------------+\r\n...\r\n```\r\n\r\n#### table_exists\r\n\r\n##### Description\r\nTests whether the table specified in in_db and in_table exists either as a regular\r\ntable, or as a temporary table. The returned value corresponds to the table that\r\nwill be used, so if there's both a temporary and a permanent table with the given\r\nname, then 'TEMPORARY' will be returned.\r\n\r\n##### Parameters\r\n\r\n* in_db (VARCHAR(64)): The database name to check for the existance of the table in.\r\n\r\n* in_table (VARCHAR(64)): The name of the table to check the existance of.\r\n\r\n* out_exists ENUM('', 'BASE TABLE', 'VIEW', 'TEMPORARY'):  The return value: whether the table exists. The value is one of:\r\n   - ''           - the table does not exist neither as a base table, view, nor temporary table.\r\n   - 'BASE TABLE' - the table name exists as a permanent base table table.\r\n   - 'VIEW'       - the table name exists as a view.\r\n   - 'TEMPORARY'  - the table name exists as a temporary table.\r\n\r\n##### Example\r\n```SQL\r\nmysql> CREATE DATABASE db1;\r\nQuery OK, 1 row affected (0.07 sec)\r\n\r\nmysql> use db1;\r\nDatabase changed\r\nmysql> CREATE TABLE t1 (id INT PRIMARY KEY);\r\nQuery OK, 0 rows affected (0.08 sec)\r\n\r\nmysql> CREATE TABLE t2 (id INT PRIMARY KEY);\r\nQuery OK, 0 rows affected (0.08 sec)\r\n\r\nmysql> CREATE view v_t1 AS SELECT * FROM t1;\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\nmysql> CREATE TEMPORARY TABLE t1 (id INT PRIMARY KEY);\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\nmysql> CALL sys.table_exists('db1', 't1', @exists); SELECT @exists;\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\n+------------+\r\n| @exists    |\r\n+------------+\r\n| TEMPORARY  |\r\n+------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> CALL sys.table_exists('db1', 't2', @exists); SELECT @exists;\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\n+------------+\r\n| @exists    |\r\n+------------+\r\n| BASE TABLE |\r\n+------------+\r\n1 row in set (0.01 sec)\r\n\r\nmysql> CALL sys.table_exists('db1', 'v_t1', @exists); SELECT @exists;\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\n+---------+\r\n| @exists |\r\n+---------+\r\n| VIEW    |\r\n+---------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> CALL sys.table_exists('db1', 't3', @exists); SELECT @exists;\r\nQuery OK, 0 rows affected (0.01 sec)\r\n\r\n+---------+\r\n| @exists |\r\n+---------+\r\n|         |\r\n+---------+\r\n1 row in set (0.00 sec)\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}